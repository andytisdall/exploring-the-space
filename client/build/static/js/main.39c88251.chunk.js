(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{251:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(38),c=n.n(i),s=n(8),o=n(16),u=n(117),l=n(2),d=n(15),p="SIGN_IN",b="SIGN_OUT",f="ERROR",j="FETCH_TIERS",h="FETCH_PLAYLISTSONGS",m="FETCH_PLAYLIST",v="FETCH_PLAYLISTS",O="FETCH_BAND",y="FETCH_BANDS",g="FETCH_TITLES",x="FETCH_VERSIONS",w="FETCH_BOUNCES",N="FETCH_RECORDING",k="CREATE_TIER",S="CREATE_PLAYLISTSONG",B="CREATE_TITLE",E="CREATE_PLAYLIST",T="CREATE_VERSION",C="CREATE_BOUNCE",R="CREATE_BAND",L="CREATE_RECORDING",I="UPLOAD_STARTED",A="UPLOAD_FAILURE",D="EDIT_TIER",U="EDIT_PLAYLIST",P="EDIT_PLAYLISTSONG",V="EDIT_TITLE",M="EDIT_VERSION",_="EDIT_BOUNCE",G="EDIT_BAND",F="DELETE_TIER",z="DELETE_PLAYLIST",q="DELETE_PLAYLISTSONG",H="DELETE_TITLE",W="DELETE_VERSION",Y="DELETE_BOUNCE",X="DELETE_BAND",K="CLEAR_RECORDINGS",J="DELETE_RECORDING",Z="PLAY_AUDIO",Q="PAUSE_AUDIO",$="QUEUE_SONGS",ee="NEXT_SONG",te="CHANGE_VOLUME",ne="INITIALIZE_AUDIO",ae="ORDER_TIER",re="SELECT_VERSION",ie="SELECT_BOUNCE",ce=function(){return{type:Z}},se=function(e){return function(t){var n={title:e.title,version:e.version.name,date:e.bounce.date,duration:e.bounce.duration,audio:e.bounce.id};t({type:$,payload:{song:n,parent:e.tier}})}},oe=n(6),ue=n(3),le=n.n(ue),de=function(e){return function(t){var n;n=e.response?e.response.data.error:e.message,console.log(e),setTimeout((function(){t(pe(null))}),1e4),t({type:f,payload:n})}},pe=function(e){return{type:f,payload:e}},be=n(111),fe={baseURL:"https://exploring-the-space.com/api"},je=n.n(be).a.create(fe);je.interceptors.request.use((function(e){var t=localStorage.getItem("token");return t&&(e.headers.Authorization=t),e}),(function(e){return Promise.reject(e)}));var he=je,me=n(18),ve=Object(me.a)(),Oe=function(){return localStorage.removeItem("token"),ve.push("/"),{type:b}},ye=function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n){var a;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,he.get("/bands/".concat(e));case 3:a=t.sent,n({type:O,payload:a.data}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n(de(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},ge=function(){return function(){var e=Object(oe.a)(le.a.mark((function e(t){var n;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,he.get("/bands");case 3:n=e.sent,t({type:y,payload:n.data}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t(de(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},xe=n(10),we=n.n(xe),Ne=function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n){var a;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,he.get("/titles/".concat(e));case 3:a=t.sent,n({type:g,payload:a.data}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n(de(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},ke=function(e,t){return function(){var n=Object(oe.a)(le.a.mark((function n(a,r){var i,c,s;return le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=r().bands.currentBand,n.prev=1,n.next=4,he.post("/titles/delete",{titleId:e,tierId:t,currentBand:i.id});case 4:(c=n.sent).data.versions.forEach((function(e){a(Ge(e,c.data.id))})),s=Object.values(r().playlists),Object.values(r().playlistSongs).filter((function(t){return t.title===e})).forEach((function(e){var t=s.find((function(t){return t.songs.includes(e.id)}));a(Ie(e.id,t.id))})),a({type:H,payload:{title:c.data,tier:t}}),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(1),a(de(n.t0));case 15:case"end":return n.stop()}}),n,null,[[1,12]])})));return function(e,t){return n.apply(this,arguments)}}()},Se=function(e,t){return{type:re,payload:{version:e,titleId:t}}},Be=function(e,t){return{type:ie,payload:{bounce:e,titleId:t}}},Ee=function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n){var a;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,he.get("/bounces/".concat(e));case 3:a=t.sent,n({type:w,payload:a.data}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n(de(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},Te=function(e,t){return function(){var n=Object(oe.a)(le.a.mark((function n(a,r){var i,c,s;return le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a({type:I});try{i=r().bands.currentBand,(c=r().versions[t]).bounces.length||(e.latest=!0),e.file=e.file[0],(s=new FileReader).onload=function(n){(new(window.AudioContext||window.webkitAudioContext)).decodeAudioData(n.target.result,function(){var n=Object(oe.a)(le.a.mark((function n(s){var o,u,d,p,b,f,j;return le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(p in o=parseInt(s.duration),u=Object(l.a)(Object(l.a)({},e),{},{currentBand:i.id,version:t,duration:o}),d=new FormData,u)d.append(p,u[p]);return n.next=6,he.post("/bounces",d,{headers:{"Content-Type":"multipart/form-data"}});case 6:(b=n.sent).data.latest&&c.bounces.length&&(f=c.bounces.map((function(e){return r().bounces[e]})),(j=f.find((function(e){return e.latest}))).latest=!1,a(Ce(we.a.pick(j,"date","comments","latest"),j.id,t))),a({type:C,payload:{bounce:b.data,version:t}});case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())},s.onerror=function(e){console.error("An error ocurred reading the file: ",e)},s.readAsArrayBuffer(e.file)}catch(o){a({type:A}),a(de(o))}case 2:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()},Ce=function e(t,n,a){return function(){var r=Object(oe.a)(le.a.mark((function r(i,c){var s,o,u,d,p,b,f;return le.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,s=c().bands.currentBand,(o=c().bounces[n]).latest&&(t.latest=!0),!t.file||!t.file.length){r.next=12;break}t.file=t.file[0],(u=new FileReader).onload=function(r){(new(window.AudioContext||window.webkitAudioContext)).decodeAudioData(r.target.result,function(){var r=Object(oe.a)(le.a.mark((function r(u){var d,p,b,f,j,h,m,v;return le.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(f in d=parseInt(u.duration),p=Object(l.a)(Object(l.a)({},t),{},{currentBand:s.id,duration:d}),b=new FormData,p)b.append(f,p[f]);return r.next=6,he.patch("/bounces/".concat(n),b,{headers:{"Content-Type":"multipart/form-data"}});case 6:(j=r.sent).data.latest&&!o.latest&&(h=c().versions[a],m=h.bounces.map((function(e){return c().bounces[e]})),(v=m.find((function(e){return e.latest}))).latest=!1,i(e(we.a.pick(v,"date","comments","latest"),v.id,a))),i({type:_,payload:j.data});case 9:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())},u.onerror=function(e){console.error("An error ocurred reading the file: ",e)},u.readAsArrayBuffer(t.file),r.next=17;break;case 12:return r.next=14,he.patch("/bounces/".concat(n),Object(l.a)(Object(l.a)({},t),{},{currentBand:s.id}));case 14:(d=r.sent).data.latest&&!o.latest&&(p=c().versions[a],b=p.bounces.map((function(e){return c().bounces[e]})),(f=b.find((function(e){return e.latest}))).latest=!1,i(e(we.a.pick(f,"date","comments","latest"),f.id,a))),i({type:_,payload:d.data});case 17:r.next=22;break;case 19:r.prev=19,r.t0=r.catch(0),i(de(r.t0));case 22:case"end":return r.stop()}}),r,null,[[0,19]])})));return function(e,t){return r.apply(this,arguments)}}()},Re=function(e,t,n){return function(){var a=Object(oe.a)(le.a.mark((function a(r,i){var c,s,o,u,l;return le.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return c=i().bands.currentBand,a.prev=1,a.next=4,he.post("/bounces/delete",{bounceId:e,versionId:t,currentBand:c.id});case 4:(s=a.sent).data.latest&&(o=i().versions[t])&&((u=o.bounces.filter((function(t){return t!==e}))).length?((l=i().bounces[u[u.length-1]]).latest=!0,r(Be(l.id,n)),r(Ce(we.a.pick(l,"date","comments","latest"),l.id,t))):r(Be(null,n))),r({type:Y,payload:{bounce:s.data,version:t}}),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(1),r(de(a.t0));case 12:case"end":return a.stop()}}),a,null,[[1,9]])})));return function(e,t){return a.apply(this,arguments)}}()},Le=function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n,a){var r,i;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=a().bands.currentBand,t.next=4,he.post("/playlistsongs",Object(l.a)(Object(l.a)({},e),{},{currentBand:r.id}));case 4:i=t.sent,n({type:S,payload:{playlistsong:i.data,playlist:e.playlistId}}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(de(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,n){return t.apply(this,arguments)}}()},Ie=function(e,t){return function(){var n=Object(oe.a)(le.a.mark((function n(a,r){var i,c;return le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=r().bands.currentBand,n.prev=1,n.next=4,he.post("/playlistsongs/delete",{playlistSongId:e,playlistId:t,currentBand:i.id});case 4:c=n.sent,a({type:q,payload:{playlistsong:c.data,playlist:t}}),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),a(de(n.t0));case 11:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(e,t){return n.apply(this,arguments)}}()},Ae=n(28),De=function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n){var a;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,he.get("/tiers/".concat(e));case 3:a=t.sent,n({type:j,payload:a.data}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n(de(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},Ue=function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n,a){var r,i;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=a().bands.currentBand,t.next=4,he.post("/tiers",Object(l.a)(Object(l.a)({},e),{},{currentBand:r.id}));case 4:i=t.sent,n({type:k,payload:i.data}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(de(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,n){return t.apply(this,arguments)}}()},Pe=function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n,a){var r,i;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a().bands.currentBand,t.prev=1,t.next=4,he.post("/tiers/delete",{tierId:e,currentBand:r.id});case 4:(i=t.sent).data.trackList.forEach((function(e){n(ke(e,i.data.id))})),n({type:F,payload:i.data}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),n(de(t.t0));case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,n){return t.apply(this,arguments)}}()},Ve=function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n){var a;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,he.get("/versions/".concat(e));case 3:a=t.sent,n({type:x,payload:a.data}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n(de(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},Me=function(e,t){return function(){var n=Object(oe.a)(le.a.mark((function n(a,r){var i,c,s,o,u;return le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,i=r().bands.currentBand,(c=r().titles[t]).versions.length||(e.current=!0),n.next=6,he.post("/versions",Object(l.a)(Object(l.a)({},e),{},{currentBand:i.id,title:t}));case 6:(s=n.sent).data.current&&c.versions.length&&(o=c.versions.map((function(e){return r().versions[e]})),(u=o.find((function(e){return e.current}))).current=!1,a(_e(we.a.pick(u,"name","notes","current"),u.id,t))),a({type:T,payload:{version:s.data,title:t}}),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(0),a(de(n.t0));case 14:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e,t){return n.apply(this,arguments)}}()},_e=function e(t,n,a){return function(){var r=Object(oe.a)(le.a.mark((function r(i,c){var s,o,u,d,p,b;return le.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,s=c().bands.currentBand,(o=c().versions[n]).current&&(t.current=!0),r.next=6,he.patch("/versions/".concat(n),Object(l.a)(Object(l.a)({},t),{},{currentBand:s.id}));case 6:(u=r.sent).data.current&&!o.current&&(d=c().titles[a],p=d.versions.map((function(e){return c().versions[e]})),(b=p.find((function(e){return e.current}))).current=!1,i(e(we.a.pick(b,"name","notes","current"),b.id,a))),i({type:M,payload:{version:u.data,title:a}}),r.next=14;break;case 11:r.prev=11,r.t0=r.catch(0),i(de(r.t0));case 14:case"end":return r.stop()}}),r,null,[[0,11]])})));return function(e,t){return r.apply(this,arguments)}}()},Ge=function(e,t){return function(){var n=Object(oe.a)(le.a.mark((function n(a,r){var i,c,s,o,u;return le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=r().bands.currentBand,n.prev=1,n.next=4,he.post("/versions/delete",{versionId:e,titleId:t,currentBand:i.id});case 4:(c=n.sent).data.current&&(s=r().titles[t])&&((o=s.versions.filter((function(t){return t!==e}))).length?((u=r().versions[o[o.length-1]]).current=!0,a(Se(u,t)),a(_e(we.a.pick(u,"name","notes","current"),u.id,t))):a(Se(null,t))),c.data.bounces.forEach((function(e){a(Re(e,c.data.id,t))})),a({type:W,payload:{version:c.data,title:t}}),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),a(de(n.t0));case 13:case"end":return n.stop()}}),n,null,[[1,10]])})));return function(e,t){return n.apply(this,arguments)}}()},Fe=n(0),ze=Object(s.b)((function(e){return{error:e.error.error}}),{throwError:pe})((function(e){var t=e.error,n=e.throwError;return Object(a.useEffect)((function(){ve.listen((function(e){n(null)}))}),[ve]),t?Object(Fe.jsxs)("div",{className:"error",onClick:function(){return n(null)},children:[Object(Fe.jsx)("div",{className:"error-x",children:"X"}),t,Object(Fe.jsx)("div",{className:"error-x",children:"X"})]}):null})),qe=n(5),He=n(12),We=n(9),Ye=n(31),Xe=n.n(Ye),Ke=n(19),Je=n(20),Ze=n(25),Qe=n(26),$e=n(253),et=n(252),tt=function(e){Object(Ze.a)(n,e);var t=Object(Qe.a)(n);function n(e){var a;return Object(Ke.a)(this,n),(a=t.call(this,e)).state={boxVisible:!1,selectedOption:null},a.blockSpaceBarPress=function(e){e.stopPropagation()},a.bodyClick=function(e){a.ref.current&&a.ref.current.contains(e.target)||a.state.boxVisible&&a.setState({boxVisible:!1})},a.showOptions=function(e){return e.options.map((function(e){return Object(Fe.jsx)("option",{value:e.value,children:e.display},e.value)}))},a.onDrop=function(e,t){var n=e.target.files[0];(0,t.onChange)(n)},a.input=function(e){var t="";"date"===e.type&&(t="calendar"),"checkbox"===e.type&&(t="checkbox"),"input"===e.type&&(t="text-input");var n=Object(Fe.jsx)("div",{className:"form-errors",children:e.meta.touched&&e.meta.error&&Object(Fe.jsxs)("p",{children:[e.meta.error,Object(Fe.jsx)("span",{children:"\u2193"})]})});return"file"===e.type?(delete e.input.value,Object(Fe.jsxs)(Fe.Fragment,{children:[n,Object(Fe.jsx)("input",Object(l.a)(Object(l.a)({},e.input),{},{type:"file",className:"inputfile",onDrop:function(t){return a.onDrop(t,e.input)}}))]})):"select"===e.type?Object(Fe.jsxs)(Fe.Fragment,{children:[n,Object(Fe.jsx)("select",Object(l.a)(Object(l.a)({},e.input),{},{autoFocus:e.autoFocus,children:e.options?a.showOptions(e):null}))]}):Object(Fe.jsxs)(Fe.Fragment,{children:[n,Object(Fe.jsx)("input",Object(l.a)(Object(l.a)({},e.input),{},{autoFocus:e.autoFocus,type:e.type,className:t}))]})},a.required=function(e){return e?void 0:"Required"},a.showFields=function(){return a.props.fields.map((function(e,t){var n=0===t,r=a.input;return"textarea"===e.type&&(r="textarea"),Object(Fe.jsxs)("div",{children:[Object(Fe.jsxs)("label",{children:[e.label,": "]}),Object(Fe.jsx)($e.a,{name:e.name,component:r,autoFocus:n,type:e.type,validate:e.required?a.required:null,options:e.options,children:e.options?a.showOptions(e):null})]},e.label)}))},a.submitForm=function(e){a.props.onSubmit(e),a.setState({boxVisible:!1}),a.props.reset()},a.showBox=function(){if(a.state.boxVisible){var e=a.props.addClass?a.props.addClass:"";return Object(Fe.jsx)(Fe.Fragment,{children:Object(Fe.jsxs)("div",{className:"add-box ".concat(e),onClick:function(e){return e.stopPropagation()},children:[Object(Fe.jsx)("h3",{className:"add-box-title",children:a.props.title}),Object(Fe.jsxs)("form",{onSubmit:a.props.handleSubmit(a.submitForm),children:[a.showFields(),Object(Fe.jsx)("div",{className:"submit-button-centered",children:Object(Fe.jsx)("button",{className:"submit-button",type:"submit",children:"OK"})})]})]})})}},a.click=function(e){e.stopPropagation(),a.ref.current&&a.ref.current===e.target||(a.state.boxVisible?a.setState({boxVisible:!1}):a.setState({boxVisible:!0}))},a.ref=r.a.createRef(),a}return Object(Je.a)(n,[{key:"componentDidUpdate",value:function(e,t){!1===t.boxVisible&&!0===this.state.boxVisible?(document.addEventListener("click",this.bodyClick,{capture:!0}),document.addEventListener("keydown",this.blockSpaceBarPress,{capture:!0})):!0===t.boxVisible&&!1===this.state.boxVisible&&(document.removeEventListener("click",this.bodyClick,{capture:!0}),document.removeEventListener("keydown",this.blockSpaceBarPress,{capture:!0}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.bodyClick,{capture:!0}),document.removeEventListener("keydown",this.blockSpaceBarPress,{capture:!0})}},{key:"render",value:function(){return Object(Fe.jsx)(Fe.Fragment,{children:Object(Fe.jsxs)("div",{className:"add",onClick:this.click,ref:this.ref,children:[Object(Fe.jsx)("img",{src:this.props.image}),this.showBox()]})})}}]),n}(r.a.Component),nt=Object(et.a)({form:"form"})(tt),at=function(e){Object(Ze.a)(n,e);var t=Object(Qe.a)(n);function n(){return Object(Ke.a)(this,n),t.apply(this,arguments)}return Object(Je.a)(n,[{key:"componentDidMount",value:function(){document.querySelector(".container").classList.add("modal-active")}},{key:"componentWillUnmount",value:function(){document.querySelector(".container").classList.remove("modal-active")}},{key:"render",value:function(){return c.a.createPortal(Object(Fe.jsx)("div",{onClick:this.props.onDismiss,className:"modal-background",children:Object(Fe.jsxs)("div",{onClick:function(e){return e.stopPropagation()},className:"modal-box",children:[Object(Fe.jsx)("div",{className:"modal-title",children:this.props.content}),Object(Fe.jsx)("div",{children:this.props.actions})]})}),document.querySelector("#modal"))}}]),n}(r.a.Component),rt=at,it=function(e){var t=e.onSubmit,n=e.displayName,r=Object(a.useState)(!1),i=Object(qe.a)(r,2),c=i[0],s=i[1];return Object(Fe.jsxs)("div",{children:[Object(Fe.jsx)("img",{src:"/images/delete.png",className:"delete",onClick:function(e){e.stopPropagation(),s(!0)}}),c&&Object(Fe.jsx)(rt,{content:'Seriously delete "'.concat(n,'"?'),actions:Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)("button",{className:"modal-button",onClick:function(){t(),s(!1)},children:"Delete"}),Object(Fe.jsx)("button",{className:"modal-button",onClick:function(){return s(!1)},children:"No Wait"})]}),onDismiss:function(e){e.stopPropagation(),s(!1)}})]})},ct=function(e){var t=function(t){Object(Ze.a)(a,t);var n=Object(Qe.a)(a);function a(e){var t;return Object(Ke.a)(this,a),(t=n.call(this,e)).state={authorized:!1},t.handleUpdate=function(){t.checkAuth()},t}return Object(Je.a)(a,[{key:"componentDidMount",value:function(){this.checkAuth()}},{key:"checkAuth",value:function(){this.props.user&&this.props.currentBand&&this.props.user.bands.includes(this.props.currentBand.id)&&this.setState({authorized:!0})}},{key:"render",value:function(){return Object(Fe.jsx)(e,Object(l.a)(Object(l.a)({},this.props),{},{authorized:this.state.authorized,handleUpdate:this.handleUpdate}))}}]),a}(r.a.Component);return Object(s.b)((function(e){return{user:e.auth.user,currentBand:e.bands.currentBand}}))(t)},st=function(e){var t=e.selectedItem,n=e.itemList,r=e.itemType,i=e.displayItem,c=e.setSelected,s=e.renderAddButton,o=e.renderEditButton,u=e.renderDeleteButton,l=e.playButton,d=Object(a.useState)(!1),p=Object(qe.a)(d,2),b=p[0],f=p[1],j=Object(a.useRef)(null);Object(a.useEffect)((function(){b?document.addEventListener("click",v,{capture:!0}):document.removeEventListener("click",v,{capture:!0})}),[b]);var h=function(){var e;return e=0===n().length?"1 ".concat(r,":"):"".concat(n().length+1," ").concat(r,"s:"),Object(Fe.jsx)("h5",{children:e})},m=function(){if(t.current||t.latest)return Object(Fe.jsx)("div",{className:"current",children:"Current"})},v=function(e){j.current&&j.current.contains(e.target)||b&&f(!1)},O=function(){if(b)return n().map((function(e){var t=e.current||e.latest?Object(Fe.jsx)("span",{className:"list-current",children:" * current"}):null;return Object(Fe.jsxs)("div",{className:"dropdown-link",onClick:function(){c(e),f(!1)},children:[i(e),t]},e.id)}))};return Object(Fe.jsxs)("div",{className:"detail-box ".concat("Bounce"===r?"bounce":""),children:[function(){if(t)return Object(Fe.jsxs)("div",{className:"detail-content",children:[Object(Fe.jsxs)("div",{className:"detail-header",children:[h(),m()]}),Object(Fe.jsxs)("div",{className:"dropdown-container",children:[Object(Fe.jsxs)("div",{className:"dropdown",ref:j,children:[Object(Fe.jsx)("button",{className:"dropbtn",onClick:function(){return f(!b)},children:i(t)}),Object(Fe.jsx)("div",{className:"dropdown-content",children:O()})]}),l&&l()]}),Object(Fe.jsxs)("div",{className:"detail-notes",children:[Object(Fe.jsx)("div",{className:"detail-notes-title",children:"Notes:"}),Object(Fe.jsx)("p",{children:t.notes||t.comments})]})]});var e="";return"Version"===r&&(e="Song"),"Bounce"===r&&(e="Version"),Object(Fe.jsx)("div",{className:"detail-content",children:Object(Fe.jsx)("div",{className:"detail-header",children:Object(Fe.jsx)("h5",{children:"No ".concat(r,"s for this ").concat(e," Yet")})})})}(),Object(Fe.jsxs)("div",{className:"detail-buttons",children:[s(),t&&o(),t&&u()]})]})},ot=Object(s.b)(null,{selectBounce:Be,createBounce:Te,editBounce:Ce,deleteBounce:Re,queueSongs:se})(ct((function(e){var t=e.bounces,n=e.selectBounce,r=e.title,i=e.authorized,c=e.version,s=e.createBounce,o=e.editBounce,u=e.deleteBounce,d=e.song,p=e.queueSongs,b=Object(a.useState)(r.selectedBounce),f=Object(qe.a)(b,2),j=f[0],h=f[1],m=Object(a.useState)(!1),v=Object(qe.a)(m,2),O=v[0],y=v[1];Object(a.useEffect)((function(){j&&j!==r.selectedBounce&&n(j,r.id)}),[j]),Object(a.useEffect)((function(){j&&j!==r.selectedBounce&&n(r.selectedBounce,r.id)}),[r.selectedBounce]),Object(a.useEffect)((function(){h(r.selectedBounce),y(!1)}),[r.selectedBounce]);var g=function(e){return Xe.a.utc(e).format("MM/DD/yy")},x=function(e){o(e,j.id,c.id),y(!0)};return O?Object(Fe.jsx)("div",{className:"detail-box bounce",children:Object(Fe.jsxs)("div",{className:"upload-image",children:[Object(Fe.jsx)("p",{children:"Uploading..."}),Object(Fe.jsx)("img",{className:"windmill",src:"/images/windmill.gif"})]})}):c?Object(Fe.jsx)(st,{selectedItem:j,itemType:"Bounce",itemList:function(){if(j)return t.filter((function(e){return e&&e.id!==j.id})).sort((function(e,t){return e.date<t.date?1:-1}))},displayItem:function(e){return"".concat(g(e.date))},setSelected:h,renderAddButton:function(){if(i)return Object(Fe.jsx)(nt,{title:"Add a Bounce of ".concat(c.name),image:"images/add.png",fields:[{label:"File",name:"file",type:"file",required:!0},{label:"Date",name:"date",type:"date",required:!0},{label:"Comments",name:"comments",type:"textarea"},{label:"Latest Bounce?",name:"latest",type:"checkbox"}],onSubmit:function(e){return function(e){s(e,c.id),y(!0)}(e)},form:"add-bounce-".concat(r.id),initialValues:{latest:!0},addClass:"add-bounce"})},renderEditButton:function(){if(i)return Object(Fe.jsx)(nt,{title:"Edit this Bounce",image:"images/edit.png",fields:[{label:"File",name:"file",type:"file"},{label:"Date",name:"date",type:"date"},{label:"Comments",name:"comments",type:"textarea"},{label:"Current Bounce?",name:"latest",type:"checkbox"}],onSubmit:x,initialValues:Object(l.a)(Object(l.a)({},we.a.pick(j,"comments","latest")),{},{date:Xe.a.utc(j.date).format("YYYY-MM-DD")}),form:"edit-bounce-".concat(r.id),enableReinitialize:!0,addClass:"add-bounce"})},renderDeleteButton:function(){if(i)return Object(Fe.jsx)(it,{onSubmit:function(){return u(j.id,c.id,r.id)},displayName:g(j.date)})},playButton:function(){return Object(Fe.jsx)("img",{src:"/images/play.svg",className:"play-icon",onClick:function(){return p(d)}})}}):null}))),ut=Object(s.b)(null,{createVersion:Me})((function(e){var t=e.title,n=e.onSubmit,a=e.createVersion;return Object(Fe.jsx)(nt,{title:"Add a Version of ".concat(t.title),image:"/images/add.png",fields:[{label:"Name",name:"name",type:"input",required:!0},{label:"Notes",name:"notes",type:"textarea"},{label:"Current Version?",name:"current",type:"checkbox"}],onSubmit:function(e){a(e,t.id),n&&n()},form:"add-version-".concat(t.id),initialValues:{current:!0},enableReinitialize:!0,addClass:"add-version"})})),lt=Object(s.b)((function(e){return{bounces:e.bounces,band:e.bands.currentBand}}),{fetchBounces:Ee,selectVersion:Se,createVersion:Me,editVersion:_e,deleteVersion:Ge})(ct((function(e){var t=e.versions,n=e.bounces,r=e.fetchBounces,i=e.selectVersion,c=e.title,s=(e.createVersion,e.authorized),o=e.editVersion,u=e.deleteVersion,l=e.song,d=e.tier,p=e.band,b=Object(a.useState)(c.selectedVersion),f=Object(qe.a)(b,2),j=f[0],h=f[1],m=Object(a.useState)(null),v=Object(qe.a)(m,2),O=v[0],y=v[1];Object(a.useEffect)((function(){j!==c.selectedVersion&&(i(j,c.id),y(j.bounces.map((function(e){return n[e]}))),r(j.id))}),[j]),Object(a.useEffect)((function(){j&&y(j.bounces.map((function(e){return n[e]})))}),[n,j]),Object(a.useEffect)((function(){j!==c.selectedVersion&&h(c.selectedVersion)}),[c.selectedVersion]);return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)(st,{selectedItem:j,itemType:"Version",itemList:function(){return t.filter((function(e){return e.id!==j.id}))},displayItem:function(e){return"".concat(e.name)},setSelected:h,renderAddButton:function(){if(s)return Object(Fe.jsx)(ut,{title:c})},renderEditButton:function(){if(s)return Object(Fe.jsx)(nt,{title:"Edit ".concat(j.name),image:"images/edit.png",fields:[{label:"Name",name:"name",type:"input"},{label:"Notes",name:"notes",type:"textarea"},{label:"Current Version?",name:"current",type:"checkbox"}],onSubmit:function(e){return o(e,j.id,c.id)},initialValues:we.a.pick(j,"name","notes","current"),form:"edit-version-".concat(c.id),enableReinitialize:!0,addClass:"add-version"})},renderDeleteButton:function(){if(s)return Object(Fe.jsx)(it,{onSubmit:function(){return u(j.id,c.id)},displayName:j.name})}}),Object(Fe.jsxs)("div",{className:"detail-box-between",children:[function(){if(s&&j)return Object(Fe.jsx)(He.a,{to:{pathname:"/".concat(p.url,"/record"),state:{version:j,title:c,tier:d}},className:"record-link",children:"record a bounce"})}(),function(){if(O&&j)return Object(Fe.jsx)("div",{className:"version-arrow",children:"\u2192"})}()]}),function(){if(O&&j)return Object(Fe.jsx)(ot,{bounces:O,title:c,version:j,song:l})}()]})}))),dt=Object(s.b)(null,{queueSongs:se,queuePlaylistSongs:function(e){return function(t,n){var a={title:e.title,version:e.version.name,date:e.bounce.date,duration:e.bounce.duration,audio:e.bounce.id,position:e.position};t({type:$,payload:{song:a,parent:e.playlist}})}},playAudio:ce})((function(e){var t,n,r=e.song,i=e.queueSongs,c=e.parentType,s=e.queuePlaylistSongs,o=Object(a.useState)(!1),u=Object(qe.a)(o,2),l=u[0],d=u[1];return t="https://exploring-the-space.com",Object(Fe.jsxs)("div",{className:"play-container",children:[Object(Fe.jsx)("div",{className:"play-container-time",children:function(e){var t=Math.floor(e/60),n=Math.floor(e%60)<10?"0"+Math.floor(e%60):Math.floor(e%60);return"".concat(t,":").concat(n)}(r.bounce.duration)}),Object(Fe.jsxs)("div",{className:"play-icon-container",children:[!l&&Object(Fe.jsxs)("div",{className:"sk-circle-fade",children:[Object(Fe.jsx)("div",{className:"sk-circle-fade-dot"}),Object(Fe.jsx)("div",{className:"sk-circle-fade-dot"}),Object(Fe.jsx)("div",{className:"sk-circle-fade-dot"}),Object(Fe.jsx)("div",{className:"sk-circle-fade-dot"}),Object(Fe.jsx)("div",{className:"sk-circle-fade-dot"}),Object(Fe.jsx)("div",{className:"sk-circle-fade-dot"}),Object(Fe.jsx)("div",{className:"sk-circle-fade-dot"}),Object(Fe.jsx)("div",{className:"sk-circle-fade-dot"}),Object(Fe.jsx)("div",{className:"sk-circle-fade-dot"}),Object(Fe.jsx)("div",{className:"sk-circle-fade-dot"}),Object(Fe.jsx)("div",{className:"sk-circle-fade-dot"}),Object(Fe.jsx)("div",{className:"sk-circle-fade-dot"})]}),Object(Fe.jsx)("img",{src:"/images/play.svg",className:"play-icon",onClick:function(e){e.stopPropagation(),"tier"===c?i(r):"playlist"===c&&s(r)},onLoad:function(){return d(!0)}})]}),Object(Fe.jsxs)("div",{className:"play-container-display",children:[Object(Fe.jsx)("p",{children:r.version.name}),Object(Fe.jsx)("p",{children:(n=r.bounce.date,Xe.a.utc(n).format("MM/DD/YY"))})]}),Object(Fe.jsx)("a",{className:"download",onClick:function(e){return e.stopPropagation()},href:"".concat(t,"/api/audio/download/").concat(r.bounce.id,"/").concat(encodeURIComponent(r.title.title)),children:Object(Fe.jsx)("img",{src:"/images/download.svg"})})]})})),pt=Object(s.b)((function(e){return{versions:e.versions,bounces:e.bounces,band:e.bands.currentBand,playlists:e.playlists,titles:e.titles,audio:e.audio,tiers:e.tiers}}),{fetchVersions:Ve,fetchBounces:Ee,selectVersion:Se,selectBounce:Be,createPlaylistSong:Le,editTitle:function(e,t,n){return function(){var a=Object(oe.a)(le.a.mark((function a(r,i){var c,s,o;return le.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,c=i().bands.currentBand,s=e.move,a.next=5,he.patch("/titles/".concat(t),Object(l.a)(Object(l.a)({},e),{},{currentTier:n,currentBand:c.id}));case 5:o=a.sent,r({type:V,payload:{title:o.data,tier:{new:s,old:n}}}),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(0),r(de(a.t0));case 12:case"end":return a.stop()}}),a,null,[[0,9]])})));return function(e,t){return a.apply(this,arguments)}}()},deleteTitle:ke})(ct((function(e){var t=e.tier,n=e.title,r=e.titles,i=e.fetchVersions,c=e.versions,s=e.bounces,o=e.fetchBounces,u=e.authorized,d=e.band,p=e.playlists,b=e.selectVersion,f=e.selectBounce,j=e.createPlaylistSong,h=e.editTitle,m=e.deleteTitle,v=e.getTime,O=e.audio,y=e.findLatest,g=e.tiers,x=Object(a.useState)(!1),w=Object(qe.a)(x,2),N=w[0],k=w[1],S=Object(a.useState)(null),B=Object(qe.a)(S,2),E=B[0],T=B[1],C=Object(a.useState)(null),R=Object(qe.a)(C,2),L=R[0],I=R[1],A=Object(a.useState)(null),D=Object(qe.a)(A,2),U=D[0],P=D[1];Object(a.useEffect)((function(){i(n.id)}),[]),Object(a.useEffect)((function(){T(n.versions.map((function(e){return c[e]})))}),[c]),Object(a.useEffect)((function(){if(E&&E[0]){var e,t=r[n.id],a=E.map((function(e){return e.id}));t.selectedVersion&&a.includes(t.selectedVersion.id)?t.selectedVersion&&(e=c[t.selectedVersion.id]?c[t.selectedVersion.id]:null):e=E.find((function(e){return e.current})),b(e,n.id)}}),[E]),Object(a.useEffect)((function(){n.selectedVersion&&n.selectedVersion.id&&o(n.selectedVersion.id)}),[n.selectedVersion]),Object(a.useEffect)((function(){n.selectedVersion&&(n.selectedVersion.bounces[0]?I(n.selectedVersion.bounces.map((function(e){return s[e]}))):null!==n.selectedBounce&&(I(null),f(null,n.id)))}),[s]),Object(a.useEffect)((function(){var e;L&&L[0]?(n.selectedBounce&&L.includes(n.selectedBounce)?e=n.selectedBounce:(e=L.find((function(e){return e.latest})),y(n,e)),e!==n.selectedBounce&&f(e,n.id)):U&&P(null)}),[L]),Object(a.useEffect)((function(){n.selectedBounce&&n.selectedVersion?(P({tier:t,title:r[n.id],version:n.selectedVersion,bounce:n.selectedBounce}),v({id:n.id,duration:n.selectedBounce.duration})):U&&!n.selectedBounce&&(P(null),v({id:n.id,duration:0}))}),[r[n.id]]);var V=N?"down-arrow":"",M=O.currentSong?O.currentSong.audio:null,_=O.parent?O.parent.id:null,G="";M&&n.selectedBounce&&(G=_===t.id&&M===n.selectedBounce.id?"current-song":"");var F=N?"open":"closed";return Object(Fe.jsxs)("div",{className:"title-margin",children:[Object(Fe.jsx)("div",{className:"row title ".concat(G," ").concat(N?"row-open":""),children:Object(Fe.jsxs)("div",{className:"marqee",onClick:function(){return k(!N)},children:[Object(Fe.jsxs)("div",{className:"title-name",children:[Object(Fe.jsx)("img",{className:"arrow ".concat(V),src:"/images/right-arrow.svg"}),Object(Fe.jsx)("h3",{children:n.title})]}),function(){if(u&&U){var e=U.tier,t=U.title,n=U.version,a=U.bounce;return Object(Fe.jsx)(He.a,{to:{pathname:"/".concat(d.url,"/edit"),state:{tier:e,title:t,version:n,bounce:a}},className:"edit-link",children:"edit audio"})}}(),function(){if(U)return Object(Fe.jsx)(dt,{song:U,parentType:"tier"})}(),function(){if(u){var e=d.playlists.map((function(e){return p[e]})).map((function(e){if(e)return{value:e.id,display:e.name}})),a=d.tiers.filter((function(e){return e!==t.id})).map((function(e){return g[e]})).map((function(e){if(e)return{value:e.id,display:e.name}}));return a.unshift({value:null,display:""}),Object(Fe.jsxs)("div",{className:"tier-display",children:[U&&Object(Fe.jsx)(nt,{title:"Add to a Playlist",onSubmit:function(e){return function(e){j(Object(l.a)(Object(l.a)({},e),{},{bounce:n.selectedBounce.id,version:n.selectedVersion.id,title:n.id}))}(e)},image:"images/playlist.png",fields:[{type:"select",options:e,name:"playlistId",label:"Playlist"}],form:"add-to-playlist-".concat(n.id),enableReinitialize:!0}),Object(Fe.jsx)(nt,{title:"Edit ".concat(n.title),image:"images/edit.png",fields:[{label:"Title",name:"title",type:"input",required:!0},{label:"Move to Tier",name:"move",type:"select",options:a}],onSubmit:function(e){return h(e,n.id,t.id)},initialValues:{title:n.title,move:null},form:"edit-title-".concat(n.id),enableReinitialize:!0}),Object(Fe.jsx)(it,{onSubmit:function(){return m(n.id,t.id)},displayName:n.title})]})}}()]})}),Object(Fe.jsx)("div",{className:"version-container ".concat(F),children:N&&Object(Fe.jsx)(lt,{versions:E,title:n,song:U,tier:t})})]})}))),bt=Object(s.b)(null,{createTitle:function(e,t){return function(){var n=Object(oe.a)(le.a.mark((function n(a,r){var i,c;return le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=r().bands.currentBand,n.prev=1,n.next=4,he.post("/titles",Object(l.a)(Object(l.a)({},e),{},{currentBand:i.id,tier:t}));case 4:c=n.sent,a({type:B,payload:{title:c.data,tier:t}}),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),a(de(n.t0));case 11:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(e,t){return n.apply(this,arguments)}}()}})((function(e){var t=e.tier,n=e.onSubmit,a=e.createTitle;return Object(Fe.jsx)(nt,{title:"Add a Title to ".concat(t.name),image:"/images/add.png",fields:[{label:"Title",name:"title",type:"input",required:!0}],onSubmit:function(e){a(e,t.id),n&&n()},form:"add-title-".concat(t.id),addClass:"add-left"})})),ft=Object(s.b)((function(e){return{titles:e.titles,band:e.bands.currentBand,tiers:e.tiers}}),{createTier:Ue,fetchTitles:Ne,editTier:function(e,t){return function(){var n=Object(oe.a)(le.a.mark((function n(a,r){var i,c;return le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,i=r().bands.currentBand,n.next=4,he.patch("/tiers/".concat(t),Object(l.a)(Object(l.a)({},e),{},{currentBand:i.id}));case 4:c=n.sent,a({type:D,payload:c.data}),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),a(de(n.t0));case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e,t){return n.apply(this,arguments)}}()},deleteTier:Pe,setOrder:function(e,t){return{type:ae,payload:{tier:e,orderBy:t}}}})(ct((function(e){var t=e.tier,n=e.titles,r=e.fetchTitles,i=e.authorized,c=e.band,s=e.tiers,o=e.editTier,u=e.deleteTier,d=e.setOrder,p=Object(a.useState)(!1),b=Object(qe.a)(p,2),f=b[0],j=b[1],h=Object(a.useState)(null),m=Object(qe.a)(h,2),v=m[0],O=m[1],y=Object(a.useState)({}),g=Object(qe.a)(y,2),x=g[0],w=g[1],N=Object(a.useRef)({});Object(a.useEffect)((function(){d(t.id,"date"),r(t.id)}),[]),Object(a.useEffect)((function(){O(t.trackList.map((function(e){return n[e]})))}),[n,t]);var k=function(e,t){N.current[e.id]||(N.current[e.id]=new Date(t.date))},S=function(){if(i)return Object(Fe.jsxs)("div",{className:"order-by",children:[Object(Fe.jsx)("div",{children:"Add a Title to this Tier"}),Object(Fe.jsx)(bt,{tier:t,onSubmit:function(){return j(!0)}})]})},B=function(e){x[e.id]!==e.duration&&w(Object(l.a)(Object(l.a)({},x),{},Object(We.a)({},e.id,e.duration)))},E=f?"down-arrow":"",T=f?"open":"closed";return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)("div",{className:"row tier ".concat(f?"row-open":""),onClick:function(){return j(!f)},children:Object(Fe.jsxs)("div",{className:"marqee",children:[Object(Fe.jsxs)("div",{className:"tier-name",children:[Object(Fe.jsx)("img",{className:"arrow ".concat(E),src:"images/right-arrow.svg"}),Object(Fe.jsx)("h2",{children:t.name})]}),Object(Fe.jsxs)("div",{className:"tier-count",children:[Object(Fe.jsxs)("div",{className:"song-count",children:[t.trackList.length," songs"]}),Object(Fe.jsx)("div",{className:"song-count",children:function(){var e=Object.values(x).reduce((function(e,t){return e+t}),0);if(!e)return null;var t=Math.floor(e/60),n=Math.floor(e%60)<10?"0"+Math.floor(e%60):Math.floor(e%60);return Object(Fe.jsx)("div",{children:"".concat(t,":").concat(n)})}()})]}),Object(Fe.jsxs)("div",{className:"tier-display",children:[function(){if(i){var e=c.tiers.map((function(e){return s[e]})).sort((function(e,t){return e.position<t.position?-1:1})).map((function(e){if(e)return{value:e.position,display:e.position}}));return Object(Fe.jsx)(nt,{title:"Edit ".concat(t.name),image:"images/edit.png",fields:[{label:"Tier Name",name:"name",type:"input",required:!0},{label:"Tier Position",name:"position",type:"select",options:e}],onSubmit:function(e){return o(e,t.id)},initialValues:{name:t.name,position:t.position},form:"edit-tier-".concat(t.id),enableReinitialize:!0})}}(),function(){if(i)return Object(Fe.jsx)(it,{onSubmit:function(){return u(t.id)},displayName:t.name})}()]})]})}),Object(Fe.jsx)("div",{className:"tier-options ".concat(f?"options-visible":""),children:f&&Object(Fe.jsxs)(Fe.Fragment,{children:[S(),t.orderBy&&"date"!==t.orderBy?"name"===t.orderBy?Object(Fe.jsxs)("div",{className:"order-by",children:[Object(Fe.jsx)("div",{children:"Order titles by:"}),Object(Fe.jsx)("div",{className:"order-button",onClick:function(e){e.stopPropagation(),d(t.id,"date")},children:"Date"}),Object(Fe.jsx)("div",{className:"order-button order-active",onClick:function(e){return e.stopPropagation()},children:"ABC"})]}):void 0:Object(Fe.jsxs)("div",{className:"order-by",children:[Object(Fe.jsx)("div",{children:"Order titles by: "}),Object(Fe.jsx)("div",{className:"order-button order-active",onClick:function(e){return e.stopPropagation()},children:"Date"}),Object(Fe.jsx)("div",{className:"order-button",onClick:function(e){e.stopPropagation(),d(t.id,"name")},children:"ABC"})]})]})}),Object(Fe.jsx)("hr",{}),Object(Fe.jsx)("div",{className:"title-container ".concat(T),children:f&&v&&function(){var e=Object(Ae.a)(v);return t.orderBy&&"date"!==t.orderBy||e.sort((function(e,t){return N.current[e.id]&&N.current[t.id]?N.current[e.id]>N.current[t.id]?-1:1:N.current[e.id]?-1:N.current[t.id]?1:void 0})),"name"===t.orderBy&&e.sort((function(e,t){return e.title<t.title?-1:1})),e.map((function(e){if(e)return Object(Fe.jsx)(pt,{title:e,tier:t,getTime:B,findLatest:k},e.id)}))}()})]})}))),jt=Object(s.b)((function(e){return{playlistSongs:e.playlistSongs,band:e.bands.currentBand,playlists:e.playlists,versions:e.versions,bounces:e.bounces,titles:e.titles,audio:e.audio}}),{fetchBounces:Ee,fetchVersions:Ve,editPlaylistSong:function(e,t){return function(){var n=Object(oe.a)(le.a.mark((function n(a,r){var i,c,s,o;return le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,i=r().bands.currentBand,c=r().playlistSongs[t],e.move&&(s={playlistId:e.move,title:c.title,version:c.version,bounce:c.bounce},a(Le(s))),n.next=6,he.patch("/playlistsongs/".concat(t),Object(l.a)(Object(l.a)({},e),{},{currentBand:i.id}));case 6:o=n.sent,a({type:P,payload:{playlistsong:o.data,playlist:e.playlistId}}),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),a(de(n.t0));case 13:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e,t){return n.apply(this,arguments)}}()},deletePlaylistSong:Ie})(ct((function(e){var t=e.playlist,n=e.playlists,r=e.song,i=e.playlistSongs,c=e.authorized,s=e.versions,o=e.bounces,u=e.titles,d=e.fetchBounces,p=e.fetchVersions,b=e.editPlaylistSong,f=e.deletePlaylistSong,j=e.audio,h=e.getTime,m=e.band,v=e.doUpdate,O=Object(a.useState)(null),y=Object(qe.a)(O,2),g=y[0],x=y[1];Object(a.useEffect)((function(){p(r.title),u[r.title].versions.forEach((function(e){d(e)}))}),[]),Object(a.useEffect)((function(){u[r.title]&&x({playlist:t,title:u[r.title],version:s[r.version],bounce:o[r.bounce],position:r.position}),o[r.bounce]&&h({id:r.id,duration:o[r.bounce].duration})}),[i[r.id],o[r.bounce],u[r.title],s[r.version]]),Object(a.useEffect)((function(){v&&w()}),[v]);var w=function(){var e=u[r.title].versions.map((function(e){return s[e]})).find((function(e){return e&&e.current}));if(e){var n=e.bounces.map((function(e){return o[e]})).find((function(e){return e&&e.latest}));n&&b({bounce:n.id,version:e.id,position:r.position,playlistId:t.id},r.id)}},N=j.currentSong?j.currentSong.audio:null,k=j.parent?j.parent.id:null,S="";return N&&r.bounce&&(S=k===t.id&&N===r.bounce?"current-song":""),Object(Fe.jsx)("div",{className:"title-margin",children:Object(Fe.jsx)("div",{className:"row title playlistsong ".concat(S),children:Object(Fe.jsxs)("div",{className:"marqee",children:[Object(Fe.jsxs)("div",{className:"title-name",children:[Object(Fe.jsx)("div",{className:"song-position",children:Object(Fe.jsx)("p",{children:r.position})}),Object(Fe.jsx)("h3",{children:r&&u[r.title]&&u[r.title].title})]}),g&&g.bounce&&g.version?Object(Fe.jsx)(dt,{song:g,parentType:"playlist"}):Object(Fe.jsxs)("div",{className:"playlistsong-no-bounce",children:[Object(Fe.jsx)("p",{children:s[r.version]?"".concat(s[r.version].name):"No Version Selected"}),Object(Fe.jsx)("p",{children:"No Bounce Selected"})]}),Object(Fe.jsxs)("div",{className:"tier-display",children:[function(){if(c&&u[r.title]){var e=Object.values(i).filter((function(e){return t.songs.includes(e.id)})).sort((function(e,t){return e.position<t.position?-1:1})).map((function(e){return{value:e.position,display:e.position}})),a=u[r.title].versions.map((function(e){return s[e]})),d=a.map((function(e){if(e)return e.bounces.map((function(e){return o[e]}))})),p=[];a.forEach((function(e,t){d[t]&&d[t].forEach((function(t){if(t){var n="";e.current&&t.latest&&(n=" * current"),p.push({value:t.id,display:"".concat(e.name," -- ").concat(Xe.a.utc(t.date).format("MM/DD/YY")).concat(n)})}}))}));var f=m.playlists.filter((function(e){return e!==t.id})).map((function(e){return n[e]})).map((function(e){if(e)return{value:e.id,display:e.name}}));return f.unshift({value:null,display:""}),Object(Fe.jsx)(nt,{image:"/images/edit.png",title:"Edit ".concat(u[r.title].title),onSubmit:function(e){return function(e){var n=Object.values(s).find((function(t){return t.bounces.includes(e.bounce)}));b(Object(l.a)(Object(l.a)({},e),{},{version:n.id,playlistId:t.id}),r.id)}(e)},fields:[{name:"position",label:"Position",type:"select",options:e},{name:"bounce",label:"Bounce",type:"select",options:p,required:!0},{label:"Add to Playlist",name:"move",type:"select",options:f}],initialValues:r.bounce?Object(l.a)(Object(l.a)({},we.a.pick(r,"position","bounce")),{},{move:null}):{position:r.position,move:null},form:"edit-playlistsong-".concat(r.id),enableReinitialize:!0,addClass:"add-right"})}}(),function(){if(c)return Object(Fe.jsx)(it,{onSubmit:function(){return f(r.id,t.id)},displayName:u[r.title].title})}()]})]})})})}))),ht=Object(s.b)((function(e){return{playlists:e.playlists,playlistSongs:e.playlistSongs,band:e.bands.currentBand}}),{fetchPlaylistSongs:function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n){var a;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,he.get("/playlistsongs/".concat(e));case 3:a=t.sent,n({type:h,payload:a.data}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n(de(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},deletePlaylist:function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n,a){var r,i;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a().bands.currentBand,t.prev=1,t.next=4,he.post("/playlists/delete",{playlistId:e,currentBand:r.id});case 4:(i=t.sent).data.songs.forEach((function(e){n(Ie(e,i.data.id))})),n({type:z,payload:i.data}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),n(de(t.t0));case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,n){return t.apply(this,arguments)}}()},editPlaylist:function(e,t){return function(){var n=Object(oe.a)(le.a.mark((function n(a,r){var i,c;return le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,i=r().bands.currentBand,n.next=4,he.patch("/playlists/".concat(t),Object(l.a)(Object(l.a)({},e),{},{currentBand:i.id}));case 4:c=n.sent,a({type:U,payload:c.data}),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),a(de(n.t0));case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e,t){return n.apply(this,arguments)}}()}})(ct((function(e){var t=e.playlist,n=e.playlists,r=e.fetchPlaylistSongs,i=e.playlistSongs,c=e.authorized,s=e.editPlaylist,o=e.deletePlaylist,u=e.band,d=Object(a.useState)(!1),p=Object(qe.a)(d,2),b=p[0],f=p[1],j=Object(a.useState)([]),h=Object(qe.a)(j,2),m=h[0],v=h[1],O=Object(a.useState)({}),y=Object(qe.a)(O,2),g=y[0],x=y[1],w=Object(a.useState)(null),N=Object(qe.a)(w,2),k=N[0],S=N[1],B=Object(a.useState)(!1),E=Object(qe.a)(B,2),T=E[0],C=E[1];Object(a.useEffect)((function(){r(t.id)}),[]),Object(a.useEffect)((function(){S(t.songs.map((function(e){return i[e]})))}),[i,t.songs]);Object(a.useEffect)((function(){if(u.playlists.length){var e=u.playlists.map((function(e){return n[e]})).sort((function(e,t){return e.position<t.position?-1:t.position<e.position?1:void 0}));v(e.map((function(e){if(e)return{value:e.position,display:e.position}})))}}),[n]),Object(a.useEffect)((function(){T&&C(!1)}),[T]);var R=function(e){g[e.id]!==e.duration&&x(Object(l.a)(Object(l.a)({},g),{},Object(We.a)({},e.id,e.duration)))},L=b?"down-arrow":"",I=b?"open":"closed";return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)("div",{className:"row tier ".concat(b?"row-open":""),onClick:function(){return f(!b)},children:Object(Fe.jsxs)("div",{className:"marqee tier-info",children:[Object(Fe.jsxs)("div",{className:"tier-name",children:[Object(Fe.jsx)("img",{className:"arrow ".concat(L),src:"/images/right-arrow.svg"}),Object(Fe.jsx)("h2",{children:t.name}),function(){if(c&&b)return Object(Fe.jsxs)("div",{className:"playlist-update",children:[Object(Fe.jsx)("div",{children:"Set all to current"}),Object(Fe.jsx)("div",{className:"playlist-update-btn",onClick:function(e){e.stopPropagation(),C(!0)}})]})}()]}),Object(Fe.jsxs)("div",{className:"tier-count",children:[Object(Fe.jsxs)("div",{className:"song-count",children:[t.songs.length," songs"]}),Object(Fe.jsx)("div",{className:"song-count",children:function(){var e=Object.values(g).reduce((function(e,t){return e+t}),0);if(!e)return null;var t=Math.floor(e/60),n=Math.floor(e%60)<10?"0"+Math.floor(e%60):Math.floor(e%60);return Object(Fe.jsx)("div",{children:"".concat(t,":").concat(n)})}()})]}),Object(Fe.jsxs)("div",{className:"tier-display",children:[function(){if(c)return Object(Fe.jsx)(nt,{title:"Edit ".concat(t.name),image:"images/edit.png",fields:[{label:"Playlist Name",name:"name",type:"input"},{label:"Playlist Position",name:"position",type:"select",options:m}],onSubmit:function(e){return s(e,t.id)},initialValues:we.a.pick(t,"name","position"),form:"edit-".concat(t.id),enableReinitialize:!0,addClass:"add-tier"})}(),function(){if(c)return Object(Fe.jsx)(it,{onSubmit:function(){return o(t.id)},displayName:t.name})}()]})]})}),Object(Fe.jsx)("hr",{}),Object(Fe.jsx)("div",{className:"title-container ".concat(I),children:b&&(k.sort((function(e,t){return e.position<t.position?-1:1})),k.map((function(e){if(e)return Object(Fe.jsx)(jt,{song:e,playlist:t,getTime:R,doUpdate:T},e.id)})))})]})}))),mt=Object(s.b)(null,{createTier:Ue})((function(e){var t=e.createTier;return Object(Fe.jsx)(nt,{onSubmit:function(e){return t(e)},title:"Add a Tier",image:"/images/add.png",fields:[{label:"Tier Name",name:"tierName",type:"input",required:!0}],addClass:"add-left"})})),vt=Object(s.b)((function(e){return{tiers:e.tiers,playlists:e.playlists,currentSong:e.audio.currentSong,user:e.auth.user,band:e.bands.currentBand}}),{fetchTiers:De,fetchPlaylists:function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n){var a;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,he.get("/playlists/".concat(e));case 3:a=t.sent,n({type:v,payload:a.data}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n(de(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},createTier:Ue,createPlaylist:function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n,a){var r,i;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=a().bands.currentBand,t.next=4,he.post("/playlists",Object(l.a)(Object(l.a)({},e),{},{currentBand:r.id}));case 4:i=t.sent,n({type:E,payload:i.data}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(de(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,n){return t.apply(this,arguments)}}()}})(ct((function(e){var t=e.fetchPlaylists,n=(e.createTier,e.fetchTiers),r=e.tiers,i=e.playlists,c=e.band,s=e.authorized,o=e.createPlaylist,u=e.currentSong,l=e.handleUpdate,d=e.user,p=Object(a.useState)([]),b=Object(qe.a)(p,2),f=b[0],j=b[1],h=Object(a.useState)([]),m=Object(qe.a)(h,2),v=m[0],O=m[1];Object(a.useEffect)((function(){n(c.id),t(c.id)}),[c]),Object(a.useEffect)((function(){l()}),[d]),Object(a.useEffect)((function(){j(c.tiers.map((function(e){return r[e]})).sort((function(e,t){return e.position<t.position?-1:t.position<e.position?1:void 0})))}),[r]),Object(a.useEffect)((function(){O(c.playlists.map((function(e){return i[e]})).sort((function(e,t){return e.position<t.position?-1:t.position<e.position?1:void 0})))}),[i]);var y=u?"playbar-active":"";return Object(Fe.jsxs)("div",{className:"main ".concat(y),children:[Object(Fe.jsxs)("div",{className:"section-header",children:[Object(Fe.jsx)("h2",{className:"section-title",children:"Tiers"}),Object(Fe.jsx)("div",{className:"section-add",children:function(){if(s)return Object(Fe.jsx)(mt,{})}()})]}),Object(Fe.jsx)("hr",{}),r&&f.map((function(e){if(e)return Object(Fe.jsx)(ft,{tier:e},e.id)})),Object(Fe.jsxs)("div",{className:"playlists",children:[Object(Fe.jsxs)("div",{className:"section-header",children:[Object(Fe.jsx)("h2",{className:"section-title",children:"Playlists"}),Object(Fe.jsx)("div",{className:"section-add",children:function(){if(s)return Object(Fe.jsx)(nt,{onSubmit:function(e){return o(e)},title:"Add a Playlist",image:"/images/add.png",fields:[{label:"Playlist Name",name:"playlistName",type:"input",required:!0}],addClass:"add-left"})}()})]}),Object(Fe.jsx)("hr",{}),i&&v.map((function(e){if(e)return Object(Fe.jsx)(ht,{playlist:e},e.id)}))]})]})}))),Ot=function(e){Object(Ze.a)(n,e);var t=Object(Qe.a)(n);function n(e){var a;return Object(Ke.a)(this,n),(a=t.call(this,e)).state={volume:50,sliderPosition:0},a.displayDate=function(e){return Xe.a.utc(e).format("MM/DD/yy")},a.updateSlider=function(){var e=a.audio.current.currentTime/a.audio.current.duration*1e3;a.time=a.formatTime(a.audio.current.currentTime),isNaN(e)||a.setState({sliderPosition:e})},a.setSpaceBarToPlay=function(e){"Space"===e.code&&(e.preventDefault(),a.props.pause?a.play():a.pause())},a.audioError=function(){a.props.throwError("The audio player had an error, probably can't connect to server.")},a.playOnLoad=function(){a.props.play&&a.audio.current.play()},a.prevSong=function(){a.audio.current.currentTime<1?a.props.prevSong():a.audio.current.currentTime=0},a.nextSong=function(){a.props.nextSong()},a.play=function(){a.props.playAudio()},a.pause=function(){a.props.pauseAudio()},a.onSliderChange=function(e){var t=e.target.value/1e3*a.audio.current.duration;a.audio.current.currentTime=t},a.onPauseButton=function(){a.props.play?a.pause():a.play()},a.url="https://exploring-the-space.com",a.audio=r.a.createRef(),a}return Object(Je.a)(n,[{key:"formatTime",value:function(e){var t=e<600?"0".concat(Math.floor(e/60)):Math.floor(e/60),n=e%60<10?"0".concat(Math.floor(e%60)):Math.floor(e%60);return"".concat(t,":").concat(n)}},{key:"wrapUrl",value:function(e){return"".concat(this.url,"/api/audio/").concat(e,".mp3")}},{key:"componentDidMount",value:function(){this.audio.current=new Audio,this.audio.current.addEventListener("timeupdate",this.updateSlider),this.audio.current.addEventListener("error",this.audioError),this.audio.current.addEventListener("ended",this.nextSong),document.addEventListener("keydown",this.setSpaceBarToPlay),this.audio.current.addEventListener("loadedmetadata",this.playOnLoad)}},{key:"componentDidUpdate",value:function(e){this.scrolled||(window.scroll(window.scrollX,window.scrollY+96),this.scrolled=!0),this.props.song?(this.props.song!==e.song?(this.audio.current.src=this.wrapUrl(this.props.song.audio),this.audio.current.volume=this.props.volume/100):this.props.play&&e.pause?this.audio.current.play():this.props.pause&&e.play&&this.audio.current.pause(),this.props.volume!==e.volume&&(this.audio.current.volume=this.props.volume/100)):this.audio.current.pause()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.setSpaceBarToPlay),this.audio.current.src="",this.audio.current.removeEventListener("timeupdate",this.updateSlider),this.audio.current.removeEventListener("error",this.audioError),this.audio.current.removeEventListener("ended",this.nextSong),this.audio.current.removeEventListener("loadedmetadata",this.playOnLoad),this.props.initializeAudio()}},{key:"render",value:function(){return this.props.song?Object(Fe.jsxs)("div",{className:"playbar",children:[Object(Fe.jsxs)("div",{className:"playbar-header",children:[Object(Fe.jsx)("div",{className:"playbar-title",children:Object(Fe.jsx)("p",{children:this.props.song.title.title})}),Object(Fe.jsxs)("div",{className:"big-play-container",children:[Object(Fe.jsx)("img",{src:"/images/prev.svg",className:"audio-controls",onClick:this.prevSong}),Object(Fe.jsx)("img",{className:"big-play-btn",src:this.props.play?"/images/pause.svg":"/images/play.svg",onClick:this.onPauseButton}),Object(Fe.jsx)("img",{src:"/images/next.svg",className:"audio-controls",onClick:this.nextSong})]}),Object(Fe.jsxs)("div",{className:"playbar-info",children:[Object(Fe.jsxs)("div",{className:"playbar-info-detail",children:[Object(Fe.jsx)("p",{children:"Version:"}),Object(Fe.jsx)("p",{children:this.props.song.version})]}),Object(Fe.jsxs)("div",{className:"playbar-info-detail",children:[Object(Fe.jsx)("p",{children:"Date:"}),Object(Fe.jsx)("p",{children:this.displayDate(this.props.song.date)})]})]})]}),Object(Fe.jsxs)("div",{className:"playslider-container",children:[Object(Fe.jsx)("div",{className:"playslider-time",children:this.time}),Object(Fe.jsx)("input",{type:"range",min:"0",max:"1000",value:this.state.sliderPosition,className:"playslider",onInput:this.onSliderChange}),Object(Fe.jsx)("div",{className:"playslider-time",children:this.formatTime(this.props.song.duration)})]})]}):null}}]),n}(r.a.Component),yt=Object(s.b)((function(e){return{song:e.audio.currentSong,play:e.audio.play,pause:e.audio.pause,volume:e.audio.volume}}),{playAudio:ce,pauseAudio:function(){return{type:Q}},nextSong:function(){return function(e,t){var n=t().audio,a=n.parent,r=n.currentSong;if(a.trackList){var i;"date"===a.orderBy&&(i=a.trackList.map((function(e){return t().titles[e]})).sort((function(e,t){return e.selectedBounce&&t.selectedBounce?new Date(e.selectedBounce.date)>new Date(t.selectedBounce.date)?-1:1:e.selectedBounce?-1:t.selectedBounce?1:void 0}))),"name"===a.orderBy&&(i=a.trackList.map((function(e){return t().titles[e]})).sort((function(e,t){return e.title<t.title?-1:1})));var c=i[i.indexOf(r.title)+1];if(c&&c.selectedVersion&&c.selectedBounce){var s=t().versions[c.selectedVersion.id],o=t().bounces[c.selectedBounce.id],u={title:c,version:s.name,date:o.date,duration:o.duration,audio:o.id};e({type:ee,payload:u})}else e({type:ne})}if(a.songs){for(var l,d=a.songs.map((function(e){return t().playlistSongs[e]})).sort((function(e,t){return e.position<t.position?-1:1})),p=r.position;p<d.length;){if(null!==d[p].bounce){l=d[p];break}p++}if(!l)return e({type:ne});var b=t().versions[l.version],f=t().bounces[l.bounce],j={title:t().titles[l.title],version:b.name,date:f.date,duration:f.duration,audio:f.id,position:l.position};e({type:ee,payload:j})}}},prevSong:function(){return function(e,t){var n=t().audio,a=n.parent,r=n.currentSong;if(a.trackList){var i;"date"===a.orderBy&&(i=a.trackList.map((function(e){return t().titles[e]})).sort((function(e,t){return e.selectedBounce&&t.selectedBounce?new Date(e.selectedBounce.date)>new Date(t.selectedBounce.date)?-1:1:e.selectedBounce?-1:t.selectedBounce?1:void 0}))),"name"===a.orderBy&&(i=a.trackList.map((function(e){return t().titles[e]})).sort((function(e,t){return e.title<t.title?-1:1})));var c=i[i.indexOf(r.title)-1];if(c&&c.selectedVersion&&c.selectedBounce){var s=t().versions[c.selectedVersion.id],o=t().bounces[c.selectedBounce.id],u={title:c,version:s.name,date:o.date,duration:o.duration,audio:o.id};e({type:ee,payload:u})}}if(a.songs){for(var l,d=a.songs.map((function(e){return t().playlistSongs[e]})).sort((function(e,t){return e.position<t.position?-1:1})),p=r.position-2;p<d.length;){if(null!==d[p].bounce){l=d[p];break}p-=1}if(!l)return e({type:ne});var b=t().versions[l.version],f=t().bounces[l.bounce],j={title:t().titles[l.title],version:b.name,date:f.date,duration:f.duration,audio:f.id,position:l.position};e({type:ee,payload:j})}}},throwError:pe,initializeAudio:function(){return{type:ne}}})(Ot),gt=Object(s.b)((function(e){return{band:e.bands.currentBand,user:e.auth.currentUser,volume:e.audio.volume}}),{fetchBand:ye,signOut:Oe,changeVolume:function(e){return{type:te,payload:e}}})(ct((function(e){var t=e.fetchBand,n=e.band,r=e.match,i=e.authorized,c=e.handleUpdate,s=e.user,o=e.signOut,u=e.volume,l=e.changeVolume,d=Object(a.useState)(!1),p=Object(qe.a)(d,2),b=p[0],f=p[1],j=Object(a.useRef)(null);Object(a.useEffect)((function(){return t(r.params.bandName),document.addEventListener("click",h,{capture:!0}),function(){document.removeEventListener("click",h,{capture:!0})}}),[]),Object(a.useEffect)((function(){c()}),[n,s]);var h=function(e){j.current&&j.current.contains(e.target)||f(!1)};return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsxs)("div",{className:"header",children:[Object(Fe.jsx)(yt,{}),n?Object(Fe.jsxs)("div",{className:"band-header",children:[Object(Fe.jsxs)("div",{className:"band-name",children:[Object(Fe.jsx)("h1",{children:n&&n.name}),Object(Fe.jsxs)("div",{className:"menu-button",ref:j,onClick:function(){return f(!b)},children:[Object(Fe.jsx)("img",{src:"images/dots.png"}),b&&(i?Object(Fe.jsxs)("div",{className:"menu",children:[Object(Fe.jsx)(He.a,{className:"menu-item",to:"/user",children:"User Home"}),Object(Fe.jsx)(He.a,{className:"menu-item",to:"/help",children:"Help"}),Object(Fe.jsx)("div",{className:"menu-item",onClick:o,children:"Sign Out"})]}):Object(Fe.jsxs)("div",{className:"menu",children:[Object(Fe.jsx)(He.a,{className:"menu-item",to:"/",children:"Home"}),Object(Fe.jsx)(He.a,{className:"menu-item",to:"/help",children:"Help"}),Object(Fe.jsx)(He.a,{className:"menu-item",to:"/signin",children:"Sign In"})]}))]})]}),Object(Fe.jsxs)("div",{className:"volume-container",children:[Object(Fe.jsx)("input",{type:"range",min:"0",max:"100",className:"volume",value:u,onInput:function(e){return l(e.target.value)}}),Object(Fe.jsx)("img",{src:"/images/volume.svg"})]})]}):Object(Fe.jsxs)("div",{className:"no-band",children:[Object(Fe.jsx)("h1",{children:"This band does not exist on Exploring the Space, but you can create it."}),Object(Fe.jsxs)("div",{className:"home-buttons",children:[Object(Fe.jsx)(He.a,{to:"/",children:"Home"}),Object(Fe.jsx)(He.a,{to:"/help",children:"What Is It?"})]})]})]}),n&&Object(Fe.jsx)(vt,{})]})}))),xt=Object(s.b)((function(e){return{user:e.auth.user,bands:e.bands}}),{createBand:function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n){var a;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,he.post("/bands",e);case 3:a=t.sent,n({type:R,payload:a.data}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n(de(t.t0));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},fetchBands:ge,editBand:function(e,t){return function(){var n=Object(oe.a)(le.a.mark((function n(a){var r;return le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,he.patch("/bands",Object(l.a)(Object(l.a)({},e),{},{currentBand:t}));case 3:r=n.sent,a({type:G,payload:r.data}),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),a(de(n.t0));case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e){return n.apply(this,arguments)}}()},deleteBand:function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n){var a;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,he.post("/bands/delete",{currentBand:e});case 3:(a=t.sent).data.tiers.forEach((function(e){n(Pe(e,a.data.id))})),n({type:X,payload:a.data}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(de(t.t0));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},signOut:Oe})((function(e){var t=e.user,n=e.bands,r=e.createBand,i=e.fetchBands,c=e.editBand,s=e.deleteBand,o=e.signOut;Object(a.useEffect)((function(){i()}),[]);return t?Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsxs)("div",{className:"user-header",children:[Object(Fe.jsxs)("div",{className:"user-header-sub",children:[Object(Fe.jsxs)("h1",{className:"user-title",children:[t.username,"'s bands"]}),Object(Fe.jsx)(nt,{onSubmit:function(e){return r(e)},title:"Create a Band",image:"images/add.png",fields:[{label:"Band Name",name:"bandName",type:"input"}]})]}),Object(Fe.jsxs)("div",{className:"user-header-sub",children:[Object(Fe.jsx)(He.a,{className:"user-link",to:"/",children:"Home"}),Object(Fe.jsx)("div",{className:"user-link",onClick:o,children:"Sign Out"})]})]}),Object(Fe.jsx)("hr",{}),Object(Fe.jsx)("div",{className:"band-list",children:function(){var e=t.bands.map((function(e){return n[e]}));return e.length&&e[0]?e.map((function(e){if(e)return Object(Fe.jsxs)("div",{className:"band-item",children:[Object(Fe.jsx)(He.a,{to:"/".concat(e.url),children:Object(Fe.jsx)("h2",{children:e.name})}),Object(Fe.jsxs)("div",{className:"band-buttons",children:[Object(Fe.jsx)(nt,{onSubmit:function(t){return c(t,e.id)},title:"Edit ".concat(e.name),image:"images/edit.png",fields:[{label:"Band Name",name:"name",type:"input"}],initialValues:{name:e.name},enableReinitialize:!0,form:"edit-band-".concat(e.id)}),Object(Fe.jsx)(it,{onSubmit:function(){return s(e.id)},displayName:e.name})]})]},e.id)})):Object(Fe.jsx)("h3",{children:"No bands belong to this user"})}()})]}):null})),wt=function(e){Object(Ze.a)(n,e);var t=Object(Qe.a)(n);function n(){var e;Object(Ke.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).renderInput=function(e){var t=e.input,n=e.label,a=(e.meta,e.type),r=e.autoComplete;e.defaultValue;return Object(Fe.jsxs)("div",{children:[Object(Fe.jsx)("label",{children:n}),Object(Fe.jsx)("input",Object(l.a)({type:a,autoComplete:r},t))]})},e.submitForm=function(t){e.props.onSubmit(t)},e}return Object(Je.a)(n,[{key:"render",value:function(){return Object(Fe.jsxs)("form",{className:"signin",onSubmit:this.props.handleSubmit(this.submitForm),children:[Object(Fe.jsx)($e.a,{name:"username",component:this.renderInput,label:"Username: ",type:"text",autoComplete:"username"}),Object(Fe.jsx)($e.a,{name:"password",component:this.renderInput,label:"Passwyrd: ",type:"password",autoComplete:"current-password"}),Object(Fe.jsx)("button",{className:"signin-submit",children:"Submit"})]})}}]),n}(r.a.Component),Nt=Object(et.a)({form:"userForm"})(wt),kt=Object(s.b)((function(e){return{isSignedIn:e.auth.isSignedIn}}),{signIn:function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n){var a;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,he.post("/signin",e);case 3:a=t.sent,localStorage.setItem("token",a.data.token),n({type:p,payload:a.data.user}),ve.push("/user"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),n(de(t.t0));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=e.signIn,n=e.isSignedIn;return Object(a.useEffect)((function(){n&&ve.push("/user")}),[]),Object(Fe.jsxs)("div",{className:"auth",children:[Object(Fe.jsx)("div",{className:"help-header",children:"Exploring the Space"}),Object(Fe.jsx)("h1",{children:"Sign In"}),Object(Fe.jsx)(Nt,{onSubmit:function(e){return t(e)}}),Object(Fe.jsxs)("div",{className:"home-buttons",children:[Object(Fe.jsx)(He.a,{to:"/",children:"Home"}),Object(Fe.jsx)(He.a,{to:"signup",children:"Sign Up"})]})]})})),St=Object(s.b)((function(e){return{isSignedIn:e.auth.isSignedIn}}),{signUp:function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n){var a;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,he.post("/signup",e);case 3:a=t.sent,localStorage.setItem("token",a.data.token),n({type:p,payload:a.data.user}),ve.push("/user"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),n(de(t.t0));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=e.signUp,n=e.isSignedIn;return Object(a.useEffect)((function(){n&&ve.push("/user")}),[]),Object(Fe.jsxs)("div",{className:"auth",children:[Object(Fe.jsx)("div",{className:"help-header",children:"Exploring the Space"}),Object(Fe.jsx)("h1",{children:"Sign Up"}),Object(Fe.jsx)(Nt,{onSubmit:function(e){return t(e)}}),Object(Fe.jsxs)("div",{className:"home-buttons",children:[Object(Fe.jsx)(He.a,{to:"/",children:"Home"}),Object(Fe.jsx)(He.a,{to:"signin",children:"Sign In"})]})]})})),Bt=function(e){Object(Ze.a)(n,e);var t=Object(Qe.a)(n);function n(){return Object(Ke.a)(this,n),t.apply(this,arguments)}return Object(Je.a)(n,[{key:"componentDidMount",value:function(){this.props.fetchBands()}},{key:"renderBands",value:function(){return delete this.props.bands.currentBand,Object.values(this.props.bands).map((function(e){return Object(Fe.jsx)("div",{className:"band-item",children:Object(Fe.jsx)(He.a,{to:"/".concat(e.url),children:Object(Fe.jsx)("h2",{children:e.name})})},e.id)}))}},{key:"render",value:function(){return Object(Fe.jsxs)("div",{className:"container",children:[Object(Fe.jsx)("h1",{className:"home-header",children:"Exploring the Space"}),Object(Fe.jsxs)("div",{className:"home-buttons",children:[Object(Fe.jsx)(He.a,{to:"/signin",children:"Sign In"}),Object(Fe.jsx)(He.a,{to:"/signup",children:"Sign Up"}),Object(Fe.jsx)(He.a,{to:"/help",children:"What Is It?"})]}),Object(Fe.jsx)("h1",{children:"All Bands:"}),Object(Fe.jsx)("div",{className:"band-list",children:this.props.bands&&this.renderBands()})]})}}]),n}(r.a.Component),Et=Object(s.b)((function(e){return{bands:e.bands}}),{fetchBands:ge})(Bt),Tt=function(){return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsxs)("div",{className:"home-buttons",children:[Object(Fe.jsx)(He.a,{to:"/",children:"Home"}),Object(Fe.jsx)(He.a,{to:"signin",children:"Sign In"}),Object(Fe.jsx)(He.a,{to:"signin",children:"Sign Up"})]}),Object(Fe.jsxs)("div",{className:"help",children:[Object(Fe.jsx)("div",{className:"help-header",children:"Exploring the Space allows you to keep track of your musical recordings in an easy to navigate catalogue."}),Object(Fe.jsx)("h1",{children:"Here's How This Works"}),Object(Fe.jsx)("div",{className:"tldr",children:"TL;DR: Bands contain Tiers, which contain Titles (songs), which contain different versions, each of which can have one or more recordings. Bands also have Playlists which are collections of particular recordings."}),Object(Fe.jsx)("p",{children:"Each user can have 1 or more bands.  Each band has their own page."}),Object(Fe.jsx)("h2",{children:"The Band Page"}),Object(Fe.jsx)("p",{children:'The band page has a "Tiers" sections and a "Playlists" section. The tiers are used to catalogue your songs, and the playlists are used to combine different songs into a certain order.'}),Object(Fe.jsx)("h3",{children:"Tiers"}),Object(Fe.jsx)("p",{children:'A tier is a collection of songs. Tiers can be separated by different genres, songs that you\'re currently rehearsing versus songs that are still being written, or any other criteria.  Within the band page, these songs are called "Titles." Click on a tier to reveal its titles.'}),Object(Fe.jsx)("h3",{children:"Titles"}),Object(Fe.jsx)("p",{children:"Titles contain all the various versions and recordings of a particular song. On the title display, you will see the recording that is most up-to-date for this title, and a button to play it or download it. Click on the title to reveal the different versions it contains."}),Object(Fe.jsx)("h3",{children:"Versions"}),Object(Fe.jsx)("p",{children:'A version categorizes groups of recordings, and again you can use whatever criteria you want.  Maybe one version is band practice, and the other is a recording you\'re working on.  Each version contains one or more recordings, or "Bounces." One and only one version for each title is the "current" version.'}),Object(Fe.jsx)("h3",{children:"Bounces"}),Object(Fe.jsx)("p",{children:'Bounces are the root component of a song, and they represent a particular recording.  They are represented by a date. Like versions, one bounce per version is designated "current."'}),Object(Fe.jsx)("h3",{children:"Playlists"}),Object(Fe.jsx)("p",{children:"Playlists are where you can make ordered lists of particular bounces.  Each title has a display of its currently selected version and bounce, along with a button to add that recording to a playlist (you have to create the playlist first)."}),Object(Fe.jsx)("p",{children:"If you change the version or bounce you're listening to, the song in the playlist will remain the same one you originally added. If you want to change which version and/or bounce a song in a playlist represents, you can change that by editing it within the playlist."}),Object(Fe.jsx)("h2",{children:"Controls"}),Object(Fe.jsx)("p",{children:"If you are on a band page of a band you own, you will see additional buttons where you can modify the catalogue and upload new recordings."}),Object(Fe.jsx)("p",{className:"danger",children:"If you delete an element, everything contained within that element will be deleted!"}),Object(Fe.jsx)("a",{href:"https://github.com/andytisdall/greenhouse",children:"Github for this project"})]})]})};function Ct(e){return(e|=0)<10?"0".concat(e):"".concat(Math.min(e,99))}function Rt(){function e(e,t){return new Promise((function(n,a){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="arraybuffer",r.onload=function(){n(WebAssembly.instantiate(r.response,t))},r.onerror=a,r.send()}))}var t=null,n=5242880;function a(e){var t=n;return n+=e,t}function r(e){postMessage({type:"internal-error",data:e})}var i=null,c=null,s=null;onmessage=function(n){var o,u=n.data;switch(u.type){case"init":var l=u.data,d=l.wasmURL,p=l.shimURL;Promise.resolve().then((function(){return self.WebAssembly&&!function(){var e=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),t=new WebAssembly.Module(e);return 0!==new WebAssembly.Instance(t,{}).exports.test(4)}()&&delete self.WebAssembly,self.WebAssembly||importScripts(p),{memory:t=new WebAssembly.Memory({initial:4800,maximum:4800}),pow:Math.pow,exit:r,powf:Math.pow,exp:Math.exp,sqrtf:Math.sqrt,cos:Math.cos,log:Math.log,sin:Math.sin,sbrk:a}})).then((function(t){return function(t,n){if(!WebAssembly.instantiateStreaming)return e(t,n);var a=fetch(t,{credentials:"same-origin"});return WebAssembly.instantiateStreaming(a,n).catch((function(a){if(a.message&&a.message.indexOf("Argument 0 must be provided and must be a Response")>0)return e(t,n);throw a}))}(d,{env:t})})).then((function(e){i=e.instance.exports,postMessage({type:"init",data:null})})).catch((function(e){postMessage({type:"init-error",data:e.toString()})}));break;case"start":if(!function(e){if(!(c=i.vmsg_init(e)))return!1;var n=new Uint32Array(t.buffer,c,1)[0];return s=new Float32Array(t.buffer,n),!0}(u.data))return postMessage({type:"error",data:"vmsg_init"});break;case"data":if(o=u.data,s.set(o),!(i.vmsg_encode(c,o.length)>=0))return postMessage({type:"error",data:"vmsg_encode"});break;case"stop":var b=function(){if(i.vmsg_flush(c)<0)return null;var e=new Uint32Array(t.buffer,c+4,1)[0],n=new Uint32Array(t.buffer,c+8,1)[0],a=new Uint8Array(t.buffer,e,n),r=new Blob([a],{type:"audio/mpeg"});return i.vmsg_free(c),c=null,s=null,r}();if(!b)return postMessage({type:"error",data:"vmsg_flush"});postMessage({type:"stop",data:b})}}}var Lt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(Ke.a)(this,e),this.wasmURL=new URL(t.wasmURL||"/static/js/vmsg.wasm",location).href,this.shimURL=new URL(t.shimURL||"/static/js/wasm-polyfill.js",location).href,this.onStop=n,this.pitch=t.pitch||0,this.stream=null,this.audioCtx=null,this.gainNode=null,this.pitchFX=null,this.encNode=null,this.worker=null,this.workerURL=null,this.blob=null,this.blobURL=null,this.resolve=null,this.reject=null,Object.seal(this)}return Object(Je.a)(e,[{key:"close",value:function(){this.encNode&&this.encNode.disconnect(),this.encNode&&(this.encNode.onaudioprocess=null),this.stream&&this.stopTracks(),this.audioCtx&&this.audioCtx.close(),this.worker&&(this.worker.terminate(),this.worker=null),this.workerURL&&URL.revokeObjectURL(this.workerURL),this.blobURL&&URL.revokeObjectURL(this.blobURL)}},{key:"initAudio",value:function(){var e=this;return(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?function(e){return navigator.mediaDevices.getUserMedia(e)}:function(e){var t=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return t?new Promise((function(n,a){t.call(navigator,e,n,a)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))})({audio:!0}).then((function(t){e.stream=t;var n=e.audioCtx=new(window.AudioContext||window.webkitAudioContext),a=n.createMediaStreamSource(t),r=e.gainNode=(n.createGain||n.createGainNode).call(n);r.gain.value=1,a.connect(r);var i=e.pitchFX=new Mt(n);i.setPitchOffset(e.pitch);var c=e.encNode=(n.createScriptProcessor||n.createJavaScriptNode).call(n,0,1,1);i.output.connect(c),r.connect(0===e.pitch?c:i.input)}))}},{key:"initWorker",value:function(){var e=this;if(this.worker)return Promise.resolve();var t=new Blob(["(",Rt.toString(),")()"],{type:"application/javascript"}),n=this.workerURL=URL.createObjectURL(t),a=this.worker=new Worker(n),r=this.wasmURL,i=this.shimURL;return a.postMessage({type:"init",data:{wasmURL:r,shimURL:i}}),new Promise((function(t,n){a.onmessage=function(a){var r=a.data;switch(r.type){case"init":t();break;case"init-error":e.close(),n(new Error(r.data));break;case"error":case"internal-error":e.close(),console.error("Worker error:",r.data),e.reject&&e.reject(r.data);break;case"stop":e.blob=r.data,e.blobURL=URL.createObjectURL(r.data),e.onStop&&e.onStop(),e.resolve&&e.resolve(e.blob)}}}))}},{key:"init",value:function(){return this.initAudio().then(this.initWorker.bind(this))}},{key:"startRecording",value:function(){var e=this;if(!this.stream)throw new Error("missing audio initialization");if(!this.worker)throw new Error("missing worker initialization");this.blob=null,this.blobURL&&URL.revokeObjectURL(this.blobURL),this.blobURL=null,this.resolve=null,this.reject=null,this.worker.postMessage({type:"start",data:this.audioCtx.sampleRate}),this.encNode.onaudioprocess=function(t){var n=t.inputBuffer.getChannelData(0);e.worker.postMessage({type:"data",data:n})},this.encNode.connect(this.audioCtx.destination)}},{key:"stopRecording",value:function(){var e=this;if(!this.stream)throw new Error("missing audio initialization");if(!this.worker)throw new Error("missing worker initialization");return this.encNode.disconnect(),this.encNode.onaudioprocess=null,this.stopTracks(),this.audioCtx.close(),this.worker.postMessage({type:"stop",data:null}),new Promise((function(t,n){e.resolve=t,e.reject=n}))}},{key:"stopTracks",value:function(){this.stream.getTracks&&this.stream.getTracks().forEach((function(e){return e.stop()}))}}]),e}(),It=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;Object(Ke.a)(this,e),this.recorder=new Lt(n,this.onStop.bind(this)),this.resolve=a,this.reject=r,this.backdrop=null,this.popup=null,this.recordBtn=null,this.stopBtn=null,this.timer=null,this.audio=null,this.saveBtn=null,this.tid=0,this.start=0,Object.seal(this),this.recorder.initAudio().then((function(){return t.drawInit()})).then((function(){return t.recorder.initWorker()})).then((function(){return t.drawAll()})).catch((function(e){return t.drawError(e)}))}return Object(Je.a)(e,[{key:"drawInit",value:function(){var e=this;if(!this.backdrop){var t=this.backdrop=document.createElement("div");t.className="vmsg-backdrop",t.addEventListener("click",(function(){return e.close(null)}));var n=this.popup=document.createElement("div");n.className="vmsg-popup",n.addEventListener("click",(function(e){return e.stopPropagation()}));var a=document.createElement("div");a.className="vmsg-progress";for(var r=0;r<3;r++){var i=document.createElement("div");i.className="vmsg-progress-dot",a.appendChild(i)}n.appendChild(a),t.appendChild(n),document.body.appendChild(t)}}},{key:"drawTime",value:function(e){var t=Math.round(e/1e3);this.timer.textContent=Ct(t/60)+":"+Ct(t%60)}},{key:"drawAll",value:function(){var e=this;this.drawInit(),this.clearAll();var t=document.createElement("div");t.className="vmsg-record-row",this.popup.appendChild(t);var n=this.recordBtn=document.createElement("button");n.className="vmsg-button vmsg-record-button",n.textContent="\u25cf",n.title="Start Recording",n.addEventListener("click",(function(){return e.startRecording()})),t.appendChild(n);var a=this.stopBtn=document.createElement("button");a.className="vmsg-button vmsg-stop-button",a.style.display="none",a.textContent="\u25a0",a.title="Stop Recording",a.addEventListener("click",(function(){return e.stopRecording()})),t.appendChild(a);var r=this.audio=new Audio;r.autoplay=!0;var i=this.timer=document.createElement("span");i.className="vmsg-timer",i.title="Preview Recording",i.addEventListener("click",(function(){r.paused?e.recorder.blobURL&&(r.src=e.recorder.blobURL):r.pause()})),this.drawTime(0),t.appendChild(i);var c=this.saveBtn=document.createElement("button");c.className="vmsg-button vmsg-save-button",c.textContent="\u2713",c.title="Save Recording",c.disabled=!0,c.addEventListener("click",(function(){return e.close(e.recorder.blob)})),t.appendChild(c);var s=document.createElement("div");s.className="vmsg-slider-wrapper vmsg-gain-slider-wrapper";var o=document.createElement("input");o.className="vmsg-slider vmsg-gain-slider",o.setAttribute("type","range"),o.min=0,o.max=2,o.step=.2,o.value=1,o.onchange=function(){var t=+o.value;e.recorder.gainNode.gain.value=t},s.appendChild(o),this.popup.appendChild(s);var u=document.createElement("div");u.className="vmsg-slider-wrapper vmsg-pitch-slider-wrapper";var l=document.createElement("input");l.className="vmsg-slider vmsg-pitch-slider",l.setAttribute("type","range"),l.min=-1,l.max=1,l.step=.2,l.value=this.recorder.pitch,l.onchange=function(){var t=+l.value;e.recorder.pitchFX.setPitchOffset(t),e.recorder.gainNode.disconnect(),e.recorder.gainNode.connect(0===t?e.recorder.encNode:e.recorder.pitchFX.input)},u.appendChild(l),this.popup.appendChild(u),n.focus()}},{key:"drawError",value:function(e){console.error(e),this.drawInit(),this.clearAll();var t=document.createElement("div");t.className="vmsg-error",t.textContent=e.toString(),this.popup.appendChild(t)}},{key:"clearAll",value:function(){this.popup&&(this.popup.innerHTML="")}},{key:"close",value:function(e){this.audio&&this.audio.pause(),this.tid&&clearTimeout(this.tid),this.recorder.close(),this.backdrop.remove(),e?this.resolve(e):this.reject(new Error("No record made"))}},{key:"onStop",value:function(){this.recordBtn.style.display="",this.stopBtn.style.display="none",this.stopBtn.disabled=!1,this.saveBtn.disabled=!1}},{key:"startRecording",value:function(){this.audio.pause(),this.start=Date.now(),this.updateTime(),this.recordBtn.style.display="none",this.stopBtn.style.display="",this.saveBtn.disabled=!0,this.stopBtn.focus(),this.recorder.startRecording()}},{key:"stopRecording",value:function(){clearTimeout(this.tid),this.tid=0,this.stopBtn.disabled=!0,this.recordBtn.focus(),this.recorder.stopRecording()}},{key:"updateTime",value:function(){var e=this;this.drawTime(Date.now()-this.start),this.tid=setTimeout((function(){return e.updateTime()}),300)}}]),e}(),At=!1;var Dt={Recorder:Lt,Form:It,record:function(e){return new Promise((function(t,n){if(At)throw new Error("Record form is already opened");At=!0,new It(e,t,n)})).then((function(e){return At=!1,e}),(function(e){throw At=!1,e}))}},Ut=.05,Pt=.1;function Vt(e,t,n,a){for(var r=t*e.sampleRate,i=r+(t-2*n)*e.sampleRate,c=e.createBuffer(1,i,e.sampleRate),s=c.getChannelData(0),o=0;o<r;++o)s[o]=a?(r-o)/i:o/r;for(o=r;o<i;++o)s[o]=0;return c}function Mt(e){this.context=e;var t=(e.createGain||e.createGainNode).call(e),n=(e.createGain||e.createGainNode).call(e);this.input=t,this.output=n;var a=e.createBufferSource(),r=e.createBufferSource(),i=e.createBufferSource(),c=e.createBufferSource();this.shiftDownBuffer=Vt(e,Pt,Ut,!1),this.shiftUpBuffer=Vt(e,Pt,Ut,!0),a.buffer=this.shiftDownBuffer,r.buffer=this.shiftDownBuffer,i.buffer=this.shiftUpBuffer,c.buffer=this.shiftUpBuffer,a.loop=!0,r.loop=!0,i.loop=!0,c.loop=!0;var s=(e.createGain||e.createGainNode).call(e),o=(e.createGain||e.createGainNode).call(e),u=(e.createGain||e.createGainNode).call(e);u.gain.value=0;var l=(e.createGain||e.createGainNode).call(e);l.gain.value=0,a.connect(s),r.connect(o),i.connect(u),c.connect(l);var d=(e.createGain||e.createGainNode).call(e),p=(e.createGain||e.createGainNode).call(e),b=(e.createDelay||e.createDelayNode).call(e),f=(e.createDelay||e.createDelayNode).call(e);s.connect(d),o.connect(p),u.connect(d),l.connect(p),d.connect(b.delayTime),p.connect(f.delayTime);var j=e.createBufferSource(),h=e.createBufferSource(),m=function(e,t,n){for(var a=t*e.sampleRate,r=a+(t-2*n)*e.sampleRate,i=e.createBuffer(1,r,e.sampleRate),c=i.getChannelData(0),s=n*e.sampleRate,o=s,u=a-s,l=0;l<a;++l){var d;d=l<o?Math.sqrt(l/s):l>=u?Math.sqrt(1-(l-u)/s):1,c[l]=d}for(l=a;l<r;++l)c[l]=0;return i}(e,Pt,Ut);j.buffer=m,h.buffer=m,j.loop=!0,h.loop=!0;var v=(e.createGain||e.createGainNode).call(e),O=(e.createGain||e.createGainNode).call(e);v.gain.value=0,O.gain.value=0,j.connect(v.gain),h.connect(O.gain),t.connect(b),t.connect(f),b.connect(v),f.connect(O),v.connect(n),O.connect(n);var y=e.currentTime+.05,g=y+Pt-Ut;a.start(y),r.start(g),i.start(y),c.start(g),j.start(y),h.start(g),this.mod1=a,this.mod2=r,this.mod1Gain=s,this.mod2Gain=o,this.mod3Gain=u,this.mod4Gain=l,this.modGain1=d,this.modGain2=p,this.fade1=j,this.fade2=h,this.mix1=v,this.mix2=O,this.delay1=b,this.delay2=f,this.setDelay(.1)}Mt.prototype.setDelay=function(e){this.modGain1.gain.setTargetAtTime(.5*e,0,.01),this.modGain2.gain.setTargetAtTime(.5*e,0,.01)},Mt.prototype.setPitchOffset=function(e){e>0?(this.mod1Gain.gain.value=0,this.mod2Gain.gain.value=0,this.mod3Gain.gain.value=1,this.mod4Gain.gain.value=1):(this.mod1Gain.gain.value=1,this.mod2Gain.gain.value=1,this.mod3Gain.gain.value=0,this.mod4Gain.gain.value=0),this.setDelay(.1*Math.abs(e))};var _t=function(e){var t=e.stateList,n=e.onSelect,a=e.selectedItem,r=e.label,i=e.date,c=e.addButton;return Object(Fe.jsxs)("div",{className:"add-recording-select-row",children:[Object(Fe.jsxs)("div",{className:"add-recording-label",children:[r,":"]}),Object(Fe.jsxs)("div",{className:"add-recording-input",children:[Object(Fe.jsx)("div",{children:function(){if(i)return Object(Fe.jsx)("input",{type:"date",value:a,onChange:function(e){return n(e.target.value)},className:"calendar"});var e=[{name:"choose...",id:"0"}].concat(Object(Ae.a)(t)).map((function(e){if(e){var t=e.name||e.title;return Object(Fe.jsx)("option",{value:e.id,disabled:"0"===e.id,children:t},e.id)}}));return Object(Fe.jsx)("select",{onChange:function(e){var a=t.find((function(t){return t.id===e.target.value}));n(a)},value:a.id,children:e})}()}),c]})]})},Gt=Object(s.b)((function(e){return{tiers:e.tiers,titles:e.titles,versions:e.versions,currentBand:e.bands.currentBand,uploadStarted:e.bands.uploadStarted,error:e.error.error,user:e.auth.user}}),{fetchTiers:De,fetchTitles:Ne,fetchVersions:Ve,fetchBand:ye,createBounce:Te,fetchBounces:Ee})((function(e){var t=e.currentBand,n=e.tiers,r=e.titles,i=e.versions,c=e.fetchBand,s=e.fetchTiers,o=e.fetchTitles,u=e.fetchVersions,l=e.fetchBounces,p=e.createBounce,b=e.uploadStarted,f=e.error,j=e.user,h=e.recording,m=e.onSuccess,v={name:"choose...",id:"0"},O=Object(a.useState)(v),y=Object(qe.a)(O,2),g=y[0],x=y[1],w=Object(a.useState)(v),N=Object(qe.a)(w,2),k=N[0],S=N[1],B=Object(a.useState)(v),E=Object(qe.a)(B,2),T=E[0],C=E[1],R=Object(a.useState)((new Date).toISOString().substring(0,10)),L=Object(qe.a)(R,2),I=L[0],A=L[1],D=Object(a.useState)(!1),U=Object(qe.a)(D,2),P=U[0],V=U[1],M=Object(a.useState)(!1),_=Object(qe.a)(M,2),G=_[0],F=_[1],z=Object(a.useState)([]),q=Object(qe.a)(z,2),H=q[0],W=q[1],Y=Object(a.useState)([]),X=Object(qe.a)(Y,2),K=X[0],J=X[1],Z=Object(a.useState)([]),Q=Object(qe.a)(Z,2),$=Q[0],ee=Q[1],te=Object(d.f)(),ne=Object(d.g)();Object(a.useEffect)((function(){c(ne.bandName),te.state&&(S(te.state.tier),x(te.state.title),C(te.state.version))}),[]),Object(a.useEffect)((function(){t&&s(t.id)}),[t]),Object(a.useEffect)((function(){if(t){var e=t.tiers.map((function(e){return n[e]}));J(e)}}),[n]),Object(a.useEffect)((function(){"0"!==k.id&&(o(k.id),ee([]))}),[k]),Object(a.useEffect)((function(){if("0"!==k.id){var e=k.trackList.map((function(e){return r[e]}));W(e)}}),[r]),Object(a.useEffect)((function(){"0"!==g.id&&u(g.id)}),[g]),Object(a.useEffect)((function(){if("0"!==g.id){var e=g.versions.map((function(e){return i[e]}));ee(e)}}),[i]),Object(a.useEffect)((function(){"0"!==T.id&&l(T.id)}),[T]),Object(a.useEffect)((function(){G&&!b&&(F(!1),V(!0),setTimeout((function(){V(!1)}),1e4),m()),b&&!G&&F(!0)}),[b]);var ae=function(){return!(!h||!I||"0"===T.id)};return j&&t&&j.bands.includes(t.id)?Object(Fe.jsxs)("div",{className:"add-recording",children:[Object(Fe.jsxs)("h2",{children:["Save recording for ",t.name]}),Object(Fe.jsx)(_t,{stateList:K,onSelect:S,selectedItem:k,label:"Tier",addButton:Object(Fe.jsx)(mt,{})}),"0"!==k.id&&Object(Fe.jsx)(_t,{stateList:H,onSelect:x,selectedItem:g,label:"Title",addButton:Object(Fe.jsx)(bt,{tier:k})}),"0"!==g.id&&Object(Fe.jsx)(_t,{stateList:$,onSelect:C,selectedItem:T,label:"Version",addButton:Object(Fe.jsx)(ut,{title:g})}),"0"!==T.id&&Object(Fe.jsx)(_t,{stateList:null,onSelect:A,selectedItem:I,label:"Date",date:!0}),Object(Fe.jsx)("form",{onSubmit:function(e){if(e.preventDefault(),ae()){var t=new File([h],"recording.mp3",{lastModified:Date()});p({date:I,latest:!0,file:[t]},T.id)}},children:Object(Fe.jsx)("button",{className:"".concat(ae()?"submit-button submit-button-centered":"submit-inactive"),type:"submit",children:"Save Bounce"})}),P&&Object(Fe.jsx)("div",{className:"upload-success",children:"Recording Successfully Saved!"}),G&&Object(Fe.jsxs)("div",{className:"upload-image",children:[Object(Fe.jsx)("p",{children:"Uploading..."}),Object(Fe.jsx)("img",{src:"/images/windmill.gif",className:"windmill"})]}),f]}):Object(Fe.jsx)("div",{className:"add-recording",children:"Warning: you will not be able to save this recording because you are not signed in or this is not your band."})})),Ft=function(e){var t=e.isRecording,n=Object(a.useState)(0),r=Object(qe.a)(n,2),i=r[0],c=r[1];Object(a.useEffect)((function(){var e;return t?e=setInterval((function(){c(i+1)}),1e3):(clearInterval(e),c(0)),function(){clearInterval(e)}}),[t,i]);return Object(Fe.jsx)("div",{className:"recorder-time",children:function(e){var t=e<600?"0".concat(Math.floor(e/60)):Math.floor(e/60),n=e%60<10?"0".concat(Math.floor(e%60)):Math.floor(e%60);return"".concat(t,":").concat(n)}(i)})},zt=function(e){var t=e.inputSource,n=e.setInputSource,r=e.isRecording,i=Object(a.useState)([]),c=Object(qe.a)(i,2),s=c[0],o=c[1];Object(a.useEffect)((function(){u(),navigator.mediaDevices.ondevicechange=u}),[]);var u=function(){var e=Object(oe.a)(le.a.mark((function e(){var a,r;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:a=e.sent,r=a.map((function(e){if("audioinput"===e.kind&&"default"!==e.deviceId)return e})),o(r),t||n(a[0]);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(Fe.jsxs)("div",{className:"device-control",children:[Object(Fe.jsx)("div",{children:"Input device:"}),Object(Fe.jsx)("div",{className:"mic-select",children:function(){var e=s.map((function(e){if(e)return Object(Fe.jsx)("option",{children:e.label},e.deviceId)}));return Object(Fe.jsx)("select",{disabled:r,children:e})}()})]})},qt=Object(s.b)((function(e){return{recordings:e.recordings}}),{createRecording:function(e){return function(){var t=Object(oe.a)(le.a.mark((function t(n,a){var r,i,c,s,o;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=a().bands.currentBand,(i=new FormData).append("currentBand",r.id),i.append("file",e),t.next=7,he.post("/recordings",i,{headers:{"Content-Type":"multipart/form-data"}});case 7:c=t.sent,s=JSON.parse(localStorage.getItem("recording-list"))||[],localStorage.setItem("recording-list",JSON.stringify([].concat(Object(Ae.a)(s),[c.data]))),o=s.length,n({type:L,payload:{blob:e,index:o,id:c.data}}),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),n(de(t.t0));case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,n){return t.apply(this,arguments)}}()},fetchRecording:function(e,t){return function(){var n=Object(oe.a)(le.a.mark((function n(a,r){var i;return le.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,he.get("/recordings/".concat(e),{responseType:"blob"});case 3:i=n.sent,a({type:N,payload:{index:t,blob:i.data,id:e}}),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),a(de(n.t0));case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e,t){return n.apply(this,arguments)}}()},clearRecordings:function(){return function(e){var t=JSON.parse(localStorage.getItem("recording-list"));t&&(t.forEach((function(e){he.post("/recordings/delete",{id:e})})),localStorage.removeItem("recording-list")),e({type:K})}},deleteRecording:function(e){return function(t){he.post("recordings/delete",{id:e});var n=JSON.parse(localStorage.getItem("recording-list")).filter((function(t){return t!==e}));localStorage.setItem("recording-list",JSON.stringify(n)),t({type:J,payload:e})}}})((function(e){var t=e.recordings,n=e.createRecording,r=e.fetchRecording,i=e.clearRecordings,c=e.deleteRecording,s=Object(a.useState)(!1),o=Object(qe.a)(s,2),u=o[0],l=o[1],d=Object(a.useState)(),p=Object(qe.a)(d,2),b=p[0],f=p[1],j=Object(a.useState)(),h=Object(qe.a)(j,2),m=h[0],v=h[1],O=Object(a.useState)(""),y=Object(qe.a)(O,2),g=y[0],x=y[1],w=Object(a.useRef)();Object(a.useEffect)((function(){w.current=new Dt.Recorder({wasmURL:"https://unpkg.com/vmsg@0.4.0/vmsg.wasm"});var e=JSON.parse(localStorage.getItem("recording-list"));e&&e.forEach((function(e,t){r(e,t)}))}),[]);var N=function(){u?S():k()},k=function(){var e=Object(oe.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({audio:{deviceId:m.deviceId}});case 3:return e.next=5,w.current.init();case 5:w.current.startRecording(),l(!0),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),x(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(oe.a)(le.a.mark((function e(){var t;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.current.stopRecording();case 3:t=e.sent,n(t),f(t),l(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),x(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),B=function(){i(),f(null)};return Object(Fe.jsxs)("div",{className:u?"recorder recording":"recorder",children:[g,function(){var e="";if(b&&!u){var t=URL.createObjectURL(b);e=Object(Fe.jsx)("audio",{controls:!0,src:t})}else u&&(e=Object(Fe.jsx)(Ft,{isRecording:u}));return Object(Fe.jsx)("div",{className:"playhead-container",children:e})}(),Object(Fe.jsx)("div",{className:"recorder-buttons",children:Object(Fe.jsx)("div",{onClick:N,className:"recorder-btn",children:u?"Stop":"Record"})}),Object(Fe.jsx)(zt,{inputSource:m,setInputSource:v,isRecording:u}),Object(Fe.jsxs)("div",{className:"recording-list",children:[function(){if(t)return t.map((function(e,t){if(!e)return Object(Fe.jsx)("div",{children:"".concat(t+1,": ").concat(e)},t);var n=b===e.audio?"selected-recording":"",a=URL.createObjectURL(e.audio);return Object(Fe.jsxs)("div",{onClick:function(){return f(e.audio)},className:"recording-list-item ".concat(n),children:["".concat(t+1,": "),Object(Fe.jsx)("audio",{src:a,controls:!0,onClick:function(e){return e.preventDefault()},className:"small-audio-player"}),Object(Fe.jsx)(it,{onSubmit:function(){c(e.id),f(null)},displayName:"recording ".concat(t+1)})]},e.id)}))}(),function(){var e=t.map((function(e){return e.audio})),n=t.length?new Blob(e,{type:"audio/mpeg"}):null;return Object(Fe.jsx)(Gt,{recording:n,onSuccess:B})}()]})]})})),Ht=n(115),Wt=n(116),Yt=function(e){var t=e.audio,n=e.isRecording,r=Object(a.useRef)(),i=Object(a.useRef)(),c=Object(a.useRef)({});Object(a.useEffect)(Object(oe.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&r.current&&r.current.getContext("2d").clearRect(0,0,r.current.width,r.current.height);case 1:case"end":return e.stop()}}),e)}))),[n]),Object(a.useEffect)(Object(oe.a)(le.a.mark((function e(){return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&(r.current&&r.current.getContext("2d").clearRect(0,0,r.current.width,r.current.height),c.current[t.size]?o(c.current[t.size]):s());case 1:case"end":return e.stop()}}),e)}))),[t]);var s=function(){var e=Object(oe.a)(le.a.mark((function e(){var n,a;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.current||(i.current=new AudioContext),e.next=3,t.arrayBuffer();case 3:n=e.sent,a={audio_context:i.current,array_buffer:n,scale:64},Wt.a.createFromAudio(a,(function(e,n){e?console.log(e):(o(n),c.current[t.size]=n)}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o=function(e){var t=r.current.getContext("2d"),n=e.length/300,a=function(e,t){return t-(e+128)*t/256};t.beginPath();for(var i=e.channel(0),c=0;c<e.length;c++){var s=i.max_sample(c);t.lineTo(c/n,a(s,r.current.height))}for(var o=e.length-1;o>=0;o--){var u=i.min_sample(o);t.lineTo(o/n,a(u,r.current.height))}t.closePath(),t.stroke(),t.fill()};return Object(Fe.jsx)("canvas",{ref:r})},Xt=function(e){var t=e.audio,n=e.isRecording,r=e.addToSongList,i=Object(a.useState)(0),c=Object(qe.a)(i,2),s=c[0],o=c[1],u=Object(a.useState)(!1),l=Object(qe.a)(u,2),d=l[0],p=l[1],b=Object(a.useState)(t),f=Object(qe.a)(b,2),j=f[0],h=f[1],m=Object(a.useState)(!1),v=Object(qe.a)(m,2),O=v[0],y=v[1],g=Object(a.useState)(0),x=Object(qe.a)(g,2),w=x[0],N=x[1],k=Object(a.useState)(1e3),S=Object(qe.a)(k,2),B=S[0],E=S[1],T=Object(a.useRef)();Object(a.useEffect)((function(){T.current=new Audio,T.current.onended=function(){p(!1)},T.current.onplay=function(){p(!0)},T.current.onpause=function(){p(!1)},T.current.ontimeupdate=C}),[]),Object(a.useEffect)((function(){n&&(p(!1),T.current&&!T.current.paused&&T.current.pause())}),[n]),Object(a.useEffect)((function(){if(j){var e=URL.createObjectURL(j);T.current.src=e}}),[j]),Object(a.useEffect)((function(){p(!1),T.current.pause(),o(0);var e=t.size*(.001*w),n=t.size*(.001*B);if(O){var a=t.slice(e,n,t.type);h(a)}else h(t)}),[O]);var C=function(){var e=T.current.currentTime/T.current.duration*1e3;isNaN(e)||o(e)},R=function(){var e=s;e<B?N(e):(N(e),E(e+1))},L=function(){var e=s;e>w?E(e):(E(e),N(e-1))};return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsxs)("div",{className:"playhead-controls",children:[Object(Fe.jsxs)("div",{className:"audio-controls",children:[n||!t||d?!n&&t?Object(Fe.jsx)("img",{src:"/images/pause.svg",className:"play-icon",onClick:function(){return T.current.pause()}}):void 0:Object(Fe.jsx)("img",{src:"/images/play.svg",className:"play-icon",onClick:function(){return T.current.play()}}),function(){if(T.current)return function(e){var t=e<600?"0".concat(Math.floor(e/60)):Math.floor(e/60),n=e%60<10?"0".concat(Math.floor(e%60)):Math.floor(e%60);return"".concat(t,":").concat(n)}(T.current.currentTime)}()]}),function(){if(O)return Object(Fe.jsx)("div",{onClick:function(){return r(j)},className:"select-section-btn",children:"save zoomed section"})}(),Object(Fe.jsxs)("div",{className:"editor-controls",children:[Object(Fe.jsx)("div",{onClick:R,className:"editor-btn",children:"Set start"}),Object(Fe.jsx)("div",{onClick:L,className:"editor-btn",children:"Set end"}),Object(Fe.jsxs)("div",{children:[Object(Fe.jsx)("input",{type:"checkbox",onChange:function(){return y(!O)},value:O}),Object(Fe.jsx)("label",{children:"Zoom"})]})]})]}),Object(Fe.jsxs)("div",{className:"waveform-display",children:[Object(Fe.jsx)(Yt,{audio:j,isRecording:n}),!O&&Object(Fe.jsx)("input",{type:"range",min:"0",max:"1000",value:w,className:"playhead start-line",readOnly:!0}),!O&&Object(Fe.jsx)("input",{type:"range",min:"0",max:"1000",value:B,className:"playhead end-line",readOnly:!0}),Object(Fe.jsx)("input",{type:"range",min:"0",max:"1000",value:s,className:"playhead",onInput:function(e){var t=e.target.value/1e3*T.current.duration;isNaN(t)||(T.current.currentTime=t)}})]})]})},Kt=function(){var e=Object(d.f)(),t=Object(a.useState)(),n=Object(qe.a)(t,2),r=n[0],i=n[1],c=Object(a.useState)([]),s=Object(qe.a)(c,2),o=s[0],u=s[1];Object(a.useEffect)(Object(oe.a)(le.a.mark((function t(){var n,a,r,c,s;return le.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.bounce,t.next=3,he.get("/audio/edit/".concat(n.id));case 3:a=t.sent,r=Object(Ht.a)(a.data),c=new Uint8Array(r),s=new Blob([c],{type:"audio/mpeg"}),i(s);case 8:case"end":return t.stop()}}),t)}))),[]);return Object(Fe.jsxs)("div",{className:"editor",children:[function(){var t=e.state,n=t.title,a=t.version,r=t.bounce,i=new Date(r.date);return Object(Fe.jsxs)("div",{className:"editor-title",children:[n.title," ",a.name," ",i.getMonth(),"/",i.getDate(),"/",i.getFullYear()]})}(),r&&Object(Fe.jsx)(Xt,{audio:r,isRecording:!1,addToSongList:function(e){u([].concat(Object(Ae.a)(o),[e]))}}),o.map((function(e,t){var n=URL.createObjectURL(e);return Object(Fe.jsxs)("div",{className:"recording-section-item",children:[Object(Fe.jsxs)("h2",{children:[t+1,": "]}),Object(Fe.jsx)("audio",{controls:!0,src:n}),Object(Fe.jsx)(Gt,{recording:e})]},e.size)}))]})},Jt=Object(s.b)((function(e){return{signedIn:e.auth.isSignedIn,error:e.error.error}}),{fetchUser:function(){return function(){var e=Object(oe.a)(le.a.mark((function e(t){var n;return le.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,he.get("/user");case 3:(n=e.sent).data?t({type:p,payload:n.data}):t(Oe()),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t(de(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()}})((function(e){var t=e.signedIn,n=e.fetchUser,r=e.error;Object(a.useEffect)((function(){t&&n()}),[]);var i=r?"error-margin":"";return Object(Fe.jsxs)(Fe.Fragment,{children:[Object(Fe.jsx)(ze,{}),Object(Fe.jsx)("div",{className:"container ".concat(i),children:Object(Fe.jsx)(d.b,{history:ve,children:Object(Fe.jsxs)(d.c,{children:[Object(Fe.jsx)(d.a,{path:"/",exact:!0,component:Et}),Object(Fe.jsx)(d.a,{path:"/signin",exact:!0,component:kt}),";",Object(Fe.jsx)(d.a,{path:"/signup",exact:!0,component:St}),";",Object(Fe.jsx)(d.a,{path:"/user",exact:!0,render:function(e){return t?Object(Fe.jsx)(xt,Object(l.a)({},e)):(ve.push("/signin"),null)}}),Object(Fe.jsx)(d.a,{path:"/help",exact:!0,component:Tt}),Object(Fe.jsx)(d.a,{path:"/:bandName/record",exact:!0,component:qt}),Object(Fe.jsx)(d.a,{path:"/:bandName/edit",component:Kt}),Object(Fe.jsx)(d.a,{path:"/:bandName",component:gt})]})})})]})})),Zt=n(254),Qt={isSignedIn:!1,user:null},$t={play:!1,volume:75,currentSong:null},en=Object(o.c)({form:Zt.a,auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p:return Object(l.a)(Object(l.a)({},e),{},{isSignedIn:!0,user:t.payload});case b:return Object(l.a)(Object(l.a)({},e),{},{isSignedIn:!1,user:null});case R:var n=e.user;return n.bands.push(t.payload.id),Object(l.a)(Object(l.a)({},e),{},{user:n});default:return e}},tiers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return Object(l.a)(Object(l.a)({},e),we.a.mapKeys(t.payload,"id"));case k:return Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},t.payload.id,t.payload));case D:var n=e[t.payload.id].position,a=t.payload.position,r={};if(n>a)for(var i=0,c=Object.values(e);i<c.length;i++){var s=c[i];if(s.position>=a&&s.position<n){var o=s.position;r[s.id]=Object(l.a)(Object(l.a)({},s),{},{position:o+1})}}if(n<a)for(var u=0,d=Object.values(e);u<d.length;u++){var p=d[u];if(p.position>n&&p.position<=a){var b=p.position;r[p.id]=Object(l.a)(Object(l.a)({},p),{},{position:b-1})}}return Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},t.payload.id,t.payload),r);case F:var f=Object.values(we.a.omit(e,e.currentBand)).filter((function(e){return e.position>t.payload.position}));return f.forEach((function(e){e.position=e.position-1})),delete e[t.payload.id],Object(l.a)(Object(l.a)({},e),we.a.mapKeys(f,"id"));case ae:return e[t.payload.tier].orderBy=t.payload.orderBy,Object(l.a)({},e);case B:var h=e[t.payload.tier];return h.trackList.push(t.payload.title.id),Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},h.id,h));case V:if(t.payload.tier.new){var m,v=e[t.payload.tier.new];v.trackList.push(t.payload.title.id);var O=e[t.payload.tier.old];return O.trackList=O.trackList.filter((function(e){return e!==t.payload.title.id})),Object(l.a)(Object(l.a)({},e),{},(m={},Object(We.a)(m,v.id,v),Object(We.a)(m,O.id,O),m))}return e;case H:var y=e[t.payload.tier];if(y){var g=y.trackList.filter((function(e){return e!==t.payload.title.id}));return y.trackList=g,Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},y.id,y))}default:return e}},titles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return Object(l.a)(Object(l.a)({},e),we.a.mapKeys(t.payload,"id"));case B:return Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},t.payload.title.id,t.payload.title));case V:var n=e[t.payload.title.id],a=t.payload.title;return a.selectedVersion=n.selectedVersion,a.selectedBounce=n.selectedBounce,Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},a.id,a));case H:return delete e[t.payload.title.id],Object(l.a)({},e);case re:var r=e[t.payload.titleId];return r.selectedVersion=t.payload.version,Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},r.id,Object(l.a)({},r)));case ie:var i=e[t.payload.titleId];return i.selectedBounce=t.payload.bounce,Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},i.id,Object(l.a)({},i)));case T:var c=e[t.payload.title];return c.versions.push(t.payload.version.id),c.selectedVersion=t.payload.version,Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},c.id,c));case W:var s=e[t.payload.title];if(s){var o=s.versions.filter((function(e){return e!==t.payload.version.id}));return s.versions=o,Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},s.id,s))}default:return e}},versions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return Object(l.a)(Object(l.a)({},e),we.a.mapKeys(t.payload,"id"));case T:case M:return Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},t.payload.version.id,t.payload.version));case W:return delete e[t.payload.version.id],Object(l.a)({},e);case C:var n=e[t.payload.version];return n.bounces.push(t.payload.bounce.id),Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},n.id,n));case Y:var a=e[t.payload.version];if(a){var r=a.bounces.filter((function(e){return e!==t.payload.bounce.id}));return a.bounces=r,Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},a.id,a))}default:return e}},bounces:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return Object(l.a)(Object(l.a)({},e),we.a.mapKeys(t.payload,"id"));case C:return Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},t.payload.bounce.id,t.payload.bounce));case _:return Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},t.payload.id,t.payload));case Y:return delete e[t.payload.bounce.id],Object(l.a)({},e);default:return e}},playlists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return Object(l.a)(Object(l.a)({},e),we.a.mapKeys(t.payload,"id"));case m:case E:return Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},t.payload.id,t.payload));case U:var n=e[t.payload.id].position,a=t.payload.position,r={};if(n>a)for(var i=0,c=Object.values(e);i<c.length;i++){var s=c[i];if(s.position>=a&&s.position<n){var o=s.position;r[s.id]=Object(l.a)(Object(l.a)({},s),{},{position:o+1})}}if(n<a)for(var u=0,d=Object.values(e);u<d.length;u++){var p=d[u];if(p.position>n&&p.position<=a){var b=p.position;r[p.id]=Object(l.a)(Object(l.a)({},p),{},{position:b-1})}}return Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},t.payload.id,t.payload),r);case z:delete e.currentBand;var f=Object.values(e).filter((function(e){return e.position>t.payload.position}));return f.forEach((function(e){e.position=e.position-1})),delete e[t.payload.id],Object(l.a)(Object(l.a)({},e),we.a.mapKeys(f,"id"));case S:var j=e[t.payload.playlist];return j.songs.push(t.payload.playlistsong.id),Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},j.id,j));case q:var h=e[t.payload.playlist];if(h){var O=h.songs.filter((function(e){return e!==t.payload.playlistsong.id}));return h.songs=O,Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},h.id,h))}default:return e}},playlistSongs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:return Object(l.a)(Object(l.a)({},e),we.a.mapKeys(t.payload,"id"));case S:return Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},t.payload.playlistsong.id,t.payload.playlistsong));case P:var n=e[t.payload.playlistsong.id].position,a=t.payload.playlistsong.position,r={};if(n>a)for(var i=0,c=Object.values(e);i<c.length;i++){var s=c[i];if(s.position>=a&&s.position<n){var o=s.position;r[s.id]=Object(l.a)(Object(l.a)({},s),{},{position:o+1})}}if(n<a)for(var u=0,d=Object.values(e);u<d.length;u++){var p=d[u];if(p.position>n&&p.position<=a){var b=p.position;r[p.id]=Object(l.a)(Object(l.a)({},p),{},{position:b-1})}}return Object(l.a)(Object(l.a)({},e),{},Object(We.a)({},t.payload.playlistsong.id,t.payload.playlistsong),r);case q:var f=Object.values(e).filter((function(e){return e.position>t.payload.playlistsong.position}));return f.forEach((function(e){e.position=e.position-1})),delete e[t.payload.playlistsong.id],Object(l.a)({},e);case W:for(var j in e)e[j].version===t.payload.version.id&&(e[j].version=null,e[j].bounce=null);return Object(l.a)({},e);case Y:for(var m in e)e[m].bounce===t.payload.bounce.id&&(e[m].bounce=null);return Object(l.a)({},e);default:return e}},bands:function(){var e,t,n,a,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1?arguments[1]:void 0;switch(c.type){case O:return Object(l.a)(Object(l.a)({},i),{},(e={},Object(We.a)(e,c.payload.id,c.payload),Object(We.a)(e,"currentBand",c.payload),e));case y:return Object(l.a)(Object(l.a)({},i),we.a.mapKeys(c.payload,"id"));case R:case G:return Object(l.a)(Object(l.a)({},i),{},Object(We.a)({},c.payload.id,c.payload));case X:return delete i[c.payload.id],Object(l.a)({},i);case k:var s=i.currentBand;return s.tiers.push(c.payload.id),Object(l.a)(Object(l.a)({},i),{},(t={},Object(We.a)(t,s.id,s),Object(We.a)(t,"currentBand",s),t));case F:var o=i.currentBand,u=o.tiers.filter((function(e){return e!==c.payload.id}));return o.tiers=u,Object(l.a)(Object(l.a)({},i),{},(n={},Object(We.a)(n,o.id,o),Object(We.a)(n,"currentBand",o),n));case E:var d=i.currentBand;return d.playlists.push(c.payload.id),Object(l.a)(Object(l.a)({},i),{},(a={},Object(We.a)(a,d.id,d),Object(We.a)(a,"currentBand",d),a));case z:var p=i.currentBand,f=p.playlists.filter((function(e){return e!==c.payload.id}));return p.playlists=f,Object(l.a)(Object(l.a)({},i),{},(r={},Object(We.a)(r,p.id,p),Object(We.a)(r,"currentBand",p),r));case b:return we.a.omit(i,i.currentBand);case I:return Object(l.a)(Object(l.a)({},i),{},{uploadStarted:!0});case A:case C:return Object(l.a)(Object(l.a)({},i),{},{uploadStarted:!1});default:return i}},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===f?{error:t.payload}:e},audio:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$t,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Z:return Object(l.a)(Object(l.a)({},e),{},{play:!0,pause:!1});case Q:return Object(l.a)(Object(l.a)({},e),{},{play:!1,pause:!0});case $:var n=t.payload,a=n.song,r=n.parent;return Object(l.a)(Object(l.a)({},e),{},{currentSong:a,play:!0,parent:r});case ee:return Object(l.a)(Object(l.a)({},e),{},{currentSong:t.payload});case Y:return e.currentSong&&t.payload.bounce.id===e.currentSong.audio?Object(l.a)({},$t):e;case te:return Object(l.a)(Object(l.a)({},e),{},{volume:t.payload});case ne:return Object(l.a)({},$t);default:return e}},recordings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:var n=Object(Ae.a)(e),a={id:t.payload.id,audio:t.payload.blob};return n[t.payload.index]=a,n;case L:var r=Object(Ae.a)(e),i={id:t.payload.id,audio:t.payload.blob};return r[t.payload.index]=i,r;case K:return[];case J:var c=e.filter((function(e){return e.id!==t.payload}));return c;default:return e}}}),tn={};localStorage.getItem("token")&&(tn.auth={isSignedIn:!0});var nn=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||o.d,an=Object(o.e)((function(e,t){if(t.type===O){var n={auth:e.auth};return en(n,t)}return en(e,t)}),tn,nn(Object(o.a)(u.a)));c.a.render(Object(Fe.jsx)(s.a,{store:an,children:Object(Fe.jsx)(Jt,{})}),document.querySelector("#root"))}},[[251,1,2]]]);
//# sourceMappingURL=main.39c88251.chunk.js.map