{"version":3,"sources":["apis/greenhouse.js","actions/types.js","history.js","actions/index.js","components/Error.js","components/AddButton.js","components/Modal.js","components/DeleteButton.js","components/requireAuth.js","components/DetailBox.js","components/Bounce.js","components/Version.js","components/PlayContainer.js","components/Title.js","components/Tier.js","components/PlaylistSong.js","components/Playlist.js","components/Main.js","components/AudioDisplay.js","components/Header.js","components/User.js","components/UserForm.js","components/SignIn.js","components/SignUp.js","components/Home.js","components/Help.js","vmsg/vmsg.js","components/AddRecording.js","components/Timer.js","components/DeviceControl.js","components/Recorder.js","components/Waveform.js","components/Playhead.js","components/Editor.js","components/App.js","reducers/authReducer.js","reducers/audioReducer.js","reducers/index.js","reducers/tierReducer.js","reducers/titleReducer.js","reducers/versionReducer.js","reducers/bounceReducer.js","reducers/playlistReducer.js","reducers/playlistSongReducer.js","reducers/bandReducer.js","reducers/errorReducer.js","reducers/recordingReducer.js","index.js"],"names":["url","instance","axios","create","interceptors","request","use","config","token","localStorage","getItem","headers","Authorization","err","Promise","reject","SIGN_IN","SIGN_OUT","ERROR","FETCH_TIERS","FETCH_PLAYLISTSONGS","FETCH_PLAYLIST","FETCH_PLAYLISTS","FETCH_BAND","FETCH_BANDS","FETCH_TITLES","FETCH_VERSIONS","FETCH_BOUNCES","FETCH_RECORDING","CREATE_TIER","CREATE_PLAYLISTSONG","CREATE_TITLE","CREATE_PLAYLIST","CREATE_VERSION","CREATE_BOUNCE","CREATE_BAND","CREATE_RECORDING","UPLOAD_STARTED","UPLOAD_FAILURE","EDIT_TIER","EDIT_PLAYLIST","EDIT_PLAYLISTSONG","EDIT_TITLE","EDIT_VERSION","EDIT_BOUNCE","EDIT_BAND","DELETE_TIER","DELETE_PLAYLIST","DELETE_PLAYLISTSONG","DELETE_TITLE","DELETE_VERSION","DELETE_BOUNCE","DELETE_BAND","CLEAR_RECORDINGS","PLAY_AUDIO","PAUSE_AUDIO","QUEUE_SONGS","NEXT_SONG","CHANGE_VOLUME","INITIALIZE_AUDIO","ORDER_TIER","SELECT_VERSION","SELECT_BOUNCE","createBrowserHistory","errorHandler","dispatch","message","response","data","error","console","log","setTimeout","throwError","type","payload","signOut","removeItem","history","push","fetchBand","bandName","a","greenhouse","get","fetchBands","fetchTiers","bandId","fetchTitles","tierId","fetchVersions","titleId","fetchBounces","versionId","createTier","formValues","getState","currentBand","bands","post","id","createBounce","parentVersion","versions","bounces","length","latest","file","reader","FileReader","onload","event","window","AudioContext","webkitAudioContext","decodeAudioData","target","result","buffer","key","duration","parseInt","formObject","version","formData","FormData","append","bounceList","map","oldLatest","find","b","editBounce","_","pick","bounce","onerror","readAsArrayBuffer","createPlaylistSong","playlistsong","playlist","playlistId","editVersion","thisVersion","current","patch","parentTitle","titles","versionList","oldCurrent","v","title","bounceId","thisBounce","deleteTier","trackList","forEach","deleteTitle","deleteVersion","playlists","Object","values","playlistSongs","filter","pls","pl","songs","includes","deletePlaylistSong","tier","remainingVersions","newCurrent","selectVersion","deleteBounce","remainingBounces","newLatest","selectBounce","playlistSongId","playAudio","queueSongs","song","songObject","name","date","audio","parent","connect","state","useEffect","listen","location","className","onClick","AddButton","props","boxVisible","selectedOption","blockSpaceBarPress","e","stopPropagation","bodyClick","ref","contains","setState","showOptions","field","options","option","value","display","onDrop","input","files","onChange","inputClass","errors","meta","touched","autoFocus","required","undefined","showFields","fields","i","comp","label","Field","component","validate","submitForm","onSubmit","reset","showBox","addClass","handleSubmit","click","React","createRef","prevProps","prevState","this","document","addEventListener","capture","removeEventListener","src","image","Component","reduxForm","form","Modal","querySelector","classList","add","remove","ReactDOM","createPortal","onDismiss","content","actions","DeleteButton","displayName","useState","visible","setVisible","ChildComponent","ComposedComponent","authorized","handleUpdate","checkAuth","user","auth","DetailBox","selectedItem","itemList","itemType","displayItem","setSelected","renderAddButton","renderEditButton","renderDeleteButton","playButton","dropdownVisible","setDropdownVisible","dropdownRef","useRef","onBodyClick","count","currentTag","renderItemList","notes","comments","parentType","renderDetail","requireAuth","selectedBounce","setSelectedBounce","uploadActive","setUploadActive","displayDate","moment","utc","format","onEditSubmit","sort","onAddSubmit","initialValues","enableReinitialize","band","createVersion","selectedVersion","setSelectedVersion","setBounceList","to","pathname","renderRecordLink","renderArrow","renderBounces","queuePlaylistSongs","position","baseUrl","loaded","setLoaded","time","minutes","Math","floor","seconds","displayTime","onLoad","href","encodeURIComponent","tiers","editTitle","changeTier","move","currentTier","new","old","getTime","findLatest","expand","setExpand","setVersionList","setSong","versionToSelect","versionIds","bounceToSelect","arrow","currentSong","currentClass","open","renderAudioEditLink","renderPlayContainer","playlistOptions","tierOptions","t","unshift","onAddToPlaylist","renderButtons","editTier","createTitle","setOrder","orderBy","titlesToRender","setTitlesToRender","times","setTimes","orderedTitles","Date","track","total","reduce","prev","cur","renderTotalTime","tierList","titleList","renderTitles","editPlaylistSong","newSong","doUpdate","playSong","setPlaySong","updateToCurrent","currentVersion","currentBounce","otherSongs","s","otherVersions","otherBounces","editOptions","fetchPlaylistSongs","deletePlaylist","editPlaylist","playlistList","setPlaylistList","songsToRender","setSongsToRender","setDoUpdate","playlistsToShow","showUpdatePlaylistCheckbox","fetchPlaylists","createPlaylist","setTierList","playbarActive","renderTierAddButton","renderPlaylistAddButton","AudioDisplay","volume","sliderPosition","updateSlider","currentTime","formatTime","isNaN","setSpaceBarToPlay","code","preventDefault","pause","play","audioError","playOnLoad","prevSong","nextSong","pauseAudio","onSliderChange","onPauseButton","Audio","scrolled","scroll","scrollX","scrollY","wrapUrl","initializeAudio","min","max","onInput","allTitles","indexOf","allSongs","index","currentUser","changeVolume","match","menu","params","clickToDismiss","Main","createBand","editBand","deleteBand","username","bandList","renderBands","UserForm","renderInput","autoComplete","defaultValue","isSignedIn","signIn","setItem","signUp","Home","Help","pad2","n","inlineWorker","fetchAndInstantiateFallback","imports","resolve","req","XMLHttpRequest","responseType","WebAssembly","instantiate","send","memory","dynamicTop","sbrk","increment","oldDynamicTop","exit","status","postMessage","FFI","pcm_l","onmessage","msg","wasmURL","shimURL","then","self","bin","Uint8Array","mod","Module","Instance","exports","test","testSafariWebAssemblyBug","importScripts","Memory","initial","TOTAL_MEMORY","maximum","pow","powf","exp","sqrtf","sqrt","cos","sin","Runtime","instantiateStreaming","fetch","credentials","catch","fetchAndInstantiate","env","wasm","toString","rate","vmsg_init","pcm_l_ref","Uint32Array","Float32Array","set","vmsg_encode","blob","vmsg_flush","mp3_ref","size","mp3","Blob","vmsg_free","Recorder","opts","onStop","URL","pitch","stream","audioCtx","gainNode","pitchFX","encNode","worker","workerURL","blobURL","seal","disconnect","onaudioprocess","stopTracks","close","terminate","revokeObjectURL","navigator","mediaDevices","getUserMedia","constraints","oldGetUserMedia","webkitGetUserMedia","mozGetUserMedia","call","Error","sourceNode","createMediaStreamSource","createGain","createGainNode","gain","Jungle","setPitchOffset","createScriptProcessor","createJavaScriptNode","output","createObjectURL","Worker","initAudio","initWorker","bind","sampleRate","samples","inputBuffer","getChannelData","destination","getTracks","stop","Form","recorder","backdrop","popup","recordBtn","stopBtn","timer","saveBtn","tid","start","drawInit","drawAll","drawError","createElement","progress","progressDot","appendChild","body","msecs","secs","round","textContent","clearAll","recordRow","startRecording","style","stopRecording","autoplay","paused","drawTime","disabled","gainWrapper","gainSlider","setAttribute","step","onchange","pitchWrapper","pitchSlider","focus","innerHTML","clearTimeout","now","updateTime","shown","record","fadeTime","bufferTime","createDelayTimeBuffer","context","activeTime","shiftUp","length1","createBuffer","p","mod1","createBufferSource","mod2","mod3","mod4","shiftDownBuffer","shiftUpBuffer","loop","mod1Gain","mod2Gain","mod3Gain","mod4Gain","modGain1","modGain2","delay1","createDelay","createDelayNode","delay2","delayTime","fade1","fade2","fadeBuffer","fadeLength","fadeIndex1","fadeIndex2","createFadeBuffer","mix1","mix2","t2","setDelay","prototype","setTargetAtTime","mult","abs","uploadStarted","recording","onSuccess","defaultItem","selectedTitle","setSelectedTitle","selectedTier","setSelectedTier","toISOString","substring","selectedDate","setSelectedDate","uploadSuccess","setUploadSuccess","uploadLoading","setUploadLoading","setTitleList","useLocation","useParams","list","selector","stateList","onSelect","item","selected","submitActive","File","lastModified","Timer","isRecording","setTimer","interval","setInterval","clearInterval","DeviceControl","inputSource","setInputSource","devices","setDevices","getDevices","ondevicechange","enumerateDevices","inputDevices","device","kind","deviceId","deviceList","micSelect","recordings","createRecording","recordingList","JSON","parse","stringify","fetchRecording","recordingId","setIsRecording","setAudio","setError","mediaRecorder","vmsg","onRecord","init","onCreateBounce","controls","renderDisplay","selectedRecording","renderList","consolidatedBlob","renderAddRecording","Waveform","canvas","audioContext","cache","getContext","clearRect","width","height","drawWaveform","renderWaveform","arrayBuffer","audio_context","array_buffer","scale","WaveformData","createFromAudio","waveform","ctx","lengthMultiplier","scaleY","amplitude","beginPath","channel","x","val","max_sample","lineTo","min_sample","closePath","stroke","fill","Playhead","addToSongList","playheadPosition","setPlayheadPosition","isPlaying","setIsPlaying","editedAudio","setEditedAudio","zoomIn","setZoomIn","setStart","end","setEnd","player","onended","onplay","onpause","ontimeupdate","blobStart","blobEnd","edited","slice","onStartClick","onEndClick","renderAudioTime","renderSelectSectionButton","readOnly","Editor","songList","setSongList","decoded","decode","getMonth","getDate","getFullYear","renderDetails","signedIn","fetchUser","errClass","path","exact","SignIn","SignUp","render","routeProps","Header","INITIAL_STATE","initialState","appReducer","combineReducers","formReducer","action","mapKeys","oldPosition","newPosition","changedPositions","pos","changePosition","omit","addToTier","newTier","oldTier","deleteFromTier","newTrackList","oldTitle","newTitle","versionTitle","bounceTitle","addToTitle","deleteFromTitle","newVersionList","addToVersion","deleteFromVersion","newBounceList","addToPlaylist","deleteFromPlaylist","newSongList","newTiers","currentBandP","bandP","newPlaylists","thisState","newState","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","clearedState","applyMiddleware","reduxThunk"],"mappings":"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","file":"static/js/main.d9cf2dbd.chunk.js","sourcesContent":["import axios from 'axios';\n\nconst url = {};\n\nif (process.env.NODE_ENV === 'production') {\n    url.baseURL = 'https://exploring-the-space.com/api';\n} else {\n    url.baseURL = 'http://localhost:3001/api'\n}\n\nconst instance = axios.create(url);\n\ninstance.interceptors.request.use(\n    (config) => {\n        const token = localStorage.getItem('token');\n        if (token) {\n            config.headers.Authorization = token;\n        }\n        return config;\n    },\n    (err) => {\n        return Promise.reject(err);\n    }\n);\n\n\n\nexport default instance;","export const SIGN_IN = 'SIGN_IN';\nexport const SIGN_OUT = 'SIGN_OUT';\n\nexport const ERROR = 'ERROR';\n\nexport const FETCH_TIERS = 'FETCH_TIERS';\nexport const FETCH_PLAYLISTSONGS = 'FETCH_PLAYLISTSONGS';\nexport const FETCH_PLAYLIST = 'FETCH_PLAYLIST';\nexport const FETCH_PLAYLISTS = 'FETCH_PLAYLISTS';\nexport const FETCH_BAND = 'FETCH_BAND';\nexport const FETCH_BANDS = 'FETCH_BANDS';\nexport const FETCH_TITLES = 'FETCH_TITLES';\nexport const FETCH_VERSIONS = 'FETCH_VERSIONS';\nexport const FETCH_BOUNCES = 'FETCH_BOUNCES';\nexport const FETCH_RECORDING = 'FETCH_RECORDING';\n\nexport const FETCH_TITLE = 'FETCH_TITLE';\nexport const FETCH_VERSION = 'FETCH_VERSION';\nexport const FETCH_BOUNCE = 'FETCH_BOUNCE';\n\nexport const CREATE_TIER = 'CREATE_TIER';\nexport const CREATE_PLAYLISTSONG = 'CREATE_PLAYLISTSONG';\nexport const CREATE_TITLE = 'CREATE_TITLE';\nexport const CREATE_PLAYLIST = 'CREATE_PLAYLIST';\nexport const CREATE_VERSION = 'CREATE_VERSION';\nexport const CREATE_BOUNCE = 'CREATE_BOUNCE';\nexport const CREATE_BAND = 'CREATE_BAND';\nexport const CREATE_RECORDING = 'CREATE_RECORDING';\n\nexport const UPLOAD_STARTED = 'UPLOAD_STARTED';\nexport const UPLOAD_FAILURE = 'UPLOAD_FAILURE';\n\nexport const EDIT_TIER = 'EDIT_TIER';\nexport const EDIT_PLAYLIST = 'EDIT_PLAYLIST';\nexport const EDIT_PLAYLISTSONG = 'EDIT_PLAYLISTSONG';\nexport const EDIT_TITLE = 'EDIT_TITLE';\nexport const EDIT_VERSION = 'EDIT_VERSION';\nexport const EDIT_BOUNCE = 'EDIT_BOUNCE';\nexport const EDIT_BAND = 'EDIT_BAND';\n\nexport const DELETE_TIER = 'DELETE_TIER';\nexport const DELETE_PLAYLIST = 'DELETE_PLAYLIST';\nexport const DELETE_PLAYLISTSONG = 'DELETE_PLAYLISTSONG';\nexport const DELETE_TITLE = 'DELETE_TITLE';\nexport const DELETE_VERSION = 'DELETE_VERSION';\nexport const DELETE_BOUNCE = 'DELETE_BOUNCE';\nexport const DELETE_BAND = 'DELETE_BAND';\nexport const CLEAR_RECORDINGS = 'CLEAR_RECORDINGS';\n\nexport const PLAY_AUDIO = 'PLAY_AUDIO';\nexport const PAUSE_AUDIO = 'PAUSE_AUDIO';\nexport const QUEUE_SONGS = 'QUEUE_SONGS';\nexport const NEXT_SONG = 'NEXT_SONG';\nexport const CHANGE_VOLUME = 'CHANGE_VOLUME';\nexport const INITIALIZE_AUDIO = 'INITIALIZE_AUDIO';\nexport const ORDER_TIER = 'ORDER_TIER';\n\nexport const SELECT_VERSION = 'SELECT_VERSION';\nexport const SELECT_BOUNCE = 'SELECT_BOUNCE';\n","import { createBrowserHistory } from 'history';\n\nexport default createBrowserHistory();","import greenhouse from '../apis/greenhouse';\nimport {\n  SIGN_IN,\n  SIGN_OUT,\n  ERROR,\n  FETCH_BAND,\n  FETCH_BANDS,\n  FETCH_TIERS,\n  FETCH_TITLES,\n  FETCH_VERSIONS,\n  FETCH_BOUNCES,\n  FETCH_PLAYLISTS,\n  FETCH_PLAYLISTSONGS,\n  CREATE_BAND,\n  CREATE_TIER,\n  CREATE_TITLE,\n  CREATE_VERSION,\n  CREATE_BOUNCE,\n  CREATE_PLAYLIST,\n  CREATE_PLAYLISTSONG,\n  CREATE_RECORDING,\n  EDIT_BAND,\n  EDIT_TIER,\n  EDIT_TITLE,\n  EDIT_VERSION,\n  EDIT_BOUNCE,\n  EDIT_PLAYLIST,\n  EDIT_PLAYLISTSONG,\n  DELETE_BAND,\n  DELETE_TIER,\n  DELETE_TITLE,\n  DELETE_VERSION,\n  DELETE_BOUNCE,\n  DELETE_PLAYLIST,\n  DELETE_PLAYLISTSONG,\n  CLEAR_RECORDINGS,\n  PLAY_AUDIO,\n  PAUSE_AUDIO,\n  QUEUE_SONGS,\n  NEXT_SONG,\n  CHANGE_VOLUME,\n  INITIALIZE_AUDIO,\n  ORDER_TIER,\n  SELECT_VERSION,\n  SELECT_BOUNCE,\n  UPLOAD_STARTED,\n  UPLOAD_FAILURE,\n  FETCH_RECORDING,\n} from './types';\nimport history from '../history';\nimport _ from 'lodash';\n\nconst errorHandler = (err) => (dispatch) => {\n  let message;\n  if (err.response) {\n    message = err.response.data.error;\n  } else {\n    message = err.message;\n  }\n  console.log(err);\n  setTimeout(() => {\n    dispatch(throwError(null));\n  }, 10000);\n  dispatch({ type: ERROR, payload: message });\n};\n\nexport const signIn = (formValues) => async (dispatch) => {\n  try {\n    const response = await greenhouse.post('/signin', formValues);\n    localStorage.setItem('token', response.data.token);\n    dispatch({ type: SIGN_IN, payload: response.data.user });\n    history.push('/user');\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const signOut = () => {\n  localStorage.removeItem('token');\n  history.push('/');\n  return { type: SIGN_OUT };\n};\n\nexport const signUp = (formValues) => async (dispatch) => {\n  try {\n    const response = await greenhouse.post('/signup', formValues);\n    localStorage.setItem('token', response.data.token);\n    dispatch({ type: SIGN_IN, payload: response.data.user });\n    history.push('/user');\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const throwError = (message) => {\n  return { type: ERROR, payload: message };\n};\n\nexport const fetchUser = () => async (dispatch) => {\n  try {\n    const response = await greenhouse.get('/user');\n    if (response.data) {\n      dispatch({ type: SIGN_IN, payload: response.data });\n    } else {\n      dispatch(signOut());\n    }\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const fetchBand = (bandName) => async (dispatch) => {\n  try {\n    const response = await greenhouse.get(`/bands/${bandName}`);\n    dispatch({ type: FETCH_BAND, payload: response.data });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const fetchBands = () => async (dispatch) => {\n  try {\n    const response = await greenhouse.get(`/bands`);\n    dispatch({ type: FETCH_BANDS, payload: response.data });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const fetchTiers = (bandId) => async (dispatch) => {\n  try {\n    const response = await greenhouse.get(`/tiers/${bandId}`);\n    dispatch({ type: FETCH_TIERS, payload: response.data });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const fetchTitles = (tierId) => async (dispatch) => {\n  try {\n    const response = await greenhouse.get(`/titles/${tierId}`);\n    dispatch({ type: FETCH_TITLES, payload: response.data });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const fetchVersions = (titleId) => async (dispatch) => {\n  try {\n    const response = await greenhouse.get(`/versions/${titleId}`);\n    dispatch({ type: FETCH_VERSIONS, payload: response.data });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const fetchBounces = (versionId) => async (dispatch) => {\n  try {\n    const response = await greenhouse.get(`/bounces/${versionId}`);\n    dispatch({ type: FETCH_BOUNCES, payload: response.data });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const fetchPlaylists = (bandId) => async (dispatch) => {\n  try {\n    const response = await greenhouse.get(`/playlists/${bandId}`);\n    dispatch({ type: FETCH_PLAYLISTS, payload: response.data });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const fetchPlaylistSongs = (playlistId) => async (dispatch) => {\n  try {\n    const response = await greenhouse.get(`/playlistsongs/${playlistId}`);\n    dispatch({ type: FETCH_PLAYLISTSONGS, payload: response.data });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const fetchRecording =\n  (recordingId, index) => async (dispatch, getState) => {\n    try {\n      const response = await greenhouse.get(`/recordings/${recordingId}`);\n      dispatch({\n        type: FETCH_RECORDING,\n        payload: { index, file: response.data },\n      });\n    } catch (err) {\n      dispatch(errorHandler(err));\n    }\n  };\n\nexport const createBand = (formValues) => async (dispatch) => {\n  try {\n    const response = await greenhouse.post('/bands', formValues);\n    dispatch({ type: CREATE_BAND, payload: response.data });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const createTier = (formValues) => async (dispatch, getState) => {\n  try {\n    const { currentBand } = getState().bands;\n    const response = await greenhouse.post('/tiers', {\n      ...formValues,\n      currentBand: currentBand.id,\n    });\n    dispatch({ type: CREATE_TIER, payload: response.data });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const createTitle =\n  (formValues, tierId) => async (dispatch, getState) => {\n    const { currentBand } = getState().bands;\n    try {\n      const response = await greenhouse.post('/titles', {\n        ...formValues,\n        currentBand: currentBand.id,\n        tier: tierId,\n      });\n      dispatch({\n        type: CREATE_TITLE,\n        payload: { title: response.data, tier: tierId },\n      });\n    } catch (err) {\n      dispatch(errorHandler(err));\n    }\n  };\n\nexport const createVersion =\n  (formValues, titleId) => async (dispatch, getState) => {\n    try {\n      const { currentBand } = getState().bands;\n      const parentTitle = getState().titles[titleId];\n\n      if (!parentTitle.versions.length) {\n        formValues.current = true;\n      }\n\n      const response = await greenhouse.post('/versions', {\n        ...formValues,\n        currentBand: currentBand.id,\n        title: titleId,\n      });\n\n      if (response.data.current) {\n        if (parentTitle.versions.length) {\n          const versionList = parentTitle.versions.map(\n            (id) => getState().versions[id]\n          );\n          const oldCurrent = versionList.find((v) => v.current);\n          oldCurrent.current = false;\n          dispatch(\n            editVersion(\n              _.pick(oldCurrent, 'name', 'notes', 'current'),\n              oldCurrent.id,\n              titleId\n            )\n          );\n        }\n      }\n\n      // dispatch({ type: SELECT_VERSION, payload: { titleId, version: response.data } });\n      dispatch({\n        type: CREATE_VERSION,\n        payload: { version: response.data, title: titleId },\n      });\n    } catch (err) {\n      dispatch(errorHandler(err));\n    }\n  };\n\nexport const createBounce =\n  (formValues, versionId) => async (dispatch, getState) => {\n    dispatch({ type: UPLOAD_STARTED });\n    try {\n      const { currentBand } = getState().bands;\n      const parentVersion = getState().versions[versionId];\n\n      if (!parentVersion.bounces.length) {\n        formValues.latest = true;\n      }\n\n      // if (formValues.file instanceof FileList) {\n      //   formValues.file = formValues.file[0];\n      // }\n\n      formValues.file = formValues.file[0];\n\n      // Create instance of FileReader\n      const reader = new FileReader();\n\n      // When the file has been succesfully read\n      reader.onload = (event) => {\n        // Create an instance of AudioContext\n        const audioContext = new (window.AudioContext ||\n          window.webkitAudioContext)();\n\n        // Asynchronously decode audio file data contained in an ArrayBuffer.\n        audioContext.decodeAudioData(event.target.result, async (buffer) => {\n          // Obtain the duration in seconds of the audio file (with milliseconds as well, a float value)\n          const duration = parseInt(buffer.duration);\n\n          const formObject = {\n            ...formValues,\n            currentBand: currentBand.id,\n            version: versionId,\n            duration,\n          };\n\n          const formData = new FormData();\n\n          for (let key in formObject) {\n            formData.append(key, formObject[key]);\n          }\n\n          const response = await greenhouse.post('/bounces', formData, {\n            headers: { 'Content-Type': 'multipart/form-data' },\n          });\n\n          if (response.data.latest) {\n            if (parentVersion.bounces.length) {\n              const bounceList = parentVersion.bounces.map(\n                (id) => getState().bounces[id]\n              );\n              const oldLatest = bounceList.find((b) => b.latest);\n              oldLatest.latest = false;\n              dispatch(\n                editBounce(\n                  _.pick(oldLatest, 'date', 'comments', 'latest'),\n                  oldLatest.id,\n                  versionId\n                )\n              );\n            }\n          }\n\n          // dispatch({ type: SELECT_BOUNCE, payload: { titleId, bounce: response.data } });\n          dispatch({\n            type: CREATE_BOUNCE,\n            payload: { bounce: response.data, version: versionId },\n          });\n        });\n      };\n\n      // In case the file couldn't be read\n      reader.onerror = (event) => {\n        console.error('An error ocurred reading the file: ', event);\n      };\n\n      // Read file as an ArrayBuffer, important !\n      reader.readAsArrayBuffer(formValues.file);\n    } catch (err) {\n      dispatch({ type: UPLOAD_FAILURE });\n      dispatch(errorHandler(err));\n    }\n  };\n\nexport const createRecording = (file) => async (dispatch, getState) => {\n  try {\n    const currentBand = getState().bands.currentBand;\n    const formData = new FormData();\n    formData.append('currentBand', currentBand.id);\n    formData.append('file', file);\n    const response = await greenhouse.post('/recordings', formData, {\n      headers: { 'Content-Type': 'multipart/form-data' },\n    });\n    // get the existing list of current recordings from local storage and add new stream id\n    const recordingList =\n      JSON.parse(localStorage.getItem('recording-list')) || [];\n    localStorage.setItem(\n      'recording-list',\n      JSON.stringify([...recordingList, response.data])\n    );\n\n    const index = recordingList.length;\n\n    dispatch({ type: CREATE_RECORDING, payload: { file, index } });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const createPlaylist = (formValues) => async (dispatch, getState) => {\n  try {\n    const { currentBand } = getState().bands;\n    const response = await greenhouse.post('/playlists', {\n      ...formValues,\n      currentBand: currentBand.id,\n    });\n    dispatch({ type: CREATE_PLAYLIST, payload: response.data });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const createPlaylistSong =\n  (formValues) => async (dispatch, getState) => {\n    try {\n      const { currentBand } = getState().bands;\n      const response = await greenhouse.post('/playlistsongs', {\n        ...formValues,\n        currentBand: currentBand.id,\n      });\n      dispatch({\n        type: CREATE_PLAYLISTSONG,\n        payload: {\n          playlistsong: response.data,\n          playlist: formValues.playlistId,\n        },\n      });\n    } catch (err) {\n      dispatch(errorHandler(err));\n    }\n  };\n\nexport const editBand = (formValues, bandId) => async (dispatch) => {\n  try {\n    const response = await greenhouse.patch('/bands', {\n      ...formValues,\n      currentBand: bandId,\n    });\n    dispatch({ type: EDIT_BAND, payload: response.data });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const editTier = (formValues, tierId) => async (dispatch, getState) => {\n  try {\n    const { currentBand } = getState().bands;\n    const response = await greenhouse.patch(`/tiers/${tierId}`, {\n      ...formValues,\n      currentBand: currentBand.id,\n    });\n    dispatch({ type: EDIT_TIER, payload: response.data });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const editTitle =\n  (formValues, titleId, tierId) => async (dispatch, getState) => {\n    try {\n      const { currentBand } = getState().bands;\n      let changeTier = formValues.move;\n      const response = await greenhouse.patch(`/titles/${titleId}`, {\n        ...formValues,\n        currentTier: tierId,\n        currentBand: currentBand.id,\n      });\n      dispatch({\n        type: EDIT_TITLE,\n        payload: {\n          title: response.data,\n          tier: { new: changeTier, old: tierId },\n        },\n      });\n    } catch (err) {\n      dispatch(errorHandler(err));\n    }\n  };\n\nexport const editVersion =\n  (formValues, versionId, titleId) => async (dispatch, getState) => {\n    try {\n      const { currentBand } = getState().bands;\n      const thisVersion = getState().versions[versionId];\n      if (thisVersion.current) {\n        formValues.current = true;\n      }\n      const response = await greenhouse.patch(`/versions/${versionId}`, {\n        ...formValues,\n        currentBand: currentBand.id,\n      });\n      if (response.data.current && !thisVersion.current) {\n        const parentTitle = getState().titles[titleId];\n        const versionList = parentTitle.versions.map(\n          (id) => getState().versions[id]\n        );\n        const oldCurrent = versionList.find((v) => v.current);\n        oldCurrent.current = false;\n        dispatch(\n          editVersion(\n            _.pick(oldCurrent, 'name', 'notes', 'current'),\n            oldCurrent.id,\n            titleId\n          )\n        );\n      }\n\n      // dispatch({ type: SELECT_VERSION, payload: { titleId, version: response.data } });\n      dispatch({\n        type: EDIT_VERSION,\n        payload: { version: response.data, title: titleId },\n      });\n    } catch (err) {\n      dispatch(errorHandler(err));\n    }\n  };\n\nexport const editBounce =\n  (formValues, bounceId, versionId) => async (dispatch, getState) => {\n    try {\n      const { currentBand } = getState().bands;\n      const thisBounce = getState().bounces[bounceId];\n      if (thisBounce.latest) {\n        formValues.latest = true;\n      }\n      if (formValues.file && formValues.file.length) {\n        formValues.file = formValues.file[0];\n\n        // Create instance of FileReader\n        const reader = new FileReader();\n\n        // When the file has been succesfully read\n        reader.onload = (event) => {\n          // Create an instance of AudioContext\n          const audioContext = new (window.AudioContext ||\n            window.webkitAudioContext)();\n\n          // Asynchronously decode audio file data contained in an ArrayBuffer.\n          audioContext.decodeAudioData(event.target.result, async (buffer) => {\n            // Obtain the duration in seconds of the audio file (with milliseconds as well, a float value)\n            const duration = parseInt(buffer.duration);\n\n            const formObject = {\n              ...formValues,\n              currentBand: currentBand.id,\n              duration,\n            };\n\n            const formData = new FormData();\n\n            for (let key in formObject) {\n              formData.append(key, formObject[key]);\n            }\n\n            const response = await greenhouse.patch(\n              `/bounces/${bounceId}`,\n              formData,\n              {\n                headers: { 'Content-Type': 'multipart/form-data' },\n              }\n            );\n\n            if (response.data.latest && !thisBounce.latest) {\n              const parentVersion = getState().versions[versionId];\n              const bounceList = parentVersion.bounces.map(\n                (id) => getState().bounces[id]\n              );\n              const oldLatest = bounceList.find((b) => b.latest);\n              oldLatest.latest = false;\n              dispatch(\n                editBounce(\n                  _.pick(oldLatest, 'date', 'comments', 'latest'),\n                  oldLatest.id,\n                  versionId\n                )\n              );\n            }\n\n            dispatch({ type: EDIT_BOUNCE, payload: response.data });\n          });\n        };\n\n        // In case the file couldn't be read\n        reader.onerror = (event) => {\n          console.error('An error ocurred reading the file: ', event);\n        };\n\n        // Read file as an ArrayBuffer, important !\n        reader.readAsArrayBuffer(formValues.file);\n      } else {\n        const response = await greenhouse.patch(`/bounces/${bounceId}`, {\n          ...formValues,\n          currentBand: currentBand.id,\n        });\n        if (response.data.latest && !thisBounce.latest) {\n          const parentVersion = getState().versions[versionId];\n          const bounceList = parentVersion.bounces.map(\n            (id) => getState().bounces[id]\n          );\n          const oldLatest = bounceList.find((b) => b.latest);\n          oldLatest.latest = false;\n          dispatch(\n            editBounce(\n              _.pick(oldLatest, 'date', 'comments', 'latest'),\n              oldLatest.id,\n              versionId\n            )\n          );\n        }\n\n        dispatch({ type: EDIT_BOUNCE, payload: response.data });\n      }\n    } catch (err) {\n      dispatch(errorHandler(err));\n    }\n  };\n\nexport const editPlaylist =\n  (formValues, playlistId) => async (dispatch, getState) => {\n    try {\n      const { currentBand } = getState().bands;\n      const response = await greenhouse.patch(`/playlists/${playlistId}`, {\n        ...formValues,\n        currentBand: currentBand.id,\n      });\n      dispatch({ type: EDIT_PLAYLIST, payload: response.data });\n    } catch (err) {\n      dispatch(errorHandler(err));\n    }\n  };\n\nexport const editPlaylistSong =\n  (formValues, playlistSongId) => async (dispatch, getState) => {\n    try {\n      const { currentBand } = getState().bands;\n      const song = getState().playlistSongs[playlistSongId];\n      if (formValues.move) {\n        const newSong = {\n          playlistId: formValues.move,\n          title: song.title,\n          version: song.version,\n          bounce: song.bounce,\n        };\n        dispatch(createPlaylistSong(newSong));\n      }\n      const response = await greenhouse.patch(\n        `/playlistsongs/${playlistSongId}`,\n        { ...formValues, currentBand: currentBand.id }\n      );\n      dispatch({\n        type: EDIT_PLAYLISTSONG,\n        payload: {\n          playlistsong: response.data,\n          playlist: formValues.playlistId,\n        },\n      });\n    } catch (err) {\n      dispatch(errorHandler(err));\n    }\n  };\n\nexport const deleteBand = (bandId) => async (dispatch) => {\n  try {\n    const response = await greenhouse.post('/bands/delete', {\n      currentBand: bandId,\n    });\n    response.data.tiers.forEach((tierId) => {\n      dispatch(deleteTier(tierId, response.data.id));\n    });\n    dispatch({ type: DELETE_BAND, payload: response.data });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const deleteTier = (tierId) => async (dispatch, getState) => {\n  const { currentBand } = getState().bands;\n  try {\n    const response = await greenhouse.post('/tiers/delete', {\n      tierId,\n      currentBand: currentBand.id,\n    });\n    response.data.trackList.forEach((titleId) => {\n      dispatch(deleteTitle(titleId, response.data.id));\n    });\n    dispatch({ type: DELETE_TIER, payload: response.data });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const deleteTitle = (titleId, tierId) => async (dispatch, getState) => {\n  const { currentBand } = getState().bands;\n  try {\n    const response = await greenhouse.post('/titles/delete', {\n      titleId,\n      tierId,\n      currentBand: currentBand.id,\n    });\n    response.data.versions.forEach((versionId) => {\n      dispatch(deleteVersion(versionId, response.data.id));\n    });\n    const playlists = Object.values(getState().playlists);\n    const playlistSongs = Object.values(getState().playlistSongs).filter(\n      (pls) => pls.title === titleId\n    );\n    playlistSongs.forEach((pls) => {\n      const playlist = playlists.find((pl) => pl.songs.includes(pls.id));\n      dispatch(deletePlaylistSong(pls.id, playlist.id));\n    });\n    dispatch({\n      type: DELETE_TITLE,\n      payload: { title: response.data, tier: tierId },\n    });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const deleteVersion =\n  (versionId, titleId) => async (dispatch, getState) => {\n    const { currentBand } = getState().bands;\n    try {\n      const response = await greenhouse.post('/versions/delete', {\n        versionId,\n        titleId,\n        currentBand: currentBand.id,\n      });\n      if (response.data.current) {\n        const parentTitle = getState().titles[titleId];\n        if (parentTitle) {\n          const remainingVersions = parentTitle.versions.filter(\n            (id) => id !== versionId\n          );\n          if (remainingVersions.length) {\n            const newCurrent =\n              getState().versions[\n                remainingVersions[remainingVersions.length - 1]\n              ];\n            newCurrent.current = true;\n            dispatch(selectVersion(newCurrent, titleId));\n            dispatch(\n              editVersion(\n                _.pick(newCurrent, 'name', 'notes', 'current'),\n                newCurrent.id,\n                titleId\n              )\n            );\n          } else {\n            dispatch(selectVersion(null, titleId));\n          }\n        }\n      }\n      response.data.bounces.forEach((bounceId) => {\n        dispatch(deleteBounce(bounceId, response.data.id, titleId));\n      });\n      dispatch({\n        type: DELETE_VERSION,\n        payload: { version: response.data, title: titleId },\n      });\n    } catch (err) {\n      dispatch(errorHandler(err));\n    }\n  };\n\nexport const deleteBounce =\n  (bounceId, versionId, titleId) => async (dispatch, getState) => {\n    const { currentBand } = getState().bands;\n    try {\n      const response = await greenhouse.post('/bounces/delete', {\n        bounceId,\n        versionId,\n        currentBand: currentBand.id,\n      });\n      if (response.data.latest) {\n        const parentVersion = getState().versions[versionId];\n        if (parentVersion) {\n          const remainingBounces = parentVersion.bounces.filter(\n            (id) => id !== bounceId\n          );\n          if (remainingBounces.length) {\n            const newLatest =\n              getState().bounces[remainingBounces[remainingBounces.length - 1]];\n            newLatest.latest = true;\n            dispatch(selectBounce(newLatest.id, titleId));\n            dispatch(\n              editBounce(\n                _.pick(newLatest, 'date', 'comments', 'latest'),\n                newLatest.id,\n                versionId\n              )\n            );\n          } else {\n            dispatch(selectBounce(null, titleId));\n          }\n        }\n      }\n      dispatch({\n        type: DELETE_BOUNCE,\n        payload: { bounce: response.data, version: versionId },\n      });\n    } catch (err) {\n      dispatch(errorHandler(err));\n    }\n  };\n\nexport const deletePlaylist = (playlistId) => async (dispatch, getState) => {\n  const { currentBand } = getState().bands;\n  try {\n    const response = await greenhouse.post('/playlists/delete', {\n      playlistId,\n      currentBand: currentBand.id,\n    });\n    response.data.songs.forEach((playlistSongId) => {\n      dispatch(deletePlaylistSong(playlistSongId, response.data.id));\n    });\n    dispatch({ type: DELETE_PLAYLIST, payload: response.data });\n  } catch (err) {\n    dispatch(errorHandler(err));\n  }\n};\n\nexport const deletePlaylistSong =\n  (playlistSongId, playlistId) => async (dispatch, getState) => {\n    const { currentBand } = getState().bands;\n    try {\n      const response = await greenhouse.post('/playlistsongs/delete', {\n        playlistSongId,\n        playlistId,\n        currentBand: currentBand.id,\n      });\n      dispatch({\n        type: DELETE_PLAYLISTSONG,\n        payload: { playlistsong: response.data, playlist: playlistId },\n      });\n    } catch (err) {\n      dispatch(errorHandler(err));\n    }\n  };\n\nexport const clearRecordings = () => (dispatch) => {\n  const recordingList = JSON.parse(localStorage.getItem('recording-list'));\n  if (recordingList) {\n    recordingList.forEach((id) => {\n      greenhouse.post('/recordings/delete', { id });\n    });\n    localStorage.removeItem('recording-list');\n  }\n  dispatch({ type: CLEAR_RECORDINGS });\n};\n\nexport const playAudio = () => {\n  return { type: PLAY_AUDIO };\n};\n\nexport const pauseAudio = () => {\n  return { type: PAUSE_AUDIO };\n};\n\nexport const queueSongs = (song) => (dispatch) => {\n  const songObject = {\n    title: song.title,\n    version: song.version.name,\n    date: song.bounce.date,\n    duration: song.bounce.duration,\n    audio: song.bounce.id,\n  };\n\n  dispatch({\n    type: QUEUE_SONGS,\n    payload: { song: songObject, parent: song.tier },\n  });\n};\n\nexport const queuePlaylistSongs = (song) => (dispatch, getState) => {\n  // const version = getState().versions[song.version];\n  // const bounce = getState().bounces[song.bounce];\n  // const title = getState().titles[song.title];\n\n  const songObject = {\n    title: song.title,\n    version: song.version.name,\n    date: song.bounce.date,\n    duration: song.bounce.duration,\n    audio: song.bounce.id,\n    position: song.position,\n  };\n\n  dispatch({\n    type: QUEUE_SONGS,\n    payload: { song: songObject, parent: song.playlist },\n  });\n};\n\nexport const setOrder = (tier, orderBy) => {\n  return { type: ORDER_TIER, payload: { tier, orderBy } };\n};\n\nexport const nextSong = () => (dispatch, getState) => {\n  const { parent, currentSong } = getState().audio;\n  if (parent.trackList) {\n    let allTitles;\n\n    if (parent.orderBy === 'date') {\n      allTitles = parent.trackList\n        .map((id) => getState().titles[id])\n        .sort((a, b) => {\n          if (a.selectedBounce && b.selectedBounce) {\n            if (\n              new Date(a.selectedBounce.date) > new Date(b.selectedBounce.date)\n            ) {\n              return -1;\n            } else {\n              return 1;\n            }\n          } else if (a.selectedBounce) {\n            return -1;\n          } else if (b.selectedBounce) {\n            return 1;\n          }\n        });\n    }\n\n    if (parent.orderBy === 'name') {\n      allTitles = parent.trackList\n        .map((id) => getState().titles[id])\n        .sort((a, b) => {\n          return a.title < b.title ? -1 : 1;\n        });\n    }\n\n    const song = allTitles[allTitles.indexOf(currentSong.title) + 1];\n\n    if (song && song.selectedVersion && song.selectedBounce) {\n      const version = getState().versions[song.selectedVersion.id];\n      const bounce = getState().bounces[song.selectedBounce.id];\n\n      const songObject = {\n        title: song,\n        version: version.name,\n        date: bounce.date,\n        duration: bounce.duration,\n        audio: bounce.id,\n      };\n\n      dispatch({ type: NEXT_SONG, payload: songObject });\n    } else {\n      dispatch({ type: INITIALIZE_AUDIO });\n    }\n  }\n  if (parent.songs) {\n    const allSongs = parent.songs\n      .map((id) => getState().playlistSongs[id])\n      .sort((a, b) => (a.position < b.position ? -1 : 1));\n\n    let song;\n    let index = currentSong.position;\n\n    while (index < allSongs.length) {\n      if (allSongs[index].bounce !== null) {\n        song = allSongs[index];\n        break;\n      }\n      index++;\n    }\n\n    if (!song) {\n      return dispatch({ type: INITIALIZE_AUDIO });\n    }\n\n    const version = getState().versions[song.version];\n    const bounce = getState().bounces[song.bounce];\n    const title = getState().titles[song.title];\n\n    const songObject = {\n      title: title,\n      version: version.name,\n      date: bounce.date,\n      duration: bounce.duration,\n      audio: bounce.id,\n      position: song.position,\n    };\n    dispatch({ type: NEXT_SONG, payload: songObject });\n  }\n};\n\nexport const prevSong = () => (dispatch, getState) => {\n  const { parent, currentSong } = getState().audio;\n  if (parent.trackList) {\n    let allTitles;\n    if (parent.orderBy === 'date') {\n      allTitles = parent.trackList\n        .map((id) => getState().titles[id])\n        .sort((a, b) => {\n          if (a.selectedBounce && b.selectedBounce) {\n            if (\n              new Date(a.selectedBounce.date) > new Date(b.selectedBounce.date)\n            ) {\n              return -1;\n            } else {\n              return 1;\n            }\n          } else if (a.selectedBounce) {\n            return -1;\n          } else if (b.selectedBounce) {\n            return 1;\n          }\n        });\n    }\n\n    if (parent.orderBy === 'name') {\n      allTitles = parent.trackList\n        .map((id) => getState().titles[id])\n        .sort((a, b) => {\n          return a.title < b.title ? -1 : 1;\n        });\n    }\n\n    const song = allTitles[allTitles.indexOf(currentSong.title) - 1];\n\n    if (song && song.selectedVersion && song.selectedBounce) {\n      const version = getState().versions[song.selectedVersion.id];\n      const bounce = getState().bounces[song.selectedBounce.id];\n\n      const songObject = {\n        title: song,\n        version: version.name,\n        date: bounce.date,\n        duration: bounce.duration,\n        audio: bounce.id,\n      };\n\n      dispatch({ type: NEXT_SONG, payload: songObject });\n    }\n  }\n\n  if (parent.songs) {\n    const allSongs = parent.songs\n      .map((id) => getState().playlistSongs[id])\n      .sort((a, b) => (a.position < b.position ? -1 : 1));\n\n    let song;\n    let index = currentSong.position - 2;\n\n    while (index < allSongs.length) {\n      if (allSongs[index].bounce !== null) {\n        song = allSongs[index];\n        break;\n      }\n      index = index - 1;\n    }\n\n    if (!song) {\n      return dispatch({ type: INITIALIZE_AUDIO });\n    }\n\n    const version = getState().versions[song.version];\n    const bounce = getState().bounces[song.bounce];\n    const title = getState().titles[song.title];\n\n    const songObject = {\n      title: title,\n      version: version.name,\n      date: bounce.date,\n      duration: bounce.duration,\n      audio: bounce.id,\n      position: song.position,\n    };\n    dispatch({ type: NEXT_SONG, payload: songObject });\n  }\n};\n\nexport const changeVolume = (value) => {\n  return { type: CHANGE_VOLUME, payload: value };\n};\n\nexport const initializeAudio = () => {\n  return { type: INITIALIZE_AUDIO };\n};\n\nexport const selectVersion = (version, titleId) => {\n  return { type: SELECT_VERSION, payload: { version, titleId } };\n};\n\nexport const selectBounce = (bounce, titleId) => {\n  return { type: SELECT_BOUNCE, payload: { bounce, titleId } };\n};\n","\nimport React, { useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { throwError } from '../actions';\nimport history from '../history';\n\nconst Error = ({ error, throwError }) => {\n\n    useEffect(() => {\n        history.listen(location => {\n            throwError(null);\n        });\n    }, [history]);\n\n    if (!error) {\n        return null;\n    }\n\n    return (\n        <div className=\"error\" onClick={() => throwError(null)}>\n            <div className=\"error-x\">X</div>\n            {error}\n            <div className=\"error-x\">X</div>\n        </div>\n    );\n\n};\n\nconst mapStateToProps = state => {\n    return {\n        error: state.error.error\n    }\n}\n\nexport default connect(mapStateToProps, { throwError })(Error);","import React from 'react';\nimport { Field, reduxForm } from 'redux-form';\n\n\n\nclass AddButton extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.ref = React.createRef();\n    }\n\n    state = { boxVisible: false, selectedOption: null };\n\n    componentDidUpdate(prevProps, prevState) {\n        if (prevState.boxVisible === false && this.state.boxVisible === true) {\n            document.addEventListener('click', this.bodyClick, {capture: true});\n            document.addEventListener('keydown', this.blockSpaceBarPress, {capture: true});\n        } else if (prevState.boxVisible === true && this.state.boxVisible === false) {\n            document.removeEventListener('click', this.bodyClick, {capture: true});\n            document.removeEventListener('keydown', this.blockSpaceBarPress, {capture: true});\n        }\n        \n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('click', this.bodyClick, {capture: true});\n        document.removeEventListener('keydown', this.blockSpaceBarPress, {capture: true});\n    }\n\n    blockSpaceBarPress = (e) => {\n        e.stopPropagation();\n    }\n\n    bodyClick = (e) => {\n        if (this.ref.current && this.ref.current.contains(e.target)) {\n            return;\n        }\n        if (this.state.boxVisible) {\n            this.setState({ boxVisible: false });\n        }\n    }\n\n    showOptions = (field) => {\n        return field.options.map(option => {\n            return (\n                <option\n                    key={option.value}\n                    value={option.value}\n                >\n                    {option.display}\n                </option>\n            );\n        });\n    };\n\n    onDrop = (e, input) => {\n        const file = e.target.files[0];\n        const { onChange } = input;\n        onChange(file);\n    }\n\n    input = (field) => {\n        let inputClass = '';\n        if (field.type === 'date') {\n            inputClass = 'calendar';\n        }\n        if (field.type === 'checkbox') {\n            inputClass = 'checkbox';\n        }\n        if (field.type === 'input') {\n            inputClass = 'text-input';\n        }\n\n        const errors = \n            <div className=\"form-errors\">\n            {field.meta.touched && (field.meta.error && <p>{field.meta.error}<span>&darr;</span></p>)}\n            </div>;\n\n        if (field.type === 'file') {\n            delete field.input.value;\n            return <>\n                {errors}\n                <input\n                    {...field.input}\n                    type='file'\n                    className='inputfile'\n                    onDrop={(e) => this.onDrop(e, field.input)}\n                        \n                />\n            </>;\n        } else if (field.type === 'select') {\n            return <>\n                {errors}\n                <select\n                    {...field.input}\n                    autoFocus={field.autoFocus}\n                >\n                    {field.options ? this.showOptions(field) : null}\n                </select>\n            </>;\n        } else {\n            return <>\n                {errors}\n                <input\n                    {...field.input}\n                    autoFocus={field.autoFocus}\n                    type={field.type}\n                    className={inputClass}\n                />\n            </>;\n        }\n    }\n\n    required = value => {\n        return value ? undefined : 'Required';\n    }\n\n    showFields = () => {\n\n        return this.props.fields.map((field, i) => {\n            const autoFocus = i === 0 ? true : false;\n            let comp = this.input;\n            if (field.type === 'textarea') {\n                comp = 'textarea'\n            }\n            return <div key={field.label}>\n                <label>{field.label}: </label>\n                <Field\n                    name={field.name}\n                    component={comp}\n                    autoFocus={autoFocus}\n                    type={field.type}\n                    validate={field.required ? this.required : null}\n                    options={field.options}\n                >\n                    {field.options ? this.showOptions(field) : null}\n                </Field>\n            </div>\n        });\n \n    };\n\n    submitForm = (formValues) => {\n        this.props.onSubmit(formValues);\n        this.setState({ boxVisible: false });\n        this.props.reset();\n    }\n\n    showBox = () => {\n        if (this.state.boxVisible) {\n            const addClass = this.props.addClass ? this.props.addClass : '';\n            return <>    \n                <div className={`add-box ${addClass}`} onClick={e => e.stopPropagation()}>\n                    <h3 className=\"add-box-title\">{this.props.title}</h3>\n                    <form onSubmit = {this.props.handleSubmit(this.submitForm)}>\n                        {this.showFields()}\n                        <div className=\"submit-button-centered\">\n                            <button className=\"submit-button\"type='submit'>OK</button>\n                        </div>\n                    </form>\n                </div>\n            </>\n        }\n    }\n\n    click = (e) => {\n        e.stopPropagation();\n        if (this.ref.current && this.ref.current === e.target) {\n            return;\n        }\n        if (this.state.boxVisible) {\n            this.setState({ boxVisible: false });\n        } else {\n            this.setState({ boxVisible: true });\n        }\n\n    }\n    \n    render() {\n\n        return <>\n            <div className=\"add\" onClick={this.click} ref={this.ref}>\n                <img src={this.props.image} />\n                {this.showBox()}\n            </div>\n        </>;\n    }\n\n}\n\nexport default reduxForm({ form: 'form' })(AddButton);","import React from 'react';\nimport ReactDOM from 'react-dom';\n\n\nclass Modal extends React.Component {\n\n    componentDidMount() {\n        document.querySelector('.container').classList.add('modal-active');\n    }\n    componentWillUnmount() {\n        document.querySelector('.container').classList.remove('modal-active');\n    }\n\n    render() {\n        return ReactDOM.createPortal(\n            <div onClick={this.props.onDismiss} className=\"modal-background\">\n                <div \n                    onClick={e => e.stopPropagation()}\n                    className=\"modal-box\"\n                >\n                    <div className=\"modal-title\">\n                        {this.props.content}\n                    </div>\n                    <div>\n                        {this.props.actions}\n                    </div>\n                </div>\n            </div>,\n            document.querySelector('#modal')\n        );\n    }\n};\n\nexport default Modal;","import React, { useState } from 'react';\nimport Modal from './Modal';\n\nconst DeleteButton = ({ onSubmit, displayName }) => {\n\n    const [visible, setVisible] = useState(false);\n\n    const renderContent = () => {\n        return `Seriously delete \"${displayName}\"?`;\n    };\n\n    const renderActions = () => {\n        return (\n            <>\n                <button\n                    className=\"modal-button\"\n                    onClick={() => {\n                        onSubmit();\n                        setVisible(false);\n                    }}\n                >\n                    Delete\n                </button>\n                <button\n                    className=\"modal-button\"\n                    onClick={() => setVisible(false)}\n                >\n                    No Wait\n                </button>\n            </>\n        );\n    };\n\n    const showModal = () => {\n\n        return (\n            <Modal \n                content={renderContent()}\n                actions={renderActions()}\n                onDismiss={e => {\n                    e.stopPropagation();\n                    setVisible(false)\n                }}\n            />\n        );\n    };\n\n\n\n    const onClick = (e) => {\n        e.stopPropagation();\n        setVisible(true);\n    };\n\n\n    return (\n        <div>\n            <img src=\"/images/delete.png\" className=\"delete\" onClick={onClick} />\n            {visible && showModal()}\n        </div>\n    );\n\n};\n\nexport default DeleteButton;","import React from 'react';\nimport { connect } from 'react-redux';\n\nexport default ChildComponent => {\n\n    class ComposedComponent extends React.Component {\n\n        constructor(props) {\n            super(props);\n        }\n\n        state = { authorized: false };\n\n        componentDidMount() {\n            this.checkAuth();\n        }\n\n\n        // componentDidUpdate() {\n        //     this.checkAuth();\n        // }\n\n        handleUpdate = () => {\n            this.checkAuth();\n        }\n\n        checkAuth() {\n            if (this.props.user && this.props.currentBand && this.props.user.bands.includes(this.props.currentBand.id)) {\n                this.setState({ authorized: true });\n            }\n        }\n\n        render() {\n            return <ChildComponent {...this.props} authorized={this.state.authorized} handleUpdate={this.handleUpdate} />;\n\n        }\n\n    }\n\n    const mapStateToProps = state => {\n        return {\n            user: state.auth.user,\n            currentBand: state.bands.currentBand\n        }\n    };\n\n    return connect(mapStateToProps)(ComposedComponent);\n\n};\n\n","import React, { useEffect, useState, useRef } from 'react';\n\nconst DetailBox = ({ selectedItem, itemList, itemType, displayItem, setSelected, renderAddButton, renderEditButton, renderDeleteButton, playButton }) => {\n\n    const [dropdownVisible, setDropdownVisible] = useState(false);\n\n    const dropdownRef = useRef(null);\n\n    useEffect(() => {\n        if (dropdownVisible) {\n            document.addEventListener('click', onBodyClick, {capture: true});\n        } else {\n            document.removeEventListener('click', onBodyClick, {capture: true});\n        }\n    }, [dropdownVisible]);\n\n    const count = () => {\n        let count;\n        if (itemList().length === 0) {\n            count = `1 ${itemType}:`;\n        } else {\n            count = `${itemList().length + 1} ${itemType}s:`\n        }\n\n        return (\n            <h5>{count}</h5>\n        );\n    };\n\n    const currentTag = () => {\n        if (selectedItem.current || selectedItem.latest) {\n            return (\n                <div className=\"current\">\n                    Current\n                </div>\n            );\n        }\n    };\n\n    const onBodyClick = e => {\n\n        if (dropdownRef.current && dropdownRef.current.contains(e.target)) {\n            return;\n        }\n\n        if (dropdownVisible) {\n            setDropdownVisible(false);\n        }\n    };\n\n    const renderItemList = () => {\n        if (dropdownVisible) {\n            \n            return itemList().map(i => {\n                const current = i.current || i.latest ? <span className=\"list-current\"> * current</span> : null;\n                return <div\n                    className=\"dropdown-link\"\n                    onClick={() => {\n                        setSelected(i);\n                        setDropdownVisible(false);\n                    }}\n                    key={i.id}\n                >\n                        {displayItem(i)}\n                        {current}\n                </div>\n            });\n        }\n    };\n\n\n    const renderDetail = () => {\n        if (selectedItem) {\n            return (\n                <div className=\"detail-content\">\n                    <div className=\"detail-header\">\n                        {count()}\n                        {currentTag()}\n                    </div>\n                    <div className='dropdown-container'>\n                        <div className=\"dropdown\" ref={dropdownRef}>\n                            <button\n                                className=\"dropbtn\"\n                                onClick={() => setDropdownVisible(!dropdownVisible)}\n                            >\n                                {displayItem(selectedItem)}\n                            </button>\n                            <div className=\"dropdown-content\">\n                                {renderItemList()}\n                            </div>\n                        </div>\n                        {playButton && playButton()}\n                    </div>\n                    \n                    \n                    <div className=\"detail-notes\">\n                        <div className=\"detail-notes-title\">Notes:</div>\n                        <p>\n                            {selectedItem.notes || selectedItem.comments}\n                        </p>\n                    </div>\n                </div>\n            );\n        } else {\n            let parentType = '';\n            if (itemType === 'Version') {\n                parentType = 'Song';\n            }\n            if (itemType === 'Bounce') {\n                parentType = 'Version';\n            }\n            return (\n                <div className=\"detail-content\">\n                    <div className=\"detail-header\">\n                        <h5>{`No ${itemType}s for this ${parentType} Yet`}</h5>\n                    </div>\n                </div>\n            );\n        }\n    };\n\n    return (\n        <div\n            className={`detail-box ${itemType === 'Bounce' ? 'bounce' : ''}`}\n        >\n            {renderDetail()}      \n            <div className=\"detail-buttons\">\n                {renderAddButton()}\n                {selectedItem && renderEditButton()}\n                {selectedItem && renderDeleteButton()}\n            </div>\n        </div>\n    );\n};\n\nexport default DetailBox;","import React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport moment from 'moment';\nimport _ from 'lodash';\n\nimport AddButton from './AddButton';\nimport DeleteButton from './DeleteButton';\nimport requireAuth from './requireAuth';\nimport DetailBox from './DetailBox';\nimport {\n  selectBounce,\n  createBounce,\n  editBounce,\n  deleteBounce,\n  queueSongs,\n} from '../actions';\n\nconst Bounce = ({\n  bounces,\n  selectBounce,\n  title,\n  authorized,\n  version,\n  createBounce,\n  editBounce,\n  deleteBounce,\n  song,\n  queueSongs,\n}) => {\n  const [selectedBounce, setSelectedBounce] = useState(title.selectedBounce);\n\n  const [uploadActive, setUploadActive] = useState(false);\n\n  // const [playButtonVisible, setPlayButtonVisible] = useState(false);\n\n  useEffect(() => {\n    if (selectedBounce && selectedBounce !== title.selectedBounce) {\n      selectBounce(selectedBounce, title.id);\n      // setPlayButtonVisible(true);\n    }\n  }, [selectedBounce]);\n\n  useEffect(() => {\n    if (selectedBounce && selectedBounce !== title.selectedBounce) {\n      selectBounce(title.selectedBounce, title.id);\n    }\n  }, [title.selectedBounce]);\n\n  useEffect(() => {\n    setSelectedBounce(title.selectedBounce);\n    setUploadActive(false);\n  }, [title.selectedBounce]);\n\n  const displayDate = (date) => {\n    return moment.utc(date).format('MM/DD/yy');\n  };\n\n  const displayBounce = (b) => {\n    return `${displayDate(b.date)}`;\n  };\n\n  const itemList = () => {\n    if (selectedBounce) {\n      return bounces\n        .filter((b) => b && b.id !== selectedBounce.id)\n        .sort((a, b) => (a.date < b.date ? 1 : -1));\n    }\n  };\n\n  const onAddSubmit = (formValues) => {\n    createBounce(formValues, version.id);\n    setUploadActive(true);\n  };\n\n  const onEditSubmit = (formValues) => {\n    editBounce(formValues, selectedBounce.id, version.id);\n    setUploadActive(true);\n  };\n\n  const uploadContent = () => {\n    return (\n      <div className=\"upload-image\">\n        <p>Uploading...</p>\n        <img className=\"windmill\" src=\"/images/windmill.gif\" />\n      </div>\n    );\n  };\n\n  const renderAddButton = () => {\n    if (authorized) {\n      return (\n        <AddButton\n          title={`Add a Bounce of ${version.name}`}\n          image=\"images/add.png\"\n          fields={[\n            {\n              label: 'File',\n              name: 'file',\n              type: 'file',\n              required: true,\n            },\n            {\n              label: 'Date',\n              name: 'date',\n              type: 'date',\n              required: true,\n            },\n            {\n              label: 'Comments',\n              name: 'comments',\n              type: 'textarea',\n            },\n            {\n              label: 'Latest Bounce?',\n              name: 'latest',\n              type: 'checkbox',\n            },\n          ]}\n          onSubmit={(formValues) => onAddSubmit(formValues)}\n          form={`add-bounce-${title.id}`}\n          initialValues={{ latest: true }}\n          addClass=\"add-bounce\"\n        />\n      );\n    }\n  };\n\n  const renderEditButton = () => {\n    if (authorized) {\n      return (\n        <AddButton\n          title={'Edit this Bounce'}\n          image=\"images/edit.png\"\n          fields={[\n            {\n              label: 'File',\n              name: 'file',\n              type: 'file',\n            },\n            {\n              label: 'Date',\n              name: 'date',\n              type: 'date',\n            },\n            {\n              label: 'Comments',\n              name: 'comments',\n              type: 'textarea',\n            },\n            {\n              label: 'Current Bounce?',\n              name: 'latest',\n              type: 'checkbox',\n            },\n          ]}\n          onSubmit={onEditSubmit}\n          initialValues={{\n            ..._.pick(selectedBounce, 'comments', 'latest'),\n            date: moment.utc(selectedBounce.date).format('YYYY-MM-DD'),\n          }}\n          form={`edit-bounce-${title.id}`}\n          enableReinitialize={true}\n          addClass=\"add-bounce\"\n        />\n      );\n    }\n  };\n\n  const renderDeleteButton = () => {\n    if (authorized) {\n      return (\n        <DeleteButton\n          onSubmit={() => deleteBounce(selectedBounce.id, version.id, title.id)}\n          displayName={displayDate(selectedBounce.date)}\n        />\n      );\n    }\n  };\n\n  const showPlayButton = () => {\n    // if (playButtonVisible) {\n\n    return (\n      <img\n        src=\"/images/play.svg\"\n        className=\"play-icon\"\n        onClick={() => queueSongs(song)}\n      />\n    );\n    // }\n  };\n\n  if (uploadActive) {\n    return <div className=\"detail-box bounce\">{uploadContent()}</div>;\n  } else {\n    if (version) {\n      return (\n        <DetailBox\n          selectedItem={selectedBounce}\n          itemType=\"Bounce\"\n          itemList={itemList}\n          displayItem={displayBounce}\n          setSelected={setSelectedBounce}\n          renderAddButton={renderAddButton}\n          renderEditButton={renderEditButton}\n          renderDeleteButton={renderDeleteButton}\n          playButton={showPlayButton}\n        />\n      );\n    } else {\n      return null;\n    }\n  }\n};\n\nexport default connect(null, {\n  selectBounce,\n  createBounce,\n  editBounce,\n  deleteBounce,\n  queueSongs,\n})(requireAuth(Bounce));\n","import React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport _ from 'lodash';\nimport { Link } from 'react-router-dom';\n\nimport {\n  fetchBounces,\n  selectVersion,\n  createVersion,\n  editVersion,\n  deleteVersion,\n} from '../actions';\nimport Bounce from './Bounce';\nimport AddButton from './AddButton';\nimport DeleteButton from './DeleteButton';\nimport requireAuth from './requireAuth';\nimport DetailBox from './DetailBox';\n\nconst Version = ({\n  versions,\n  bounces,\n  fetchBounces,\n  selectVersion,\n  title,\n  createVersion,\n  authorized,\n  editVersion,\n  deleteVersion,\n  song,\n  tier,\n  band,\n}) => {\n  const [selectedVersion, setSelectedVersion] = useState(title.selectedVersion);\n  const [bounceList, setBounceList] = useState(null);\n\n  useEffect(() => {\n    // console.log(selectedVersion);\n    if (selectedVersion !== title.selectedVersion) {\n      selectVersion(selectedVersion, title.id);\n      setBounceList(selectedVersion.bounces.map((id) => bounces[id]));\n      fetchBounces(selectedVersion.id);\n    }\n  }, [selectedVersion]);\n\n  useEffect(() => {\n    if (selectedVersion) {\n      // console.log(title.selectedVersion)\n      setBounceList(selectedVersion.bounces.map((id) => bounces[id]));\n    }\n  }, [bounces, selectedVersion]);\n\n  useEffect(() => {\n    if (selectedVersion !== title.selectedVersion) {\n      setSelectedVersion(title.selectedVersion);\n    }\n  }, [title.selectedVersion]);\n\n  const renderBounces = () => {\n    if (bounceList && selectedVersion) {\n      return (\n        <Bounce\n          bounces={bounceList}\n          title={title}\n          version={selectedVersion}\n          song={song}\n        />\n      );\n    }\n  };\n\n  const renderArrow = () => {\n    if (bounceList && selectedVersion) {\n      return <div className=\"version-arrow\">&rarr;</div>;\n    }\n  };\n\n  const renderRecordLink = () => {\n    if (authorized && selectedVersion) {\n      return (\n        <Link\n          to={{\n            pathname: `/${band.url}/record`,\n            state: {\n              version: selectedVersion,\n              title,\n              tier,\n            },\n          }}\n          className=\"record-link\"\n        >\n          record a bounce\n        </Link>\n      );\n    }\n  };\n\n  const renderAddButton = () => {\n    if (authorized) {\n      return (\n        <AddButton\n          title={`Add a Version of ${title.title}`}\n          image=\"images/add.png\"\n          fields={[\n            {\n              label: 'Name',\n              name: 'name',\n              type: 'input',\n              required: true,\n            },\n            {\n              label: 'Notes',\n              name: 'notes',\n              type: 'textarea',\n            },\n            {\n              label: 'Current Version?',\n              name: 'current',\n              type: 'checkbox',\n            },\n          ]}\n          onSubmit={(formValues) => createVersion(formValues, title.id)}\n          form={`add-version-${title.id}`}\n          initialValues={{ current: true }}\n          enableReinitialize={true}\n          addClass=\"add-version\"\n        />\n      );\n    }\n  };\n\n  const renderEditButton = () => {\n    if (authorized) {\n      return (\n        <AddButton\n          title={`Edit ${selectedVersion.name}`}\n          image=\"images/edit.png\"\n          fields={[\n            {\n              label: 'Name',\n              name: 'name',\n              type: 'input',\n            },\n            {\n              label: 'Notes',\n              name: 'notes',\n              type: 'textarea',\n            },\n            {\n              label: 'Current Version?',\n              name: 'current',\n              type: 'checkbox',\n            },\n          ]}\n          onSubmit={(formValues) =>\n            editVersion(formValues, selectedVersion.id, title.id)\n          }\n          initialValues={_.pick(selectedVersion, 'name', 'notes', 'current')}\n          form={`edit-version-${title.id}`}\n          enableReinitialize={true}\n          addClass=\"add-version\"\n        />\n      );\n    }\n  };\n\n  const renderDeleteButton = () => {\n    if (authorized) {\n      return (\n        <DeleteButton\n          onSubmit={() => deleteVersion(selectedVersion.id, title.id)}\n          displayName={selectedVersion.name}\n        />\n      );\n    }\n  };\n\n  const itemList = () => {\n    return versions.filter((v) => v.id !== selectedVersion.id);\n  };\n\n  const displayVersion = (v) => {\n    return `${v.name}`;\n  };\n\n  return (\n    <>\n      <DetailBox\n        selectedItem={selectedVersion}\n        itemType=\"Version\"\n        itemList={itemList}\n        displayItem={displayVersion}\n        setSelected={setSelectedVersion}\n        renderAddButton={renderAddButton}\n        renderEditButton={renderEditButton}\n        renderDeleteButton={renderDeleteButton}\n      />\n      <div className=\"detail-box-between\">\n        {renderRecordLink()}\n        {renderArrow()}\n      </div>\n      {renderBounces()}\n    </>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    bounces: state.bounces,\n    band: state.bands.currentBand,\n  };\n};\n\nexport default connect(mapStateToProps, {\n  fetchBounces,\n  selectVersion,\n  createVersion,\n  editVersion,\n  deleteVersion,\n})(requireAuth(Version));\n","import React, { useState } from 'react';\nimport moment from 'moment';\nimport { connect } from 'react-redux';\n\nimport { queueSongs, queuePlaylistSongs, playAudio } from '../actions';\n\nconst PlayContainer = ({\n  song,\n  queueSongs,\n  parentType,\n  queuePlaylistSongs,\n}) => {\n  const [loaded, setLoaded] = useState(false);\n\n  const displayDate = (date) => {\n    return moment.utc(date).format('MM/DD/YY');\n  };\n\n  const displayTime = (time) => {\n    const minutes = Math.floor(time / 60);\n    const seconds =\n      Math.floor(time % 60) < 10\n        ? '0' + Math.floor(time % 60)\n        : Math.floor(time % 60);\n    return `${minutes}:${seconds}`;\n  };\n\n  const onPlay = (e) => {\n    e.stopPropagation();\n    if (parentType === 'tier') {\n      queueSongs(song);\n    } else if (parentType === 'playlist') {\n      queuePlaylistSongs(song);\n    }\n  };\n\n  const renderSpinner = () => {\n    return (\n      <div className=\"sk-circle-fade\">\n        <div className=\"sk-circle-fade-dot\"></div>\n        <div className=\"sk-circle-fade-dot\"></div>\n        <div className=\"sk-circle-fade-dot\"></div>\n        <div className=\"sk-circle-fade-dot\"></div>\n        <div className=\"sk-circle-fade-dot\"></div>\n        <div className=\"sk-circle-fade-dot\"></div>\n        <div className=\"sk-circle-fade-dot\"></div>\n        <div className=\"sk-circle-fade-dot\"></div>\n        <div className=\"sk-circle-fade-dot\"></div>\n        <div className=\"sk-circle-fade-dot\"></div>\n        <div className=\"sk-circle-fade-dot\"></div>\n        <div className=\"sk-circle-fade-dot\"></div>\n      </div>\n    );\n  };\n\n  let baseUrl;\n  if (process.env.NODE_ENV === 'production') {\n    baseUrl = 'https://exploring-the-space.com';\n  } else {\n    baseUrl = 'http://localhost:3001';\n  }\n\n  return (\n    <div className=\"play-container\">\n      <div className=\"play-container-time\">\n        {displayTime(song.bounce.duration)}\n      </div>\n      <div className=\"play-icon-container\">\n        {!loaded && renderSpinner()}\n        <img\n          src=\"/images/play.svg\"\n          className=\"play-icon\"\n          onClick={onPlay}\n          onLoad={() => setLoaded(true)}\n        />\n      </div>\n      <div className=\"play-container-display\">\n        <p>{song.version.name}</p>\n        <p>{displayDate(song.bounce.date)}</p>\n      </div>\n      <a\n        className=\"download\"\n        onClick={(e) => e.stopPropagation()}\n        href={`${baseUrl}/api/audio/download/${\n          song.bounce.id\n        }/${encodeURIComponent(song.title.title)}`}\n      >\n        <img src=\"/images/download.svg\" />\n      </a>\n    </div>\n  );\n};\n\nexport default connect(null, { queueSongs, queuePlaylistSongs, playAudio })(\n  PlayContainer\n);\n","import React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport _ from 'lodash';\nimport { Link } from 'react-router-dom';\n\nimport Version from './Version';\nimport AddButton from './AddButton';\nimport {\n  fetchVersions,\n  fetchBounces,\n  selectBounce,\n  selectVersion,\n  createPlaylistSong,\n  editTitle,\n  deleteTitle,\n} from '../actions';\nimport PlayContainer from './PlayContainer';\nimport requireAuth from './requireAuth';\nimport DeleteButton from './DeleteButton';\n\nconst Title = ({\n  tier,\n  title,\n  titles,\n  fetchVersions,\n  versions,\n  bounces,\n  fetchBounces,\n  authorized,\n  band,\n  playlists,\n  selectVersion,\n  selectBounce,\n  createPlaylistSong,\n  editTitle,\n  deleteTitle,\n  getTime,\n  audio,\n  findLatest,\n  tiers,\n}) => {\n  const [expand, setExpand] = useState(false);\n  const [versionList, setVersionList] = useState(null);\n  const [bounceList, setBounceList] = useState(null);\n  const [song, setSong] = useState(null);\n\n  useEffect(() => {\n    fetchVersions(title.id);\n  }, []);\n\n  useEffect(() => {\n    setVersionList(title.versions.map((id) => versions[id]));\n    // console.log('set version list')\n  }, [versions]);\n\n  useEffect(() => {\n    // console.log(versionList);\n    if (versionList && versionList[0]) {\n      let versionToSelect;\n\n      const parentTitle = titles[title.id];\n\n      const versionIds = versionList.map((v) => v.id);\n\n      if (\n        !parentTitle.selectedVersion ||\n        !versionIds.includes(parentTitle.selectedVersion.id)\n      ) {\n        versionToSelect = versionList.find((v) => v.current);\n      } else if (parentTitle.selectedVersion) {\n        if (!versions[parentTitle.selectedVersion.id]) {\n          versionToSelect = null;\n        } else {\n          versionToSelect = versions[parentTitle.selectedVersion.id];\n        }\n      }\n\n      selectVersion(versionToSelect, title.id);\n    }\n  }, [versionList]);\n\n  useEffect(() => {\n    // console.log(title)\n    if (title.selectedVersion && title.selectedVersion.id) {\n      fetchBounces(title.selectedVersion.id);\n      // console.log('fetch bounces')\n    }\n  }, [title.selectedVersion]);\n\n  useEffect(() => {\n    if (title.selectedVersion) {\n      if (title.selectedVersion.bounces[0]) {\n        setBounceList(title.selectedVersion.bounces.map((id) => bounces[id]));\n        // console.log('set bounce list')\n      } else if (title.selectedBounce !== null) {\n        // console.log('set bounce list null')\n        setBounceList(null);\n        selectBounce(null, title.id);\n      }\n    }\n  }, [bounces]);\n\n  useEffect(() => {\n    if (bounceList && bounceList[0]) {\n      let bounceToSelect;\n\n      if (title.selectedBounce && bounceList.includes(title.selectedBounce)) {\n        bounceToSelect = title.selectedBounce;\n      } else {\n        bounceToSelect = bounceList.find((b) => b.latest);\n        findLatest(title, bounceToSelect);\n      }\n\n      if (bounceToSelect !== title.selectedBounce) {\n        selectBounce(bounceToSelect, title.id);\n        // console.log('select bounce');\n      }\n    } else if (song) {\n      setSong(null);\n    }\n  }, [bounceList]);\n\n  useEffect(() => {\n    if (title.selectedBounce && title.selectedVersion) {\n      setSong({\n        tier,\n        title: titles[title.id],\n        version: title.selectedVersion,\n        bounce: title.selectedBounce,\n      });\n      // console.log('song update')\n      getTime({ id: title.id, duration: title.selectedBounce.duration });\n    } else if (song && !title.selectedBounce) {\n      setSong(null);\n      getTime({ id: title.id, duration: 0 });\n    }\n  }, [titles[title.id]]);\n\n  const renderPlayContainer = () => {\n    if (song) {\n      return <PlayContainer song={song} parentType=\"tier\" />;\n    }\n  };\n\n  const renderAudioEditLink = () => {\n    if (authorized && song) {\n      const { tier, title, version, bounce } = song;\n      return (\n        <Link\n          to={{\n            pathname: `/${band.url}/edit`,\n            state: {\n              tier,\n              title,\n              version,\n              bounce,\n            },\n          }}\n          className=\"edit-link\"\n        >\n          edit audio\n        </Link>\n      );\n    }\n  };\n  const renderVersion = () => {\n    return (\n      <Version versions={versionList} title={title} song={song} tier={tier} />\n    );\n  };\n\n  const onAddToPlaylist = (formValues) => {\n    createPlaylistSong({\n      ...formValues,\n      bounce: title.selectedBounce.id,\n      version: title.selectedVersion.id,\n      title: title.id,\n    });\n  };\n\n  const renderButtons = () => {\n    if (authorized) {\n      const bandPlaylists = band.playlists.map((id) => playlists[id]);\n      const playlistOptions = bandPlaylists.map((pl) => {\n        if (pl) {\n          return { value: pl.id, display: pl.name };\n        }\n      });\n      const bandTiers = band.tiers\n        .filter((t) => t !== tier.id)\n        .map((id) => tiers[id]);\n      const tierOptions = bandTiers.map((t) => {\n        if (t) {\n          return { value: t.id, display: t.name };\n        }\n      });\n      tierOptions.unshift({ value: null, display: '' });\n      return (\n        <div className=\"tier-display\">\n          {song && (\n            <AddButton\n              title=\"Add to a Playlist\"\n              onSubmit={(formValues) => onAddToPlaylist(formValues)}\n              image=\"images/playlist.png\"\n              fields={[\n                {\n                  type: 'select',\n                  options: playlistOptions,\n                  name: 'playlistId',\n                  label: 'Playlist',\n                },\n              ]}\n              form={`add-to-playlist-${title.id}`}\n              enableReinitialize={true}\n            />\n          )}\n          <AddButton\n            title={`Edit ${title.title}`}\n            image=\"images/edit.png\"\n            fields={[\n              {\n                label: 'Title',\n                name: 'title',\n                type: 'input',\n                required: true,\n              },\n              {\n                label: 'Move to Tier',\n                name: 'move',\n                type: 'select',\n                options: tierOptions,\n              },\n            ]}\n            onSubmit={(formValues) => editTitle(formValues, title.id, tier.id)}\n            initialValues={{ title: title.title, move: null }}\n            form={`edit-title-${title.id}`}\n            enableReinitialize={true}\n          />\n          <DeleteButton\n            onSubmit={() => deleteTitle(title.id, tier.id)}\n            displayName={title.title}\n          />\n        </div>\n      );\n    }\n  };\n\n  const arrow = expand ? 'down-arrow' : '';\n\n  const current = audio.currentSong ? audio.currentSong.audio : null;\n  const parent = audio.parent ? audio.parent.id : null;\n\n  let currentClass = '';\n\n  if (current && title.selectedBounce) {\n    currentClass =\n      parent === tier.id && current === title.selectedBounce.id\n        ? 'current-song'\n        : '';\n  }\n\n  let open = expand ? 'open' : 'closed';\n\n  return (\n    <div className=\"title-margin\">\n      <div className={`row title ${currentClass} ${expand ? 'row-open' : ''}`}>\n        <div className=\"marqee\" onClick={() => setExpand(!expand)}>\n          <div className=\"title-name\">\n            <img className={`arrow ${arrow}`} src={`/images/right-arrow.svg`} />\n            <h3>{title.title}</h3>\n          </div>\n          {renderAudioEditLink()}\n          {renderPlayContainer()}\n          {renderButtons()}\n        </div>\n      </div>\n      <div className={`version-container ${open}`}>\n        {expand && renderVersion()}\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    versions: state.versions,\n    bounces: state.bounces,\n    band: state.bands.currentBand,\n    playlists: state.playlists,\n    titles: state.titles,\n    audio: state.audio,\n    tiers: state.tiers,\n  };\n};\n\nexport default connect(mapStateToProps, {\n  fetchVersions,\n  fetchBounces,\n  selectVersion,\n  selectBounce,\n  createPlaylistSong,\n  editTitle,\n  deleteTitle,\n})(requireAuth(Title));\n","import React, { useEffect, useState, useRef } from 'react';\nimport { connect } from 'react-redux';\nimport _ from 'lodash';\n\nimport { createTier, editTier, fetchTitles, createTitle, deleteTier, setOrder } from '../actions';\nimport Title from './Title';\nimport AddButton from './AddButton';\nimport DeleteButton from './DeleteButton';\nimport requireAuth from './requireAuth';\n\n\nconst Tier = ({ tier, titles, fetchTitles, authorized, band, tiers, editTier, createTitle, deleteTier, setOrder }) => {\n\n    const [expand, setExpand] = useState(false);\n    const [titlesToRender, setTitlesToRender] = useState(null);\n    const [times, setTimes] = useState({});\n\n    const orderedTitles = useRef({});\n\n    useEffect(() => {\n        setOrder(tier.id, 'date');\n        fetchTitles(tier.id);\n    }, []);\n\n    useEffect(() => {\n        setTitlesToRender(tier.trackList\n            .map(id => titles[id]));\n    }, [titles, tier]);\n\n    const findLatest = (title, bounce) => {\n        if (!orderedTitles.current[title.id]) {\n            orderedTitles.current[title.id] = new Date(bounce.date);\n        }\n    };\n\n\n    const renderTitles = () => {\n\n        const titleList = [...titlesToRender];\n\n        if (!tier.orderBy || tier.orderBy === 'date') {\n\n            titleList.sort((a, b) => {\n                if (orderedTitles.current[a.id] && orderedTitles.current[b.id]) {\n                    if (orderedTitles.current[a.id] > orderedTitles.current[b.id]) {\n                        return -1;\n                    } else {\n                        return 1;\n                    }\n                } else if (orderedTitles.current[a.id]) {\n                    return -1;\n                } else if (orderedTitles.current[b.id]) {\n                    return 1;\n                }\n            });\n        }\n\n        if (tier.orderBy === 'name') {\n\n            titleList.sort((a, b) => {\n                return a.title < b.title ? -1 : 1;\n            });\n\n        }\n\n        return titleList.map(title => {\n            if (title) {\n                return (\n                    <Title title={title} tier={tier} key={title.id} getTime={getTime} findLatest={findLatest}/>\n                );\n            }\n        });\n    };\n\n\n    const renderAddButton = () => {\n        if (authorized) {\n            return (\n                <div className=\"order-by\">\n                    <div>\n                        Add a Title to this Tier\n                    </div>\n                    <AddButton\n                        title={`Add a Title to ${tier.name}`}\n                        image=\"images/add.png\"\n                        fields={[\n                            {\n                                label: 'Title',\n                                name: 'title',\n                                type: 'input',\n                                required: true\n                            }\n                        ]}\n                        onSubmit={(formValues) => {\n                            createTitle(formValues, tier.id);\n                            setExpand(true);\n                        }}\n                        form={`add-title-${tier.id}`}\n                        addClass='add-left'\n                    />\n                </div>\n            );\n        }\n    };\n\n    const renderEditButton = () => {\n        if (authorized) {\n\n            const tierList = band.tiers\n                .map(id => tiers[id])\n                .sort((a, b) => a.position < b.position ? -1 : 1)\n                .map(t => {\n                    if (t) {\n                        return { value: t.position, display: t.position };\n                    }\n                });\n\n\n            return (\n                <AddButton\n                    title={`Edit ${tier.name}`}\n                    image=\"images/edit.png\"\n                    fields={[\n                        {\n                            label: 'Tier Name',\n                            name: 'name',\n                            type: 'input',\n                            required: true        \n                        }, {\n                            label: 'Tier Position',\n                            name: 'position',\n                            type: 'select',\n                            options: tierList,\n                        }\n                    ]}\n                    onSubmit={(formValues) => editTier(formValues, tier.id)}\n                    initialValues={{ name: tier.name, position: tier.position }}\n                    form={`edit-tier-${tier.id}`}\n                    enableReinitialize={true}\n                />\n            );\n        }\n    };\n\n    const renderDeleteButton = () => {\n        if (authorized) {\n            return (\n                <DeleteButton\n                    onSubmit={() => deleteTier(tier.id)}\n                    displayName={tier.name}\n                />\n            );\n        }\n    };\n\n    const renderTotalTime = () => {\n\n\n        const total = Object.values(times).reduce((prev, cur) => {\n            return prev + cur;\n        }, 0);\n\n        if (!total) {\n            return null;\n        }\n\n        const minutes = Math.floor(total / 60);\n        const seconds = Math.floor(total % 60) < 10 ? '0' + Math.floor(total % 60) : Math.floor(total % 60);\n        return (\n            <div>\n                {`${minutes}:${seconds}`}\n            </div>\n        );\n    };\n\n    const getTime = (track) => {\n        if (times[track.id] !== track.duration) {\n            setTimes({ ...times, [track.id]: track.duration });\n        }\n    };\n\n    const renderOrderButton = () => {\n        if (!tier.orderBy || tier.orderBy === 'date') {\n            return (\n                <div className='order-by'>\n                    <div>Order titles by: </div>\n                    <div\n                        className='order-button order-active'\n                        onClick={e => e.stopPropagation()}\n                    >\n                        Date\n                    </div>\n                    <div\n                        className='order-button'\n                        onClick={e => {\n                            e.stopPropagation();\n                            setOrder(tier.id, 'name');\n                        }}\n                    >\n                        ABC\n                    </div>\n                </div>\n            );\n        }\n        \n        if (tier.orderBy === 'name') {\n            return (\n                <div className='order-by'>\n                    <div>Order titles by:</div>\n                    <div\n                        className='order-button'\n                        onClick={e => {\n                            e.stopPropagation();\n                            setOrder(tier.id, 'date');\n                        }}\n                    >\n                        Date\n                    </div>\n                    <div\n                        className='order-button order-active'\n                        onClick={e => e.stopPropagation()}\n                    >\n                        ABC\n                    </div>\n                </div>\n            );\n        }\n    };\n\n    const renderOptions = () => {\n\n        return <>\n            {renderAddButton()}\n            {renderOrderButton()}     \n        </>;\n    };\n\n    const arrow = expand ? 'down-arrow' : '';\n    const open = expand ? 'open' : 'closed';\n\n    return (\n        <>\n            <div className={`row tier ${expand ? 'row-open' : ''}`} onClick={() => setExpand(!expand)}>\n                <div className=\"marqee\">\n                    <div className=\"tier-name\">\n                        <img className={`arrow ${arrow}`} src={`images/right-arrow.svg`} />\n                        <h2>{tier.name}</h2>\n                        \n                    </div>\n                    <div className=\"tier-count\">\n                        <div className=\"song-count\">{tier.trackList.length} songs</div>\n                        <div className=\"song-count\">{renderTotalTime()}</div>\n                    </div>\n                    <div className=\"tier-display\">\n                        {renderEditButton()}\n                        {renderDeleteButton()}\n                    </div>\n                </div>   \n            </div>\n            <div className={`tier-options ${expand ? 'options-visible' : ''}`}>\n                {expand && renderOptions()}\n            </div>\n            <hr />\n            <div className={`title-container ${open}`}>\n                {expand && titlesToRender && renderTitles()}\n            </div>\n        </>\n    );\n};\n\nconst mapStateToProps = state => {\n    return {\n        titles: state.titles,\n        band: state.bands.currentBand,\n        tiers: state.tiers\n    }\n};\n\n\nexport default connect(mapStateToProps, { createTier, fetchTitles, editTier, createTitle, deleteTier, setOrder })(requireAuth(Tier));","import React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport moment from 'moment';\nimport _ from 'lodash';\n\nimport AddButton from './AddButton';\nimport DeleteButton from './DeleteButton';\nimport { editPlaylistSong, fetchVersions, fetchBounces, deletePlaylistSong } from '../actions';\nimport PlayContainer from './PlayContainer';\nimport requireAuth from './requireAuth';\n\nconst PlaylistSong = ({ playlist, playlists, song, playlistSongs, authorized, versions, bounces, titles, fetchBounces, fetchVersions, editPlaylistSong, deletePlaylistSong, audio, getTime, band, doUpdate }) => {\n\n    const [playSong, setPlaySong] = useState(null);\n\n    useEffect(() => {\n        fetchVersions(song.title);\n        titles[song.title].versions.forEach(id => {\n            fetchBounces(id);\n        });\n    }, []);\n    \n    useEffect(() => {\n        if (titles[song.title]) {\n            setPlaySong({\n                    playlist,\n                    title: titles[song.title],\n                    version: versions[song.version],\n                    bounce: bounces[song.bounce],\n                    position: song.position\n                });\n            }\n            if (bounces[song.bounce]) {\n                getTime({ id: song.id, duration: bounces[song.bounce].duration });\n            }   \n    }, [playlistSongs[song.id], bounces[song.bounce], titles[song.title], versions[song.version]]);\n\n    useEffect(() => {\n        // console.log(doUpdate);\n        if (doUpdate) {\n            updateToCurrent();\n        }\n    }, [doUpdate]);\n\n    const renderPlayContainer = () => {\n\n        if (playSong && playSong.bounce && playSong.version) {\n            return <PlayContainer song={playSong} parentType=\"playlist\" />;\n        } else {\n            return (\n                <div className=\"playlistsong-no-bounce\">\n                    <p>\n                        {versions[song.version] ? `${versions[song.version].name}` : 'No Version Selected'}\n                    </p>\n                    <p>\n                        No Bounce Selected\n                    </p>\n                </div>\n            );\n        }\n    };\n\n    const onEditSubmit = formValues => {\n        const thisVersion = Object.values(versions).find(v => v.bounces.includes(formValues.bounce));\n        editPlaylistSong({\n            ...formValues,\n            version: thisVersion.id,\n            playlistId: playlist.id\n        }, song.id);\n    };\n\n    const updateToCurrent = () => {\n\n        const thisTitle = titles[song.title];\n        const titleVersions = thisTitle.versions.map(id => versions[id]);\n        const currentVersion = titleVersions.find(v => v && v.current);\n        if (currentVersion) {\n            const versionBounces = currentVersion.bounces.map(id => bounces[id]);\n            const currentBounce = versionBounces.find(b => b && b.latest);\n            if (currentBounce) {\n                editPlaylistSong({\n                    bounce: currentBounce.id,\n                    version: currentVersion.id,\n                    position: song.position,\n                    playlistId: playlist.id\n                }, song.id);\n            }\n        }\n\n    };\n\n    const renderEditButton = () => {\n        if (authorized && titles[song.title]) {\n\n            const otherSongs = Object.values(playlistSongs)\n                .filter(s => playlist.songs.includes(s.id))\n                .sort((a,b) => a.position < b.position ? -1 : 1)\n                .map(s => {\n                    return { value: s.position, display: s.position };\n            });\n\n            const thisTitle = titles[song.title];\n\n            const otherVersions = thisTitle.versions.map(id => versions[id]);\n\n            const otherBounces = otherVersions.map(v => {\n                if (v) {\n                    return v.bounces.map(id => bounces[id]);\n                }\n            });\n\n\n            const editOptions = [];\n            \n            otherVersions.forEach((v, i) => {\n                if (otherBounces[i]) {\n                    otherBounces[i].forEach(b => {\n                        if (b) {\n                            let current = '';\n                            if (v.current && b.latest) {\n                                current =' * current';\n                            }\n                            editOptions.push({\n                                value: b.id,\n                                display: `${v.name} -- ${moment.utc(b.date).format('MM/DD/YY')}${current}`\n                            });\n                        }\n                    });\n                }\n            });\n\n\n            const bandPlaylists = band.playlists\n                .filter(id => id !== playlist.id)\n                .map(id => playlists[id]);\n                \n            const playlistOptions = bandPlaylists.map(pl => {\n                if (pl) {\n                    return { value: pl.id, display: pl.name };\n                }\n            });\n\n            playlistOptions.unshift({ value: null, display: ''})\n\n            return (\n                <AddButton\n                    image='/images/edit.png'\n                    title={`Edit ${titles[song.title].title}`}\n                    onSubmit={formValues => onEditSubmit(formValues)}\n                    fields={[\n                        {\n                            name: 'position',\n                            label: 'Position',\n                            type: 'select',\n                            options: otherSongs\n                        },\n                        {\n                            name: 'bounce',\n                            label: 'Bounce',\n                            type: 'select',\n                            options: editOptions,\n                            required: true\n                        },\n                        {\n                            label: 'Add to Playlist',\n                            name: 'move',\n                            type: 'select',\n                            options: playlistOptions\n                        }\n                    ]}\n                    initialValues={song.bounce ? { ..._.pick(song, 'position', 'bounce'), move: null } : { position: song.position, move: null }}\n                    form={`edit-playlistsong-${song.id}`}\n                    enableReinitialize={true}\n                    addClass='add-right'\n                />\n            );\n        }\n    };\n\n    const renderDeleteButton = () => {\n        if (authorized) {\n            return (\n                <DeleteButton\n                    onSubmit={() => deletePlaylistSong(song.id, playlist.id)}\n                    displayName={titles[song.title].title}\n                />\n            );\n        }\n    };\n\n    const current = audio.currentSong ? audio.currentSong.audio : null;\n    const parent = audio.parent ? audio.parent.id : null;\n\n    let currentClass = '';\n\n    if (current && song.bounce) {\n        currentClass = parent === playlist.id && current === song.bounce ? 'current-song' : '';\n    }\n\n\n    return (\n        <div className='title-margin'>\n            <div className={`row title playlistsong ${currentClass}`}>                    \n                <div className=\"marqee\">\n                    <div className='title-name'>\n                        <div className=\"song-position\">\n                            <p>{song.position}</p>\n                        </div>\n                        <h3>{song && titles[song.title] && titles[song.title].title}</h3>\n                    </div>      \n\n                    {renderPlayContainer()}\n                    <div className=\"tier-display\">\n                        {renderEditButton()}\n                        {renderDeleteButton()}\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n\n};\n\n\n\nconst mapStateToProps = state => {\n\n    return {\n        playlistSongs: state.playlistSongs,\n        band: state.bands.currentBand,\n        playlists: state.playlists,\n        versions: state.versions,\n        bounces: state.bounces,\n        titles: state.titles,\n        audio: state.audio\n    }\n\n}\n\nexport default connect(mapStateToProps, { fetchBounces, fetchVersions, editPlaylistSong, deletePlaylistSong })(requireAuth(PlaylistSong));","import React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport _ from 'lodash';\n\nimport { fetchPlaylistSongs, deletePlaylist, editPlaylist } from '../actions';\nimport PlaylistSong from './PlaylistSong';\nimport AddButton from './AddButton';\nimport DeleteButton from './DeleteButton';\nimport requireAuth from './requireAuth';\n\nconst Playlist = ({ playlist, playlists, fetchPlaylistSongs, playlistSongs, authorized, editPlaylist, deletePlaylist, band }) => {\n\n    const [expand, setExpand] = useState(false);\n    const [playlistList, setPlaylistList] = useState([]);\n    const [times, setTimes] = useState({});\n    const [songsToRender, setSongsToRender] = useState(null);\n    const [doUpdate, setDoUpdate] = useState(false);\n\n\n    useEffect(() => {\n        fetchPlaylistSongs(playlist.id);\n    }, []);\n\n    useEffect(() => {\n        setSongsToRender(playlist.songs.map(id => playlistSongs[id]));\n    }, [playlistSongs, playlist.songs]);\n\n    const renderPlaylistSongs = () => {\n\n        songsToRender.sort((a, b) => a.position < b.position ? -1 : 1);\n\n        return songsToRender.map(song => {\n            if (song) {\n                return (\n                <PlaylistSong song={song} playlist={playlist} key={song.id} getTime={getTime} doUpdate={doUpdate} />\n                );\n            }\n        });\n    };\n\n    useEffect(() => {\n        if (band.playlists.length) {\n            const playlistsToShow = band.playlists.map(id => playlists[id]).sort((a, b) => {\n                if (a.position < b.position) {\n                    return -1;\n                }\n                if (b.position < a.position) {\n                    return 1;\n                }\n            });\n            setPlaylistList(playlistsToShow.map(t => {\n                if (t) {\n                    return { value: t.position, display: t.position };\n                }\n            }));\n        }\n    }, [playlists]);\n\n    useEffect(() => {\n        if (doUpdate) {\n            setDoUpdate(false);\n        }\n    }, [doUpdate]);\n\n    const renderEditButton = () => {\n        if (authorized) {\n\n\n            return (\n                <AddButton\n                    title={`Edit ${playlist.name}`}\n                    image=\"images/edit.png\"\n                    fields={[\n                        {\n                            label: 'Playlist Name',\n                            name: 'name',\n                            type: 'input',          \n                        }, {\n                            label: 'Playlist Position',\n                            name: 'position',\n                            type: 'select',\n                            options: playlistList,\n                        }\n                    ]}\n                    onSubmit={(formValues) => editPlaylist(formValues, playlist.id)}\n                    initialValues={_.pick(playlist, 'name', 'position')}\n                    form={`edit-${playlist.id}`}\n                    enableReinitialize={true}\n                    addClass='add-tier'\n                />\n            );\n        }\n    };\n\n    const renderDeleteButton = () => {\n        if (authorized) {\n            return (\n                <DeleteButton\n                    onSubmit={() => deletePlaylist(playlist.id)}\n                    displayName={playlist.name}\n                />\n            );\n        }\n    };\n\n    const renderTotalTime = () => {\n\n\n        const total = Object.values(times).reduce((prev, cur) => {\n            return prev + cur;\n        }, 0);\n\n        if (!total) {\n            return null;\n        }\n\n        const minutes = Math.floor(total / 60);\n        const seconds = Math.floor(total % 60) < 10 ? '0' + Math.floor(total % 60) : Math.floor(total % 60);\n        return (\n            <div>\n                {`${minutes}:${seconds}`}\n            </div>\n        );\n    };\n\n    const getTime = (track) => {\n        if (times[track.id] !== track.duration) {\n            setTimes({ ...times, [track.id]: track.duration });\n        }\n    };\n\n    const showUpdatePlaylistCheckbox = () => {\n        if (authorized && expand) {\n            return (\n                <div className=\"playlist-update\">\n                    <div>\n                        Set all to current\n                    </div>\n                    <div\n                        className=\"playlist-update-btn\"\n                        onClick={e => {\n                            e.stopPropagation();\n                            setDoUpdate(true);\n                        }}\n                    />\n                </div>\n            );\n        }\n    };\n\n\n    const arrow = expand ? 'down-arrow' : '';\n    const open = expand ? 'open' : 'closed';\n\n    return (\n        <>\n            <div className={`row tier ${expand ? 'row-open' : ''}`} onClick={() => setExpand(!expand)} >\n                <div className=\"marqee tier-info\">\n                    <div className=\"tier-name\"  >\n                        <img className={`arrow ${arrow}`} src={`/images/right-arrow.svg`}/>\n                        <h2>{playlist.name}</h2>\n\n                        {showUpdatePlaylistCheckbox()}\n\n                    </div>\n\n                    <div className=\"tier-count\">\n                        <div className=\"song-count\">{playlist.songs.length} songs</div>\n                        <div className=\"song-count\">{renderTotalTime()}</div>\n                    </div>\n                    <div className=\"tier-display\">\n                            {renderEditButton()}\n                            {renderDeleteButton()}\n                    </div>\n                </div>   \n            </div>\n            <hr />\n            <div className={`title-container ${open}`}>\n                {expand && renderPlaylistSongs()}\n            </div>\n        </>\n    );\n};\n\nconst mapStateToProps = state => {\n    return {\n        playlists: state.playlists,\n        playlistSongs: state.playlistSongs,\n        band: state.bands.currentBand\n    }\n}\n\nexport default connect(mapStateToProps, { fetchPlaylistSongs, deletePlaylist, editPlaylist })(requireAuth(Playlist));","import React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport _ from 'lodash';\n\nimport {\n  fetchTiers,\n  fetchPlaylists,\n  createTier,\n  createPlaylist,\n} from '../actions';\nimport Tier from './Tier';\nimport Playlist from './Playlist';\nimport AddButton from './AddButton';\nimport requireAuth from './requireAuth';\n\nconst BodyContainer = ({\n  fetchPlaylists,\n  createTier,\n  fetchTiers,\n  tiers,\n  playlists,\n  band,\n  authorized,\n  createPlaylist,\n  currentSong,\n  handleUpdate,\n  user,\n}) => {\n  const [tierList, setTierList] = useState([]);\n  const [playlistList, setPlaylistList] = useState([]);\n\n  useEffect(() => {\n    fetchTiers(band.id);\n    fetchPlaylists(band.id);\n  }, [band]);\n\n  useEffect(() => {\n    handleUpdate();\n  }, [user]);\n\n  useEffect(() => {\n    setTierList(\n      band.tiers\n        .map((id) => tiers[id])\n        .sort((a, b) => {\n          if (a.position < b.position) {\n            return -1;\n          }\n          if (b.position < a.position) {\n            return 1;\n          }\n        })\n    );\n  }, [tiers]);\n\n  useEffect(() => {\n    setPlaylistList(\n      band.playlists\n        .map((id) => playlists[id])\n        .sort((a, b) => {\n          if (a.position < b.position) {\n            return -1;\n          }\n          if (b.position < a.position) {\n            return 1;\n          }\n        })\n    );\n  }, [playlists]);\n\n  const renderTiers = () => {\n    return tierList.map((tier) => {\n      if (tier) {\n        return <Tier tier={tier} key={tier.id} />;\n      }\n    });\n  };\n\n  const renderTierAddButton = () => {\n    if (authorized) {\n      return (\n        <AddButton\n          onSubmit={(formValues) => createTier(formValues)}\n          title=\"Add a Tier\"\n          image=\"/images/add.png\"\n          fields={[\n            {\n              label: 'Tier Name',\n              name: 'tierName',\n              type: 'input',\n              required: true,\n            },\n          ]}\n          addClass=\"add-left\"\n        />\n      );\n    }\n  };\n\n  const renderPlaylistAddButton = () => {\n    if (authorized) {\n      return (\n        <AddButton\n          onSubmit={(formValues) => createPlaylist(formValues)}\n          title=\"Add a Playlist\"\n          image=\"/images/add.png\"\n          fields={[\n            {\n              label: 'Playlist Name',\n              name: 'playlistName',\n              type: 'input',\n              required: true,\n            },\n          ]}\n          addClass=\"add-left\"\n        />\n      );\n    }\n  };\n\n  const renderPlaylists = () => {\n    return playlistList.map((playlist) => {\n      if (playlist) {\n        return <Playlist playlist={playlist} key={playlist.id} />;\n      }\n    });\n  };\n\n  const playbarActive = currentSong ? 'playbar-active' : '';\n\n  return (\n    <div className={`main ${playbarActive}`}>\n      <div className=\"section-header\">\n        <h2 className=\"section-title\">Tiers</h2>\n        <div className=\"section-add\">{renderTierAddButton()}</div>\n      </div>\n      <hr />\n      {tiers && renderTiers()}\n      <div className=\"playlists\">\n        <div className=\"section-header\">\n          <h2 className=\"section-title\">Playlists</h2>\n          <div className=\"section-add\">{renderPlaylistAddButton()}</div>\n        </div>\n        <hr />\n        {playlists && renderPlaylists()}\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    tiers: state.tiers,\n    playlists: state.playlists,\n    currentSong: state.audio.currentSong,\n    user: state.auth.user,\n    band: state.bands.currentBand,\n  };\n};\n\nexport default connect(mapStateToProps, {\n  fetchTiers,\n  fetchPlaylists,\n  createTier,\n  createPlaylist,\n})(requireAuth(BodyContainer));\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport moment from 'moment';\n\nimport { playAudio, pauseAudio, nextSong, prevSong, throwError, initializeAudio } from '../actions';\n\n\nclass AudioDisplay extends React.Component {\n\n    constructor(props) {\n        super(props);\n        if (process.env.NODE_ENV === 'production') {\n            this.url = 'https://exploring-the-space.com'\n        } else {\n            this.url = 'http://localhost:3001';\n        }\n        this.audio = React.createRef();\n    }\n\n\n    state = { volume: 50, sliderPosition: 0 };\n\n    formatTime(time) {\n\n        let minutes = time < 600 ? `0${Math.floor(time/60)}` : Math.floor(time/60);\n        let seconds = time % 60 < 10 ? `0${Math.floor(time % 60)}` : Math.floor(time % 60);\n        return `${minutes}:${seconds}`;\n    }\n\n    displayDate = date => {\n        return moment.utc(date).format('MM/DD/yy');\n    }\n\n    wrapUrl(id) {\n        return `${this.url}/api/audio/${id}.mp3`\n    }\n\n    updateSlider = () => {\n        const position = (this.audio.current.currentTime / this.audio.current.duration) * 1000;\n        this.time = this.formatTime(this.audio.current.currentTime);\n        if (!isNaN(position)) {\n            this.setState({\n                sliderPosition: position\n            });\n        }\n    }\n\n    setSpaceBarToPlay = (e) => {\n        if (e.code === 'Space') {\n            e.preventDefault();\n            if (this.props.pause) {\n                this.play();\n            } else {\n                this.pause();\n            }\n        }\n    }\n\n    audioError = () => {\n        const message = \"The audio player had an error, probably can't connect to server.\"\n        this.props.throwError(message);\n    }\n\n    componentDidMount() {\n\n        // if there's no audio element created, create one with the current song\n        // add event listener to link the slider position to the time of the song\n\n        \n        this.audio.current = new Audio();\n\n        this.audio.current.addEventListener('timeupdate', this.updateSlider);\n\n        this.audio.current.addEventListener('error', this.audioError);\n\n        // load next song at song end\n\n        this.audio.current.addEventListener('ended', this.nextSong);\n\n        // space bar stop/start\n\n        document.addEventListener('keydown', this.setSpaceBarToPlay);\n\n\n        this.audio.current.addEventListener('loadedmetadata', this.playOnLoad);\n        \n    }\n\n    componentDidUpdate(prevProps) {\n\n        // scroll down to compensate for the playbar pushing content down\n\n        if (!this.scrolled) {\n            window.scroll(window.scrollX, window.scrollY + 96);\n            this.scrolled = true;\n        }\n        \n        if (this.props.song) {\n            // if the current song is changed to something other than what is already loaded, change the src url and play the audio\n            // if redux gets a signal to play, play if not already\n            // reverse for pause\n            if (this.props.song !== prevProps.song) {\n                this.audio.current.src=this.wrapUrl(this.props.song.audio);\n                this.audio.current.volume = this.props.volume / 100;\n                // this.audio.current.play();\n            } else if (this.props.play && prevProps.pause) {\n\n                this.audio.current.play();\n            } else if (this.props.pause && prevProps.play) {\n                this.audio.current.pause();\n            }\n            if (this.props.volume !== prevProps.volume) {\n                this.audio.current.volume = this.props.volume / 100;\n            }\n        } else {\n            this.audio.current.pause();\n        }\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('keydown', this.setSpaceBarToPlay);\n\n        this.audio.current.src='';\n        this.audio.current.removeEventListener('timeupdate', this.updateSlider);\n        this.audio.current.removeEventListener('error', this.audioError);\n        this.audio.current.removeEventListener('ended', this.nextSong);\n        this.audio.current.removeEventListener('loadedmetadata', this.playOnLoad);\n\n        this.props.initializeAudio();\n    }\n\n    playOnLoad = () => {\n        if (this.props.play) {\n            this.audio.current.play();\n        }\n    }\n\n    prevSong = () => {\n        if (this.audio.current.currentTime < 1) {\n            this.props.prevSong();\n        } else {\n            this.audio.current.currentTime = 0;\n        }\n    }\n\n    nextSong = () => {\n        this.props.nextSong();\n    }\n\n    play = () => {\n        this.props.playAudio();\n    }\n\n    pause = () => {\n        this.props.pauseAudio();\n    }\n\n    onSliderChange = (e) => {\n        const position = (e.target.value / 1000) * this.audio.current.duration;\n        this.audio.current.currentTime = position;\n    }\n\n    onPauseButton = () => {\n\n        if (this.props.play) {\n            this.pause();\n        } else {\n            this.play();\n        }\n\n    }\n\n    render() {\n\n        if (this.props.song) {\n\n            return (\n                <div className=\"playbar\">\n                    <div className=\"playbar-header\">\n                            <div className=\"playbar-title\">\n                                <p>{this.props.song.title.title}</p>\n                            </div>\n                            <div className=\"big-play-container\">\n                                <img\n                                    src=\"/images/prev.svg\"\n                                    className=\"audio-controls\"\n                                    onClick={this.prevSong}\n                                />\n                                <img\n                                    className=\"big-play-btn\"\n                                    src={this.props.play ? \"/images/pause.svg\" : \"/images/play.svg\"}\n                                    onClick={this.onPauseButton}\n                                />\n                                <img\n                                    src=\"/images/next.svg\"\n                                    className=\"audio-controls\"\n                                    onClick={this.nextSong}\n                                />\n                            </div>\n                    \n                        <div className=\"playbar-info\">\n                            <div className=\"playbar-info-detail\">\n                                <p>Version:</p>\n                                <p>{this.props.song.version}</p>\n                            </div>\n                            <div className=\"playbar-info-detail\">\n                                <p>Date:</p>\n                                <p>{this.displayDate(this.props.song.date)}</p>\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"playslider-container\">\n                        <div className=\"playslider-time\">\n                            {this.time}\n                        </div>\n                        <input\n                            type=\"range\"\n                            min=\"0\"\n                            max=\"1000\"\n                            value={this.state.sliderPosition}\n                            className='playslider'\n                            onInput={this.onSliderChange}\n                        />\n                        <div className=\"playslider-time\">\n                            {this.formatTime(this.props.song.duration)}\n                        </div>\n                    </div>\n                </div>\n            );\n        } else {\n            return null;\n        }\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n        song: state.audio.currentSong,\n        play: state.audio.play,\n        pause: state.audio.pause,\n        volume: state.audio.volume\n    };\n};\n\nexport default connect(mapStateToProps, { playAudio, pauseAudio, nextSong, prevSong, throwError, initializeAudio })(AudioDisplay);","import React, { useEffect, useState, useRef } from 'react';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\n\nimport { fetchBand, signOut, changeVolume } from '../actions';\nimport Main from './Main';\nimport AudioDisplay from './AudioDisplay';\nimport requireAuth from './requireAuth';\n\nconst Header = ({ fetchBand, band, match, authorized, handleUpdate, user, signOut, volume, changeVolume }) => {\n\n    const [expand, setExpand] = useState(false);\n    const menu = useRef(null);\n\n    useEffect(() => {\n        fetchBand(match.params.bandName);\n        document.addEventListener('click', clickToDismiss, { capture: true });\n        return () => {\n            document.removeEventListener('click', clickToDismiss, { capture: true });\n        };\n    }, []);\n\n    useEffect(() => {\n        handleUpdate();\n    }, [band, user]);\n\n    const clickToDismiss = (e) => {\n        if (menu.current && menu.current.contains(e.target)) {\n            return;\n        }\n        setExpand(false);\n    };\n\n    const renderAdmin = () => {\n        return (\n            <div className=\"menu\">\n                <Link className=\"menu-item\" to=\"/user\">User Home</Link>\n                <Link className=\"menu-item\" to=\"/help\">Help</Link>\n                <div className=\"menu-item\" onClick={signOut}>Sign Out</div>\n            </div>\n        );\n    };\n\n    const renderHomeLink = () => {\n        return (\n            <div className=\"menu\">\n                <Link className=\"menu-item\" to=\"/\">Home</Link>\n                <Link className=\"menu-item\" to=\"/help\">Help</Link>\n                <Link className=\"menu-item\" to=\"/signin\">Sign In</Link>\n            </div>\n        );\n    };\n\n    const showContent = () => {\n\n        if (!band) {\n            return (\n                <div className=\"no-band\">\n                    <h1>This band does not exist on Exploring the Space, but you can create it.</h1>\n                    <div className=\"home-buttons\">\n                        <Link to=\"/\">\n                            Home\n                        </Link>\n                        <Link to=\"/help\">\n                            What Is It?\n                        </Link>\n                    </div>\n                </div>\n            );\n        }\n\n        return (\n            <div className=\"band-header\">\n                <div className=\"band-name\">\n                    <h1>{band && band.name}</h1>\n                    <div className=\"menu-button\" ref={menu} onClick={() => setExpand(!expand)}>\n                        <img src=\"images/dots.png\" />\n                        {expand && (authorized ? renderAdmin() : renderHomeLink())}\n                    </div>\n                </div>\n                <div className=\"volume-container\">\n                    <input\n                        type=\"range\"\n                        min=\"0\" max=\"100\"\n                        className=\"volume\"\n                        value={volume}\n                        onInput={e => changeVolume(e.target.value)}\n                    />\n                    <img src=\"/images/volume.svg\" />\n                </div>\n            </div>\n        );\n    };\n\n\n\n    return <>\n        \n        <div className=\"header\">\n            <AudioDisplay />\n            {showContent()}\n        </div>\n\n        {band && <Main />}\n\n    </>;\n\n};\n\nconst mapStateToProps = state => {\n    return {\n        band: state.bands.currentBand,\n        user: state.auth.currentUser,\n        volume: state.audio.volume\n    }\n}\n\nexport default connect(mapStateToProps, { fetchBand, signOut, changeVolume })(requireAuth(Header));","import React, { useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\n\nimport { createBand, fetchBands, editBand, deleteBand, signOut } from '../actions';\nimport AddButton from './AddButton';\nimport DeleteButton from './DeleteButton';\n\nconst User = ({ user, bands, createBand, fetchBands, editBand, deleteBand, signOut }) => {\n\n    useEffect(() => {\n        fetchBands();\n    }, []);\n\n    const renderBands = () => {\n        const bandList = user.bands.map(id => bands[id]);\n        if (!bandList.length || !bandList[0]) {\n            return <h3>No bands belong to this user</h3>\n        }\n        return bandList.map(band => {\n            if (band) {\n                return (\n                    <div className=\"band-item\" key={band.id}>\n                        <Link to={`/${band.url}`}>\n                            <h2>{band.name}</h2>\n                        </Link>\n                        <div className=\"band-buttons\">\n                            <AddButton\n                                onSubmit={formValues => editBand(formValues, band.id)}\n                                title={`Edit ${band.name}`}\n                                image=\"images/edit.png\"\n                                fields={[{\n                                    label: 'Band Name',\n                                    name: 'name',\n                                    type: 'input'\n                                }]}\n                                initialValues={{ name: band.name }}\n                                enableReinitialize={true}\n                                form={`edit-band-${band.id}`}\n                            />\n                            <DeleteButton\n                                onSubmit={() => deleteBand(band.id)}\n                                displayName={band.name}\n                            />\n                        </div>\n                    </div>                   \n                );\n            }\n        });\n    };\n\n    if (user) {\n        return <>\n            <div className=\"user-header\">\n                <div className=\"user-header-sub\">\n                    <h1 className=\"user-title\">\n                        {user.username}'s bands\n                    </h1>\n                    <AddButton\n                        onSubmit={formValues => createBand(formValues)}\n                        title='Create a Band'\n                        image=\"images/add.png\"\n                        fields={[{\n                            label: 'Band Name',\n                            name: 'bandName',\n                            type: 'input'\n                        }]}\n                    />\n                </div>\n                <div className=\"user-header-sub\">\n                    <Link className=\"user-link\" to=\"/\">\n                        Home\n                        </Link>\n                    <div className=\"user-link\" onClick={signOut}>\n                        Sign Out\n                    </div>\n                </div>\n            </div>\n            <hr />\n            <div className=\"band-list\">\n                {renderBands()}\n            </div>\n            \n\n        </>;\n    } else {\n        return null;\n    }\n\n};\n\nconst mapStateToProps = state => {\n    return {\n        user: state.auth.user,\n        bands: state.bands\n    };\n};\n\nexport default connect(mapStateToProps, { createBand, fetchBands, editBand, deleteBand, signOut })(User);","import React from 'react';\nimport { Field, reduxForm } from 'redux-form';\n\nclass UserForm extends React.Component {\n    \n    renderInput = ({ input, label, meta, type, autoComplete, defaultValue }) => {\n\n        return (\n            <div>\n                <label>{label}</label>\n                <input\n                    type={type}\n                    autoComplete={autoComplete} \n                    {...input}\n                /> \n            </div>\n        );\n    };\n\n    submitForm = formValues => {\n        this.props.onSubmit(formValues);\n    };\n\n\n    render() {\n        return (\n            <form className='signin' onSubmit={this.props.handleSubmit(this.submitForm)}>\n                <Field\n                    name=\"username\"\n                    component={this.renderInput}\n                    label=\"Username: \"\n                    type=\"text\"\n                    autoComplete=\"username\"\n    \n                />\n                <Field\n                    name=\"password\"\n                    component={this.renderInput}\n                    label=\"Passwyrd: \"\n                    type=\"password\"\n                    autoComplete=\"current-password\"\n                />\n                <button className=\"signin-submit\">Submit</button>\n            </form>\n        );\n    }\n\n\n}\n\nexport default reduxForm({\n    form: 'userForm'\n})(UserForm);","import { connect } from 'react-redux';\nimport React, { useEffect } from 'react';\nimport { Link } from 'react-router-dom';\n\nimport history from '../history';\nimport { signIn } from '../actions';\nimport UserForm from './UserForm';\n\n\nconst SignIn = ({ signIn, isSignedIn }) => {\n\n    useEffect(() => {\n        if (isSignedIn) {\n            history.push('/user')\n        }\n    }, []);\n\n    return (\n\n        <div className=\"auth\">\n            <div className=\"help-header\">\n                Exploring the Space\n            </div>\n            <h1>Sign In</h1>\n            <UserForm onSubmit={formValues => signIn(formValues)}/>\n            <div className=\"home-buttons\">\n                <Link to=\"/\">\n                    Home\n                </Link>\n                <Link to=\"signup\">\n                    Sign Up\n                </Link>\n            </div>\n        </div>\n    );\n};\n\nconst mapStateToProps = state => {\n    return { isSignedIn: state.auth.isSignedIn };\n}\n\nexport default connect(mapStateToProps, { signIn })(SignIn);","import { connect } from 'react-redux';\nimport React, { useEffect } from 'react';\nimport { Link } from 'react-router-dom';\n\nimport history from '../history';\nimport { signUp } from '../actions';\nimport UserForm from './UserForm';\n\n\nconst SignUp = ({ signUp, isSignedIn }) => {\n\n    useEffect(() => {\n        if (isSignedIn) {\n            history.push('/user')\n        }\n    }, []);\n\n    return (\n        <div className=\"auth\">\n            <div className=\"help-header\">\n                Exploring the Space\n            </div>\n            <h1>Sign Up</h1>\n            <UserForm onSubmit={formValues => signUp(formValues)}/>\n            <div className=\"home-buttons\">\n                <Link to=\"/\">\n                    Home\n                </Link>\n                <Link to=\"signin\">\n                    Sign In\n                </Link>\n            </div>\n        </div>\n    );\n};\n\nconst mapStateToProps = state => {\n    return { isSignedIn: state.auth.isSignedIn };\n}\n\nexport default connect(mapStateToProps, { signUp })(SignUp);","import React from 'react';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport _ from 'lodash';\n\nimport { fetchBands } from '../actions';\n\nclass Home extends React.Component {\n\n\n    componentDidMount() {\n        this.props.fetchBands();\n    }\n\n    renderBands() {\n\n        delete this.props.bands.currentBand;\n\n        const bands = Object.values(this.props.bands);\n\n        return bands.map(band => {\n            return (\n                <div className=\"band-item\" key={band.id}>\n                    <Link to={`/${band.url}`}>\n                        <h2>{band.name}</h2>\n                    </Link>\n                </div>\n            );\n        });\n\n    }\n\n\n    render() {\n        return (\n            <div className=\"container\">\n                <h1 className=\"home-header\">Exploring the Space</h1>\n                <div className=\"home-buttons\">\n                    <Link to=\"/signin\">\n                        Sign In\n                    </Link>\n                    <Link to=\"/signup\">\n                        Sign Up\n                    </Link>\n                    <Link to=\"/help\">\n                        What Is It?\n                    </Link>\n                </div>\n                <h1>All Bands:</h1>\n                <div className=\"band-list\">\n                    {this.props.bands && this.renderBands()}\n                </div>\n            </div>\n        );\n    }\n\n\n}\n\nconst mapStateToProps = state => {\n    return {\n        bands: state.bands\n    };\n};\n\nexport default connect(mapStateToProps, { fetchBands })(Home);","import React from 'react';\nimport { Link } from 'react-router-dom';\n\nconst Help = () => {\n    return <>\n        <div className=\"home-buttons\">\n            <Link to=\"/\">Home</Link>\n            <Link to=\"signin\">Sign In</Link>\n            <Link to=\"signin\">Sign Up</Link>\n        </div>\n        <div className=\"help\">\n            <div className=\"help-header\">\n                Exploring the Space allows you to keep track of your musical recordings in an easy to navigate catalogue.\n            </div>\n            <h1>\n                Here's How This Works\n            </h1>\n            <div className=\"tldr\">\n                TL;DR: Bands contain Tiers, which contain Titles (songs), which contain different versions, each of which can have one or more recordings. Bands also have Playlists which are collections of particular recordings.\n            </div>\n            <p>\n                Each user can have 1 or more bands.  Each band has their own page.\n            </p>\n\n            <h2>\n                The Band Page\n            </h2>\n            <p>\n                The band page has a \"Tiers\" sections and a \"Playlists\" section. The tiers are used to catalogue your songs, and the playlists are used to combine different songs into a certain order.\n            </p>\n            <h3>\n                Tiers\n            </h3>\n            <p>\n                A tier is a collection of songs. Tiers can be separated by different genres, songs that you're currently rehearsing versus songs that are still being written, or any other criteria.  Within the band page, these songs are called \"Titles.\" Click on a tier to reveal its titles.\n            </p>\n            <h3>\n                Titles\n            </h3>\n            <p>\n                Titles contain all the various versions and recordings of a particular song. On the title display, you will see the recording that is most up-to-date for this title, and a button to play it or download it. Click on the title to reveal the different versions it contains.\n            </p>\n            <h3>\n                Versions\n            </h3>\n            <p>\n                A version categorizes groups of recordings, and again you can use whatever criteria you want.  Maybe one version is band practice, and the other is a recording you're working on.  Each version contains one or more recordings, or \"Bounces.\" One and only one version for each title is the \"current\" version.\n            </p>\n            <h3>\n                Bounces\n            </h3>\n            <p>\n                Bounces are the root component of a song, and they represent a particular recording.  They are represented by a date. Like versions, one bounce per version is designated \"current.\"\n            </p>\n            <h3>\n                Playlists\n            </h3>\n            <p>\n                Playlists are where you can make ordered lists of particular bounces.  Each title has a display of its currently selected version and bounce, along with a button to add that recording to a playlist (you have to create the playlist first).\n            </p>\n            <p>\n                If you change the version or bounce you're listening to, the song in the playlist will remain the same one you originally added. If you want to change which version and/or bounce a song in a playlist represents, you can change that by editing it within the playlist.\n            </p>\n            <h2>\n                Controls\n            </h2>\n            <p>\n                If you are on a band page of a band you own, you will see additional buttons where you can modify the catalogue and upload new recordings.\n            </p>\n            <p className=\"danger\">\n                If you delete an element, everything contained within that element will be deleted!\n            </p>\n            <a href=\"https://github.com/andytisdall/greenhouse\">\n                Github for this project\n            </a>\n        </div>\n    </>;\n};\n\nexport default Help;","/* eslint-disable */\n\nfunction pad2(n) {\n  n |= 0;\n  return n < 10 ? `0${n}` : `${Math.min(n, 99)}`;\n}\n\nfunction inlineWorker() {\n  // TODO(Kagami): Cache compiled module in IndexedDB? It works in FF\n  // and Edge, see: https://github.com/mdn/webassembly-examples/issues/4\n  // Though gzipped WASM module currently weights ~70kb so it should be\n  // perfectly cached by the browser itself.\n  function fetchAndInstantiate(url, imports) {\n    if (!WebAssembly.instantiateStreaming)\n      return fetchAndInstantiateFallback(url, imports);\n    const req = fetch(url, { credentials: 'same-origin' });\n    return WebAssembly.instantiateStreaming(req, imports).catch((err) => {\n      // https://github.com/Kagami/vmsg/issues/11\n      if (\n        err.message &&\n        err.message.indexOf(\n          'Argument 0 must be provided and must be a Response'\n        ) > 0\n      ) {\n        return fetchAndInstantiateFallback(url, imports);\n      } else {\n        throw err;\n      }\n    });\n  }\n\n  function fetchAndInstantiateFallback(url, imports) {\n    return new Promise((resolve, reject) => {\n      const req = new XMLHttpRequest();\n      req.open('GET', url);\n      req.responseType = 'arraybuffer';\n      req.onload = () => {\n        resolve(WebAssembly.instantiate(req.response, imports));\n      };\n      req.onerror = reject;\n      req.send();\n    });\n  }\n\n  // Must be in sync with emcc settings!\n  const TOTAL_STACK = 5 * 1024 * 1024;\n  const TOTAL_MEMORY = 300 * 1024 * 1024;\n  const WASM_PAGE_SIZE = 64 * 1024;\n  let memory = null;\n  let dynamicTop = TOTAL_STACK;\n  // TODO(Kagami): Grow memory?\n  function sbrk(increment) {\n    const oldDynamicTop = dynamicTop;\n    dynamicTop += increment;\n    return oldDynamicTop;\n  }\n  // TODO(Kagami): LAME calls exit(-1) on internal error. Would be nice\n  // to provide custom DEBUGF/ERRORF for easier debugging. Currenty\n  // those functions do nothing.\n  function exit(status) {\n    postMessage({ type: 'internal-error', data: status });\n  }\n\n  let FFI = null;\n  let ref = null;\n  let pcm_l = null;\n  function vmsg_init(rate) {\n    ref = FFI.vmsg_init(rate);\n    if (!ref) return false;\n    const pcm_l_ref = new Uint32Array(memory.buffer, ref, 1)[0];\n    pcm_l = new Float32Array(memory.buffer, pcm_l_ref);\n    return true;\n  }\n  function vmsg_encode(data) {\n    pcm_l.set(data);\n    return FFI.vmsg_encode(ref, data.length) >= 0;\n  }\n  function vmsg_flush() {\n    if (FFI.vmsg_flush(ref) < 0) return null;\n    const mp3_ref = new Uint32Array(memory.buffer, ref + 4, 1)[0];\n    const size = new Uint32Array(memory.buffer, ref + 8, 1)[0];\n    const mp3 = new Uint8Array(memory.buffer, mp3_ref, size);\n    const blob = new Blob([mp3], { type: 'audio/mpeg' });\n    FFI.vmsg_free(ref);\n    ref = null;\n    pcm_l = null;\n    return blob;\n  }\n\n  // https://github.com/brion/min-wasm-fail\n  function testSafariWebAssemblyBug() {\n    const bin = new Uint8Array([\n      0, 97, 115, 109, 1, 0, 0, 0, 1, 6, 1, 96, 1, 127, 1, 127, 3, 2, 1, 0, 5,\n      3, 1, 0, 1, 7, 8, 1, 4, 116, 101, 115, 116, 0, 0, 10, 16, 1, 14, 0, 32, 0,\n      65, 1, 54, 2, 0, 32, 0, 40, 2, 0, 11,\n    ]);\n    const mod = new WebAssembly.Module(bin);\n    const inst = new WebAssembly.Instance(mod, {});\n    // test storing to and loading from a non-zero location via a parameter.\n    // Safari on iOS 11.2.5 returns 0 unexpectedly at non-zero locations\n    return inst.exports.test(4) !== 0;\n  }\n\n  onmessage = (e) => {\n    const msg = e.data;\n    switch (msg.type) {\n      case 'init':\n        const { wasmURL, shimURL } = msg.data;\n        Promise.resolve()\n          .then(() => {\n            if (self.WebAssembly && !testSafariWebAssemblyBug()) {\n              delete self.WebAssembly;\n            }\n            if (!self.WebAssembly) {\n              importScripts(shimURL);\n            }\n            memory = new WebAssembly.Memory({\n              initial: TOTAL_MEMORY / WASM_PAGE_SIZE,\n              maximum: TOTAL_MEMORY / WASM_PAGE_SIZE,\n            });\n            return {\n              memory: memory,\n              pow: Math.pow,\n              exit: exit,\n              powf: Math.pow,\n              exp: Math.exp,\n              sqrtf: Math.sqrt,\n              cos: Math.cos,\n              log: Math.log,\n              sin: Math.sin,\n              sbrk: sbrk,\n            };\n          })\n          .then((Runtime) => {\n            return fetchAndInstantiate(wasmURL, { env: Runtime });\n          })\n          .then((wasm) => {\n            FFI = wasm.instance.exports;\n            postMessage({ type: 'init', data: null });\n          })\n          .catch((err) => {\n            postMessage({ type: 'init-error', data: err.toString() });\n          });\n        break;\n      case 'start':\n        if (!vmsg_init(msg.data))\n          return postMessage({ type: 'error', data: 'vmsg_init' });\n        break;\n      case 'data':\n        if (!vmsg_encode(msg.data))\n          return postMessage({ type: 'error', data: 'vmsg_encode' });\n        break;\n      case 'stop':\n        const blob = vmsg_flush();\n        if (!blob) return postMessage({ type: 'error', data: 'vmsg_flush' });\n        postMessage({ type: 'stop', data: blob });\n        break;\n    }\n  };\n}\n\nexport class Recorder {\n  constructor(opts = {}, onStop = null) {\n    // Can't use relative URL in blob worker, see:\n    // https://stackoverflow.com/a/22582695\n    this.wasmURL = new URL(\n      opts.wasmURL || '/static/js/vmsg.wasm',\n      location\n    ).href;\n    this.shimURL = new URL(\n      opts.shimURL || '/static/js/wasm-polyfill.js',\n      location\n    ).href;\n    this.onStop = onStop;\n    this.pitch = opts.pitch || 0;\n    this.stream = null;\n    this.audioCtx = null;\n    this.gainNode = null;\n    this.pitchFX = null;\n    this.encNode = null;\n    this.worker = null;\n    this.workerURL = null;\n    this.blob = null;\n    this.blobURL = null;\n    this.resolve = null;\n    this.reject = null;\n    Object.seal(this);\n  }\n\n  close() {\n    if (this.encNode) this.encNode.disconnect();\n    if (this.encNode) this.encNode.onaudioprocess = null;\n    if (this.stream) this.stopTracks();\n    if (this.audioCtx) this.audioCtx.close();\n    if (this.worker) {\n      this.worker.terminate();\n      this.worker = null;\n    }\n    if (this.workerURL) URL.revokeObjectURL(this.workerURL);\n    if (this.blobURL) URL.revokeObjectURL(this.blobURL);\n  }\n\n  // Without pitch shift:\n  //   [sourceNode] -> [gainNode] -> [encNode] -> [audioCtx.destination]\n  //                                     |\n  //                                     -> [worker]\n  // With pitch shift:\n  //   [sourceNode] -> [gainNode] -> [pitchFX] -> [encNode] -> [audioCtx.destination]\n  //                                                  |\n  //                                                  -> [worker]\n  initAudio() {\n    const getUserMedia =\n      navigator.mediaDevices && navigator.mediaDevices.getUserMedia\n        ? function (constraints) {\n            return navigator.mediaDevices.getUserMedia(constraints);\n          }\n        : function (constraints) {\n            const oldGetUserMedia =\n              navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\n            if (!oldGetUserMedia) {\n              return Promise.reject(\n                new Error('getUserMedia is not implemented in this browser')\n              );\n            }\n            return new Promise(function (resolve, reject) {\n              oldGetUserMedia.call(navigator, constraints, resolve, reject);\n            });\n          };\n\n    return getUserMedia({ audio: true }).then((stream) => {\n      this.stream = stream;\n      const audioCtx = (this.audioCtx = new (window.AudioContext ||\n        window.webkitAudioContext)());\n\n      const sourceNode = audioCtx.createMediaStreamSource(stream);\n      const gainNode = (this.gainNode = (\n        audioCtx.createGain || audioCtx.createGainNode\n      ).call(audioCtx));\n      gainNode.gain.value = 1;\n      sourceNode.connect(gainNode);\n\n      const pitchFX = (this.pitchFX = new Jungle(audioCtx));\n      pitchFX.setPitchOffset(this.pitch);\n\n      const encNode = (this.encNode = (\n        audioCtx.createScriptProcessor || audioCtx.createJavaScriptNode\n      ).call(audioCtx, 0, 1, 1));\n      pitchFX.output.connect(encNode);\n\n      gainNode.connect(this.pitch === 0 ? encNode : pitchFX.input);\n    });\n  }\n\n  initWorker() {\n    if (this.worker) return Promise.resolve();\n    // https://stackoverflow.com/a/19201292\n    const blob = new Blob(['(', inlineWorker.toString(), ')()'], {\n      type: 'application/javascript',\n    });\n    const workerURL = (this.workerURL = URL.createObjectURL(blob));\n    const worker = (this.worker = new Worker(workerURL));\n    const { wasmURL, shimURL } = this;\n    worker.postMessage({ type: 'init', data: { wasmURL, shimURL } });\n    return new Promise((resolve, reject) => {\n      worker.onmessage = (e) => {\n        const msg = e.data;\n        switch (msg.type) {\n          case 'init':\n            resolve();\n            break;\n          case 'init-error':\n            this.close();\n            reject(new Error(msg.data));\n            break;\n          // TODO(Kagami): Error handling.\n          case 'error':\n          case 'internal-error':\n            this.close();\n            console.error('Worker error:', msg.data);\n            if (this.reject) this.reject(msg.data);\n            break;\n          case 'stop':\n            this.blob = msg.data;\n            this.blobURL = URL.createObjectURL(msg.data);\n            if (this.onStop) this.onStop();\n            if (this.resolve) this.resolve(this.blob);\n            break;\n        }\n      };\n    });\n  }\n\n  init() {\n    return this.initAudio().then(this.initWorker.bind(this));\n  }\n\n  startRecording() {\n    if (!this.stream) throw new Error('missing audio initialization');\n    if (!this.worker) throw new Error('missing worker initialization');\n    this.blob = null;\n    if (this.blobURL) URL.revokeObjectURL(this.blobURL);\n    this.blobURL = null;\n    this.resolve = null;\n    this.reject = null;\n    this.worker.postMessage({ type: 'start', data: this.audioCtx.sampleRate });\n    this.encNode.onaudioprocess = (e) => {\n      const samples = e.inputBuffer.getChannelData(0);\n      this.worker.postMessage({ type: 'data', data: samples });\n    };\n    this.encNode.connect(this.audioCtx.destination);\n  }\n\n  stopRecording() {\n    if (!this.stream) throw new Error('missing audio initialization');\n    if (!this.worker) throw new Error('missing worker initialization');\n    this.encNode.disconnect();\n    this.encNode.onaudioprocess = null;\n    this.stopTracks();\n    this.audioCtx.close();\n    this.worker.postMessage({ type: 'stop', data: null });\n    return new Promise((resolve, reject) => {\n      this.resolve = resolve;\n      this.reject = reject;\n    });\n  }\n\n  stopTracks() {\n    // Might be missed in Safari and old FF/Chrome per MDN.\n    if (this.stream.getTracks) {\n      // Hide browser's recording indicator.\n      this.stream.getTracks().forEach((track) => track.stop());\n    }\n  }\n}\n\nexport class Form {\n  constructor(opts = {}, resolve, reject) {\n    this.recorder = new Recorder(opts, this.onStop.bind(this));\n    this.resolve = resolve;\n    this.reject = reject;\n    this.backdrop = null;\n    this.popup = null;\n    this.recordBtn = null;\n    this.stopBtn = null;\n    this.timer = null;\n    this.audio = null;\n    this.saveBtn = null;\n    this.tid = 0;\n    this.start = 0;\n    Object.seal(this);\n\n    this.recorder\n      .initAudio()\n      .then(() => this.drawInit())\n      .then(() => this.recorder.initWorker())\n      .then(() => this.drawAll())\n      .catch((err) => this.drawError(err));\n  }\n\n  drawInit() {\n    if (this.backdrop) return;\n    const backdrop = (this.backdrop = document.createElement('div'));\n    backdrop.className = 'vmsg-backdrop';\n    backdrop.addEventListener('click', () => this.close(null));\n\n    const popup = (this.popup = document.createElement('div'));\n    popup.className = 'vmsg-popup';\n    popup.addEventListener('click', (e) => e.stopPropagation());\n\n    const progress = document.createElement('div');\n    progress.className = 'vmsg-progress';\n    for (let i = 0; i < 3; i++) {\n      const progressDot = document.createElement('div');\n      progressDot.className = 'vmsg-progress-dot';\n      progress.appendChild(progressDot);\n    }\n    popup.appendChild(progress);\n\n    backdrop.appendChild(popup);\n    document.body.appendChild(backdrop);\n  }\n\n  drawTime(msecs) {\n    const secs = Math.round(msecs / 1000);\n    this.timer.textContent = pad2(secs / 60) + ':' + pad2(secs % 60);\n  }\n\n  drawAll() {\n    this.drawInit();\n    this.clearAll();\n\n    const recordRow = document.createElement('div');\n    recordRow.className = 'vmsg-record-row';\n    this.popup.appendChild(recordRow);\n\n    const recordBtn = (this.recordBtn = document.createElement('button'));\n    recordBtn.className = 'vmsg-button vmsg-record-button';\n    recordBtn.textContent = '';\n    recordBtn.title = 'Start Recording';\n    recordBtn.addEventListener('click', () => this.startRecording());\n    recordRow.appendChild(recordBtn);\n\n    const stopBtn = (this.stopBtn = document.createElement('button'));\n    stopBtn.className = 'vmsg-button vmsg-stop-button';\n    stopBtn.style.display = 'none';\n    stopBtn.textContent = '';\n    stopBtn.title = 'Stop Recording';\n    stopBtn.addEventListener('click', () => this.stopRecording());\n    recordRow.appendChild(stopBtn);\n\n    const audio = (this.audio = new Audio());\n    audio.autoplay = true;\n\n    const timer = (this.timer = document.createElement('span'));\n    timer.className = 'vmsg-timer';\n    timer.title = 'Preview Recording';\n    timer.addEventListener('click', () => {\n      if (audio.paused) {\n        if (this.recorder.blobURL) {\n          audio.src = this.recorder.blobURL;\n        }\n      } else {\n        audio.pause();\n      }\n    });\n    this.drawTime(0);\n    recordRow.appendChild(timer);\n\n    const saveBtn = (this.saveBtn = document.createElement('button'));\n    saveBtn.className = 'vmsg-button vmsg-save-button';\n    saveBtn.textContent = '';\n    saveBtn.title = 'Save Recording';\n    saveBtn.disabled = true;\n    saveBtn.addEventListener('click', () => this.close(this.recorder.blob));\n    recordRow.appendChild(saveBtn);\n\n    const gainWrapper = document.createElement('div');\n    gainWrapper.className = 'vmsg-slider-wrapper vmsg-gain-slider-wrapper';\n    const gainSlider = document.createElement('input');\n    gainSlider.className = 'vmsg-slider vmsg-gain-slider';\n    gainSlider.setAttribute('type', 'range');\n    gainSlider.min = 0;\n    gainSlider.max = 2;\n    gainSlider.step = 0.2;\n    gainSlider.value = 1;\n    gainSlider.onchange = () => {\n      const gain = +gainSlider.value;\n      this.recorder.gainNode.gain.value = gain;\n    };\n    gainWrapper.appendChild(gainSlider);\n    this.popup.appendChild(gainWrapper);\n\n    const pitchWrapper = document.createElement('div');\n    pitchWrapper.className = 'vmsg-slider-wrapper vmsg-pitch-slider-wrapper';\n    const pitchSlider = document.createElement('input');\n    pitchSlider.className = 'vmsg-slider vmsg-pitch-slider';\n    pitchSlider.setAttribute('type', 'range');\n    pitchSlider.min = -1;\n    pitchSlider.max = 1;\n    pitchSlider.step = 0.2;\n    pitchSlider.value = this.recorder.pitch;\n    pitchSlider.onchange = () => {\n      const pitch = +pitchSlider.value;\n      this.recorder.pitchFX.setPitchOffset(pitch);\n      this.recorder.gainNode.disconnect();\n      this.recorder.gainNode.connect(\n        pitch === 0 ? this.recorder.encNode : this.recorder.pitchFX.input\n      );\n    };\n    pitchWrapper.appendChild(pitchSlider);\n    this.popup.appendChild(pitchWrapper);\n    recordBtn.focus();\n  }\n\n  drawError(err) {\n    console.error(err);\n    this.drawInit();\n    this.clearAll();\n    const error = document.createElement('div');\n    error.className = 'vmsg-error';\n    error.textContent = err.toString();\n    this.popup.appendChild(error);\n  }\n\n  clearAll() {\n    if (!this.popup) return;\n    this.popup.innerHTML = '';\n  }\n\n  close(blob) {\n    if (this.audio) this.audio.pause();\n    if (this.tid) clearTimeout(this.tid);\n    this.recorder.close();\n    this.backdrop.remove();\n    if (blob) {\n      this.resolve(blob);\n    } else {\n      this.reject(new Error('No record made'));\n    }\n  }\n\n  onStop() {\n    this.recordBtn.style.display = '';\n    this.stopBtn.style.display = 'none';\n    this.stopBtn.disabled = false;\n    this.saveBtn.disabled = false;\n  }\n\n  startRecording() {\n    this.audio.pause();\n    this.start = Date.now();\n    this.updateTime();\n    this.recordBtn.style.display = 'none';\n    this.stopBtn.style.display = '';\n    this.saveBtn.disabled = true;\n    this.stopBtn.focus();\n    this.recorder.startRecording();\n  }\n\n  stopRecording() {\n    clearTimeout(this.tid);\n    this.tid = 0;\n    this.stopBtn.disabled = true;\n    this.recordBtn.focus();\n    this.recorder.stopRecording();\n  }\n\n  updateTime() {\n    // NOTE(Kagami): We can do this in `onaudioprocess` but that would\n    // run too often and create unnecessary DOM updates.\n    this.drawTime(Date.now() - this.start);\n    this.tid = setTimeout(() => this.updateTime(), 300);\n  }\n}\n\nlet shown = false;\n\n/**\n * Record a new voice message.\n *\n * @param {Object=} opts - Options\n * @param {string=} opts.wasmURL - URL of the module\n *                                 (\"/static/js/vmsg.wasm\" by default)\n * @param {string=} opts.shimURL - URL of the WebAssembly polyfill\n *                                 (\"/static/js/wasm-polyfill.js\" by default)\n * @param {number=} opts.pitch - Initial pitch shift ([-1, 1], 0 by default)\n * @return {Promise.<Blob>} A promise that contains recorded blob when fulfilled.\n */\nexport function record(opts) {\n  return new Promise((resolve, reject) => {\n    if (shown) throw new Error('Record form is already opened');\n    shown = true;\n    new Form(opts, resolve, reject);\n    // Use `.finally` once it's available in Safari and Edge.\n  }).then(\n    (result) => {\n      shown = false;\n      return result;\n    },\n    (err) => {\n      shown = false;\n      throw err;\n    }\n  );\n}\n\n/**\n * All available public items.\n */\nexport default { Recorder, Form, record };\n\n// Borrowed from and slightly modified:\n// https://github.com/cwilso/Audio-Input-Effects/blob/master/js/jungle.js\n\n// Copyright 2012, Google Inc.\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n//     * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n//     * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n//     * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nconst delayTime = 0.1;\nconst fadeTime = 0.05;\nconst bufferTime = 0.1;\n\nfunction createFadeBuffer(context, activeTime, fadeTime) {\n  var length1 = activeTime * context.sampleRate;\n  var length2 = (activeTime - 2 * fadeTime) * context.sampleRate;\n  var length = length1 + length2;\n  var buffer = context.createBuffer(1, length, context.sampleRate);\n  var p = buffer.getChannelData(0);\n\n  var fadeLength = fadeTime * context.sampleRate;\n\n  var fadeIndex1 = fadeLength;\n  var fadeIndex2 = length1 - fadeLength;\n\n  // 1st part of cycle\n  for (var i = 0; i < length1; ++i) {\n    var value;\n\n    if (i < fadeIndex1) {\n      value = Math.sqrt(i / fadeLength);\n    } else if (i >= fadeIndex2) {\n      value = Math.sqrt(1 - (i - fadeIndex2) / fadeLength);\n    } else {\n      value = 1;\n    }\n\n    p[i] = value;\n  }\n\n  // 2nd part\n  for (var i = length1; i < length; ++i) {\n    p[i] = 0;\n  }\n\n  return buffer;\n}\n\nfunction createDelayTimeBuffer(context, activeTime, fadeTime, shiftUp) {\n  var length1 = activeTime * context.sampleRate;\n  var length2 = (activeTime - 2 * fadeTime) * context.sampleRate;\n  var length = length1 + length2;\n  var buffer = context.createBuffer(1, length, context.sampleRate);\n  var p = buffer.getChannelData(0);\n\n  // 1st part of cycle\n  for (var i = 0; i < length1; ++i) {\n    if (shiftUp)\n      // This line does shift-up transpose\n      p[i] = (length1 - i) / length;\n    // This line does shift-down transpose\n    else p[i] = i / length1;\n  }\n\n  // 2nd part\n  for (var i = length1; i < length; ++i) {\n    p[i] = 0;\n  }\n\n  return buffer;\n}\n\nfunction Jungle(context) {\n  this.context = context;\n  // Create nodes for the input and output of this \"module\".\n  var input = (context.createGain || context.createGainNode).call(context);\n  var output = (context.createGain || context.createGainNode).call(context);\n  this.input = input;\n  this.output = output;\n\n  // Delay modulation.\n  var mod1 = context.createBufferSource();\n  var mod2 = context.createBufferSource();\n  var mod3 = context.createBufferSource();\n  var mod4 = context.createBufferSource();\n  this.shiftDownBuffer = createDelayTimeBuffer(\n    context,\n    bufferTime,\n    fadeTime,\n    false\n  );\n  this.shiftUpBuffer = createDelayTimeBuffer(\n    context,\n    bufferTime,\n    fadeTime,\n    true\n  );\n  mod1.buffer = this.shiftDownBuffer;\n  mod2.buffer = this.shiftDownBuffer;\n  mod3.buffer = this.shiftUpBuffer;\n  mod4.buffer = this.shiftUpBuffer;\n  mod1.loop = true;\n  mod2.loop = true;\n  mod3.loop = true;\n  mod4.loop = true;\n\n  // for switching between oct-up and oct-down\n  var mod1Gain = (context.createGain || context.createGainNode).call(context);\n  var mod2Gain = (context.createGain || context.createGainNode).call(context);\n  var mod3Gain = (context.createGain || context.createGainNode).call(context);\n  mod3Gain.gain.value = 0;\n  var mod4Gain = (context.createGain || context.createGainNode).call(context);\n  mod4Gain.gain.value = 0;\n\n  mod1.connect(mod1Gain);\n  mod2.connect(mod2Gain);\n  mod3.connect(mod3Gain);\n  mod4.connect(mod4Gain);\n\n  // Delay amount for changing pitch.\n  var modGain1 = (context.createGain || context.createGainNode).call(context);\n  var modGain2 = (context.createGain || context.createGainNode).call(context);\n\n  var delay1 = (context.createDelay || context.createDelayNode).call(context);\n  var delay2 = (context.createDelay || context.createDelayNode).call(context);\n  mod1Gain.connect(modGain1);\n  mod2Gain.connect(modGain2);\n  mod3Gain.connect(modGain1);\n  mod4Gain.connect(modGain2);\n  modGain1.connect(delay1.delayTime);\n  modGain2.connect(delay2.delayTime);\n\n  // Crossfading.\n  var fade1 = context.createBufferSource();\n  var fade2 = context.createBufferSource();\n  var fadeBuffer = createFadeBuffer(context, bufferTime, fadeTime);\n  fade1.buffer = fadeBuffer;\n  fade2.buffer = fadeBuffer;\n  fade1.loop = true;\n  fade2.loop = true;\n\n  var mix1 = (context.createGain || context.createGainNode).call(context);\n  var mix2 = (context.createGain || context.createGainNode).call(context);\n  mix1.gain.value = 0;\n  mix2.gain.value = 0;\n\n  fade1.connect(mix1.gain);\n  fade2.connect(mix2.gain);\n\n  // Connect processing graph.\n  input.connect(delay1);\n  input.connect(delay2);\n  delay1.connect(mix1);\n  delay2.connect(mix2);\n  mix1.connect(output);\n  mix2.connect(output);\n\n  // Start\n  var t = context.currentTime + 0.05;\n  var t2 = t + bufferTime - fadeTime;\n  mod1.start(t);\n  mod2.start(t2);\n  mod3.start(t);\n  mod4.start(t2);\n  fade1.start(t);\n  fade2.start(t2);\n\n  this.mod1 = mod1;\n  this.mod2 = mod2;\n  this.mod1Gain = mod1Gain;\n  this.mod2Gain = mod2Gain;\n  this.mod3Gain = mod3Gain;\n  this.mod4Gain = mod4Gain;\n  this.modGain1 = modGain1;\n  this.modGain2 = modGain2;\n  this.fade1 = fade1;\n  this.fade2 = fade2;\n  this.mix1 = mix1;\n  this.mix2 = mix2;\n  this.delay1 = delay1;\n  this.delay2 = delay2;\n\n  this.setDelay(delayTime);\n}\n\nJungle.prototype.setDelay = function (delayTime) {\n  this.modGain1.gain.setTargetAtTime(0.5 * delayTime, 0, 0.01);\n  this.modGain2.gain.setTargetAtTime(0.5 * delayTime, 0, 0.01);\n};\n\nJungle.prototype.setPitchOffset = function (mult) {\n  if (mult > 0) {\n    // pitch up\n    this.mod1Gain.gain.value = 0;\n    this.mod2Gain.gain.value = 0;\n    this.mod3Gain.gain.value = 1;\n    this.mod4Gain.gain.value = 1;\n  } else {\n    // pitch down\n    this.mod1Gain.gain.value = 1;\n    this.mod2Gain.gain.value = 1;\n    this.mod3Gain.gain.value = 0;\n    this.mod4Gain.gain.value = 0;\n  }\n  this.setDelay(delayTime * Math.abs(mult));\n};\n","import React, { useState, useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { useLocation, useParams } from 'react-router-dom';\n\nimport {\n  fetchTiers,\n  fetchTitles,\n  fetchVersions,\n  fetchBand,\n  fetchBounces,\n  createBounce,\n} from '../actions';\n\nconst AddRecording = ({\n  currentBand,\n  tiers,\n  titles,\n  versions,\n  fetchBand,\n  fetchTiers,\n  fetchTitles,\n  fetchVersions,\n  fetchBounces,\n  createBounce,\n  uploadStarted,\n  error,\n  user,\n  recording,\n  onSuccess,\n}) => {\n  const defaultItem = { name: 'choose...', id: '0' };\n  const displayDate = () => {\n    return new Date().toISOString().substring(0, 10);\n  };\n\n  const [selectedTitle, setSelectedTitle] = useState(defaultItem);\n  const [selectedTier, setSelectedTier] = useState(defaultItem);\n  const [selectedVersion, setSelectedVersion] = useState(defaultItem);\n  const [selectedDate, setSelectedDate] = useState(displayDate());\n  const [uploadSuccess, setUploadSuccess] = useState(false);\n  const [uploadLoading, setUploadLoading] = useState(false);\n\n  const [titleList, setTitleList] = useState([]);\n  const [tierList, setTierList] = useState([]);\n  const [versionList, setVersionList] = useState([]);\n\n  const location = useLocation();\n  const params = useParams();\n\n  useEffect(() => {\n    fetchBand(params.bandName);\n    if (location.state) {\n      setSelectedTier(location.state.tier);\n      setSelectedTitle(location.state.title);\n      setSelectedVersion(location.state.version);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (currentBand) {\n      fetchTiers(currentBand.id);\n    }\n  }, [currentBand]);\n\n  useEffect(() => {\n    if (currentBand) {\n      const list = currentBand.tiers.map((id) => tiers[id]);\n      setTierList(list);\n    }\n  }, [tiers]);\n\n  useEffect(() => {\n    if (selectedTier.id !== '0') {\n      fetchTitles(selectedTier.id);\n      setVersionList([]);\n      setSelectedVersion(defaultItem);\n      setSelectedTitle(defaultItem);\n    }\n  }, [selectedTier]);\n\n  useEffect(() => {\n    if (selectedTier.id !== '0') {\n      const list = selectedTier.trackList.map((id) => titles[id]);\n      setTitleList(list);\n    }\n  }, [titles]);\n\n  useEffect(() => {\n    if (selectedTitle.id !== '0') {\n      fetchVersions(selectedTitle.id);\n      setSelectedVersion(defaultItem);\n    }\n  }, [selectedTitle]);\n\n  useEffect(() => {\n    if (selectedTitle.id !== '0') {\n      const list = selectedTitle.versions.map((id) => versions[id]);\n      setVersionList(list);\n    }\n  }, [versions]);\n\n  useEffect(() => {\n    if (selectedVersion.id !== '0') {\n      fetchBounces(selectedVersion.id);\n    }\n  }, [selectedVersion]);\n\n  useEffect(() => {\n    if (uploadLoading && !uploadStarted) {\n      setUploadLoading(false);\n      setUploadSuccess(true);\n      setTimeout(() => {\n        setUploadSuccess(false);\n      }, 10000);\n      onSuccess();\n    }\n    if (uploadStarted && !uploadLoading) {\n      setUploadLoading(true);\n    }\n  }, [uploadStarted]);\n\n  const selector = (stateList, onSelect, selectedItem) => {\n    const onChange = (e) => {\n      const selected = stateList.find((item) => item.id === e.target.value);\n      onSelect(selected);\n    };\n    const list = [defaultItem, ...stateList];\n    const options = list.map((item) => {\n      if (item) {\n        const name = item.name || item.title;\n        return (\n          <option value={item.id} key={item.id} disabled={item.id === '0'}>\n            {name}\n          </option>\n        );\n      }\n    });\n    return (\n      <select onChange={onChange} value={selectedItem.id}>\n        {options}\n      </select>\n    );\n  };\n\n  const onSubmit = (e) => {\n    e.preventDefault();\n    if (submitActive()) {\n      const file = new File([recording], 'recording.mp3', {\n        lastModified: Date(),\n      });\n      const form = {\n        date: selectedDate,\n        latest: true,\n        file: [file],\n      };\n      createBounce(form, selectedVersion.id);\n    }\n  };\n\n  const submitActive = () => {\n    if (recording && selectedDate && selectedVersion.id !== '0') {\n      return true;\n    }\n    return false;\n  };\n\n  const renderUploadSuccess = () => {\n    return <div className=\"upload-success\">Recording Successfully Saved!</div>;\n  };\n\n  const renderUploadLoading = () => {\n    return (\n      <div className=\"upload-image\">\n        <p>Uploading...</p>\n        <img src=\"/images/windmill.gif\" className=\"windmill\" />\n      </div>\n    );\n  };\n\n  if (!user || !currentBand || !user.bands.includes(currentBand.id)) {\n    return (\n      <div className=\"add-recording\">\n        Warning: you will not be able to save this recording because you are not\n        signed in or this is not your band.\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"add-recording\">\n      <h2>Save recording for {currentBand.name}</h2>\n      <div className=\"add-recording-select-row\">\n        <div className=\"add-recording-label\">Tier:</div>\n        <div>\n          {currentBand &&\n            tierList &&\n            selector(tierList, setSelectedTier, selectedTier)}\n        </div>\n      </div>\n\n      <div className=\"add-recording-select-row\">\n        <div className=\"add-recording-label\">Title:</div>\n        <div>\n          {selectedTier &&\n            titleList &&\n            selector(titleList, setSelectedTitle, selectedTitle)}\n        </div>\n      </div>\n\n      <div className=\"add-recording-select-row\">\n        <div className=\"add-recording-label\">Version:</div>\n        <div>\n          {selectedTitle &&\n            versionList &&\n            selector(versionList, setSelectedVersion, selectedVersion)}\n        </div>\n      </div>\n\n      <div className=\"add-recording-select-row\">\n        <div className=\"add-recording-label\">Date:</div>\n        <div>\n          <input\n            type=\"date\"\n            value={selectedDate}\n            onChange={(e) => setSelectedDate(e.target.value)}\n            className=\"calendar\"\n          />\n        </div>\n      </div>\n      <form onSubmit={onSubmit}>\n        <button\n          className={`${\n            submitActive()\n              ? 'submit-button submit-button-centered'\n              : 'submit-inactive'\n          }`}\n          type=\"submit\"\n        >\n          Save Bounce\n        </button>\n      </form>\n      {uploadSuccess && renderUploadSuccess()}\n      {uploadLoading && renderUploadLoading()}\n      {error}\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    tiers: state.tiers,\n    titles: state.titles,\n    versions: state.versions,\n    currentBand: state.bands.currentBand,\n    uploadStarted: state.bands.uploadStarted,\n    error: state.error.error,\n    user: state.auth.user,\n  };\n};\n\nexport default connect(mapStateToProps, {\n  fetchTiers,\n  fetchTitles,\n  fetchVersions,\n  fetchBand,\n  createBounce,\n  fetchBounces,\n})(AddRecording);\n","import React, { useState, useEffect } from 'react';\n\nconst Timer = ({ isRecording }) => {\n  const [timer, setTimer] = useState(0);\n\n  useEffect(() => {\n    let interval;\n    if (isRecording) {\n      interval = setInterval(() => {\n        setTimer(timer + 1);\n      }, 1000);\n    } else {\n      clearInterval(interval);\n      setTimer(0);\n    }\n    return () => {\n      clearInterval(interval);\n    };\n  }, [isRecording, timer]);\n\n  const formatTime = (time) => {\n    let minutes =\n      time < 600 ? `0${Math.floor(time / 60)}` : Math.floor(time / 60);\n    let seconds =\n      time % 60 < 10 ? `0${Math.floor(time % 60)}` : Math.floor(time % 60);\n    return `${minutes}:${seconds}`;\n  };\n\n  return <div className=\"recorder-time\">{formatTime(timer)}</div>;\n};\n\nexport default Timer;\n","import React, { useEffect, useState } from 'react';\n\nconst DeviceControl = ({ inputSource, setInputSource, isRecording }) => {\n  const [devices, setDevices] = useState([]);\n\n  useEffect(() => {\n    getDevices();\n    navigator.mediaDevices.ondevicechange = getDevices;\n  }, []);\n\n  const getDevices = async () => {\n    // get user input devices\n    const devices = await navigator.mediaDevices.enumerateDevices();\n    const inputDevices = devices.map((device) => {\n      if (device.kind === 'audioinput' && device.deviceId !== 'default') {\n        return device;\n      }\n    });\n    setDevices(inputDevices);\n    if (!inputSource) {\n      setInputSource(devices[0]);\n    }\n  };\n\n  const micSelect = () => {\n    const deviceList = devices.map((device) => {\n      if (device) {\n        return <option key={device.deviceId}>{device.label}</option>;\n      }\n    });\n    return <select disabled={isRecording}>{deviceList}</select>;\n  };\n\n  return (\n    <div className=\"device-control\">\n      <div>Input device:</div>\n      <div className=\"mic-select\">{micSelect()}</div>\n    </div>\n  );\n};\n\nexport default DeviceControl;\n","import React, { useEffect, useRef, useState } from 'react';\nimport vmsg from '../vmsg';\nimport { connect } from 'react-redux';\n\nimport { clearRecordings, createRecording, fetchRecording } from '../actions';\nimport AddRecording from './AddRecording';\nimport Timer from './Timer';\nimport DeviceControl from './DeviceControl';\n\nconst Recorder = ({ recordings, createRecording, fetchRecording }) => {\n  const [isRecording, setIsRecording] = useState(false);\n  const [audio, setAudio] = useState();\n  const [inputSource, setInputSource] = useState();\n  const [error, setError] = useState('');\n\n  const mediaRecorder = useRef();\n\n  useEffect(() => {\n    // Initialize vmsg recorder\n    mediaRecorder.current = new vmsg.Recorder({\n      wasmURL: 'https://unpkg.com/vmsg@0.4.0/vmsg.wasm',\n    });\n\n    const recordingList = JSON.parse(localStorage.getItem('recording-list'));\n    if (recordingList) {\n      recordingList.forEach((id, index) => {\n        fetchRecording(id, index);\n      });\n    }\n  }, []);\n\n  const onRecord = () => {\n    if (!isRecording) {\n      startRecording();\n    } else {\n      stopRecording();\n    }\n  };\n\n  const startRecording = async () => {\n    try {\n      await navigator.mediaDevices.getUserMedia({\n        audio: {\n          deviceId: inputSource.deviceId,\n        },\n      });\n      await mediaRecorder.current.init();\n      mediaRecorder.current.startRecording();\n      setIsRecording(true);\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n\n  const stopRecording = async () => {\n    try {\n      const blob = await mediaRecorder.current.stopRecording();\n      const file = new File([blob], 'recording.mp3', {\n        lastModified: Date(),\n      });\n      createRecording(blob);\n      setAudio(blob);\n      setIsRecording(false);\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n\n  const renderButtons = () => {\n    return (\n      <div className=\"recorder-buttons\">\n        <div onClick={onRecord} className=\"recorder-btn\">\n          {isRecording ? 'Stop' : 'Record'}\n        </div>\n      </div>\n    );\n  };\n\n  const renderDisplay = () => {\n    let display = '';\n    if (audio && !isRecording) {\n      const url = URL.createObjectURL(audio);\n      display = <audio controls src={url} />;\n    } else if (isRecording) {\n      display = <Timer isRecording={isRecording} />;\n    }\n    return <div className=\"playhead-container\">{display}</div>;\n  };\n\n  const renderList = () => {\n    if (recordings) {\n      return recordings.map((item, index) => {\n        if (!item) {\n          return;\n        }\n        const selectedRecording = audio === item ? 'selected-recording' : '';\n        const url = URL.createObjectURL(item);\n        return (\n          <div\n            onClick={() => setAudio(item)}\n            key={item.size}\n            className={`recording-list-item ${selectedRecording}`}\n          >\n            {`${index + 1}: `}\n            <audio\n              src={url}\n              controls\n              onClick={(e) => e.preventDefault()}\n              className=\"small-audio-player\"\n            />\n          </div>\n        );\n      });\n    }\n  };\n\n  const onCreateBounce = () => {\n    clearRecordings();\n    setAudio(null);\n  };\n\n  const renderAddRecording = () => {\n    const consolidatedBlob = recordings.length\n      ? new Blob(recordings, { type: 'audio/mpeg' })\n      : null;\n    return (\n      <AddRecording recording={consolidatedBlob} onSuccess={onCreateBounce} />\n    );\n  };\n\n  return (\n    <div className={isRecording ? 'recorder recording' : 'recorder'}>\n      {error}\n      {renderDisplay()}\n      {renderButtons()}\n      <DeviceControl\n        inputSource={inputSource}\n        setInputSource={setInputSource}\n        isRecording={isRecording}\n      />\n      <div className=\"recording-list\">\n        {renderList()}\n        {renderAddRecording()}\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    recordings: state.recordings,\n  };\n};\n\nexport default connect(mapStateToProps, { createRecording, fetchRecording })(\n  Recorder\n);\n","import React, { useRef, useEffect } from 'react';\nimport WaveformData from 'waveform-data';\n\nconst Waveform = ({ audio, isRecording }) => {\n  const canvas = useRef();\n  const audioContext = useRef();\n\n  const cache = useRef({});\n\n  useEffect(async () => {\n    if (isRecording && canvas.current) {\n      const ctx = canvas.current.getContext('2d');\n      ctx.clearRect(0, 0, canvas.current.width, canvas.current.height);\n    }\n  }, [isRecording]);\n\n  useEffect(async () => {\n    if (audio) {\n      if (canvas.current) {\n        const ctx = canvas.current.getContext('2d');\n        ctx.clearRect(0, 0, canvas.current.width, canvas.current.height);\n      }\n      if (!cache.current[audio.size]) {\n        renderWaveform();\n      } else {\n        drawWaveform(cache.current[audio.size]);\n      }\n    }\n  }, [audio]);\n\n  const renderWaveform = async () => {\n    if (!audioContext.current) {\n      audioContext.current = new AudioContext();\n    }\n    const buffer = await audio.arrayBuffer();\n    const options = {\n      audio_context: audioContext.current,\n      array_buffer: buffer,\n      scale: 64,\n    };\n    WaveformData.createFromAudio(options, (err, waveform) => {\n      if (err) {\n        console.log(err);\n      } else {\n        drawWaveform(waveform);\n        cache.current[audio.size] = waveform;\n      }\n    });\n  };\n\n  const drawWaveform = (waveform) => {\n    const ctx = canvas.current.getContext('2d');\n\n    const lengthMultiplier = waveform.length / 300;\n\n    const scaleY = (amplitude, height) => {\n      const range = 256;\n      const offset = 128;\n\n      return height - ((amplitude + offset) * height) / range;\n    };\n\n    ctx.beginPath();\n\n    const channel = waveform.channel(0);\n\n    // Loop forwards, drawing the upper half of the waveform\n    for (let x = 0; x < waveform.length; x++) {\n      const val = channel.max_sample(x);\n\n      ctx.lineTo(x / lengthMultiplier, scaleY(val, canvas.current.height));\n    }\n\n    // Loop backwards, drawing the lower half of the waveform\n    for (let x = waveform.length - 1; x >= 0; x--) {\n      const val = channel.min_sample(x);\n\n      ctx.lineTo(x / lengthMultiplier, scaleY(val, canvas.current.height));\n    }\n\n    ctx.closePath();\n    ctx.stroke();\n    ctx.fill();\n  };\n\n  return <canvas ref={canvas} />;\n};\n\nexport default Waveform;\n","import React, { useState, useEffect, useRef } from 'react';\n\nimport Waveform from './Waveform';\n\nconst Playhead = ({ audio, isRecording, addToSongList }) => {\n  const [playheadPosition, setPlayheadPosition] = useState(0);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [editedAudio, setEditedAudio] = useState(audio);\n  const [zoomIn, setZoomIn] = useState(false);\n  const [start, setStart] = useState(0);\n  const [end, setEnd] = useState(1000);\n\n  const player = useRef();\n\n  useEffect(() => {\n    player.current = new Audio();\n    player.current.onended = () => {\n      setIsPlaying(false);\n    };\n    player.current.onplay = () => {\n      setIsPlaying(true);\n    };\n    player.current.onpause = () => {\n      setIsPlaying(false);\n    };\n    player.current.ontimeupdate = updateSlider;\n  }, []);\n\n  useEffect(() => {\n    if (isRecording) {\n      setIsPlaying(false);\n      if (player.current && !player.current.paused) {\n        player.current.pause();\n      }\n    }\n  }, [isRecording]);\n\n  useEffect(() => {\n    if (editedAudio) {\n      const url = URL.createObjectURL(editedAudio);\n      player.current.src = url;\n    }\n  }, [editedAudio]);\n\n  useEffect(() => {\n    setIsPlaying(false);\n    player.current.pause();\n    setPlayheadPosition(0);\n    const blobStart = audio.size * (start * 0.001);\n    const blobEnd = audio.size * (end * 0.001);\n    if (zoomIn) {\n      const edited = audio.slice(blobStart, blobEnd, audio.type);\n      setEditedAudio(edited);\n    } else {\n      setEditedAudio(audio);\n    }\n  }, [zoomIn]);\n\n  const renderPlayButton = () => {\n    if (!isRecording && audio && !isPlaying) {\n      return (\n        <img\n          src=\"/images/play.svg\"\n          className=\"play-icon\"\n          onClick={() => player.current.play()}\n        />\n      );\n    } else if (!isRecording && audio) {\n      return (\n        <img\n          src=\"/images/pause.svg\"\n          className=\"play-icon\"\n          onClick={() => player.current.pause()}\n        />\n      );\n    }\n  };\n\n  const updateSlider = () => {\n    const position =\n      (player.current.currentTime / player.current.duration) * 1000;\n    if (!isNaN(position)) {\n      setPlayheadPosition(position);\n    }\n  };\n\n  const onSliderChange = (e) => {\n    const position = (e.target.value / 1000) * player.current.duration;\n    if (!isNaN(position)) {\n      player.current.currentTime = position;\n    }\n  };\n\n  const formatTime = (time) => {\n    let minutes =\n      time < 600 ? `0${Math.floor(time / 60)}` : Math.floor(time / 60);\n    let seconds =\n      time % 60 < 10 ? `0${Math.floor(time % 60)}` : Math.floor(time % 60);\n    return `${minutes}:${seconds}`;\n  };\n\n  const renderAudioTime = () => {\n    if (player.current) {\n      return formatTime(player.current.currentTime);\n    }\n  };\n\n  const onStartClick = () => {\n    const start = playheadPosition;\n    if (start < end) {\n      setStart(start);\n    } else {\n      setStart(start);\n      setEnd(start + 1);\n    }\n  };\n\n  const onEndClick = () => {\n    const end = playheadPosition;\n    if (end > start) {\n      setEnd(end);\n    } else {\n      setEnd(end);\n      setStart(end - 1);\n    }\n  };\n\n  const renderEditor = () => {\n    return (\n      <div className=\"editor-controls\">\n        <div onClick={onStartClick} className=\"editor-btn\">\n          Set start\n        </div>\n        <div onClick={onEndClick} className=\"editor-btn\">\n          Set end\n        </div>\n        <div>\n          <input\n            type=\"checkbox\"\n            onChange={() => setZoomIn(!zoomIn)}\n            value={zoomIn}\n          />\n          <label>Zoom</label>\n        </div>\n      </div>\n    );\n  };\n\n  const renderSelectSectionButton = () => {\n    if (zoomIn) {\n      return (\n        <div\n          onClick={() => addToSongList(editedAudio)}\n          className=\"select-section-btn\"\n        >\n          save zoomed section\n        </div>\n      );\n    }\n  };\n\n  return (\n    <>\n      <div className=\"playhead-controls\">\n        <div className=\"audio-controls\">\n          {renderPlayButton()}\n          {renderAudioTime()}\n        </div>\n        {renderSelectSectionButton()}\n        {renderEditor()}\n      </div>\n\n      <div className=\"waveform-display\">\n        <Waveform audio={editedAudio} isRecording={isRecording} />\n\n        {!zoomIn && (\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"1000\"\n            value={start}\n            className=\"playhead start-line\"\n            readOnly\n          />\n        )}\n\n        {!zoomIn && (\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"1000\"\n            value={end}\n            className=\"playhead end-line\"\n            readOnly\n          />\n        )}\n\n        <input\n          type=\"range\"\n          min=\"0\"\n          max=\"1000\"\n          value={playheadPosition}\n          className=\"playhead\"\n          onInput={onSliderChange}\n        />\n      </div>\n    </>\n  );\n};\n\nexport default Playhead;\n","import React, { useState, useEffect } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport audioEncoder from 'audio-encoder';\nimport { Lame } from 'node-lame';\nimport { decode } from 'base64-arraybuffer';\n\nimport Playhead from './Playhead';\nimport greenhouse from '../apis/greenhouse';\nimport AddRecording from './AddRecording';\n\nconst Editor = () => {\n  const location = useLocation();\n\n  const [audio, setAudio] = useState();\n  const [songList, setSongList] = useState([]);\n\n  useEffect(async () => {\n    const { bounce } = location.state;\n    const response = await greenhouse.get(`/audio/edit/${bounce.id}`);\n    const decoded = decode(response.data);\n    const arrayBuffer = new Uint8Array(decoded);\n    const blob = new Blob([arrayBuffer], { type: 'audio/mpeg' });\n    setAudio(blob);\n  }, []);\n\n  const renderDetails = () => {\n    const { title, version, bounce } = location.state;\n    const date = new Date(bounce.date);\n    return (\n      <div className=\"editor-title\">\n        {title.title} {version.name} {date.getMonth()}/{date.getDate()}/\n        {date.getFullYear()}\n      </div>\n    );\n  };\n\n  const addToSongList = (song) => {\n    setSongList([...songList, song]);\n  };\n\n  const renderSongList = () => {\n    return songList.map((song, index) => {\n      const url = URL.createObjectURL(song);\n      return (\n        <div className=\"recording-section-item\" key={song.size}>\n          <h2>{index + 1}: </h2>\n          <audio controls src={url} />\n          <AddRecording recording={song} />\n        </div>\n      );\n    });\n  };\n\n  return (\n    <div className=\"editor\">\n      {renderDetails()}\n      {audio && (\n        <Playhead\n          audio={audio}\n          isRecording={false}\n          addToSongList={addToSongList}\n        />\n      )}\n      {renderSongList()}\n    </div>\n  );\n};\n\nexport default Editor;\n","import React, { useEffect } from 'react';\nimport { Router, Route, Switch } from 'react-router-dom';\nimport { connect } from 'react-redux';\n\nimport Error from './Error';\nimport Header from './Header';\nimport User from './User';\nimport SignIn from './SignIn';\nimport SignUp from './SignUp';\nimport Home from './Home';\nimport Help from './Help';\nimport Recorder from './Recorder';\nimport Editor from './Editor';\nimport { fetchUser } from '../actions';\n\nimport history from '../history';\n\nconst App = ({ signedIn, fetchUser, error }) => {\n  useEffect(() => {\n    if (signedIn) {\n      fetchUser();\n    }\n  }, []);\n\n  const errClass = error ? 'error-margin' : '';\n\n  return (\n    <>\n      <Error />\n      <div className={`container ${errClass}`}>\n        <Router history={history}>\n          <Switch>\n            <Route path=\"/\" exact component={Home} />\n            <Route path=\"/signin\" exact component={SignIn} />;\n            <Route path=\"/signup\" exact component={SignUp} />;\n            <Route\n              path=\"/user\"\n              exact\n              render={(routeProps) => {\n                if (!signedIn) {\n                  history.push('/signin');\n                  return null;\n                }\n                return <User {...routeProps} />;\n              }}\n            />\n            <Route path=\"/help\" exact component={Help} />\n            <Route path=\"/:bandName/record\" exact component={Recorder} />\n            <Route path=\"/:bandName/edit\" component={Editor} />\n            <Route path=\"/:bandName\" component={Header} />\n          </Switch>\n        </Router>\n      </div>\n    </>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    signedIn: state.auth.isSignedIn,\n    error: state.error.error,\n  };\n};\n\nexport default connect(mapStateToProps, { fetchUser })(App);\n","import { SIGN_IN, SIGN_OUT, CREATE_BAND } from '../actions/types';\n\nconst INITIAL_STATE = {\n    isSignedIn: false,\n    user: null\n};\n\nexport default (state = INITIAL_STATE, action) => {\n    switch (action.type) {\n        case SIGN_IN:\n            return { ...state, isSignedIn: true, user: action.payload };\n        case SIGN_OUT:\n            return { ...state, isSignedIn: false, user: null };\n        case CREATE_BAND:\n            const { user } = state;\n            user.bands.push(action.payload.id);\n            return { ...state, user };\n        default:\n            return state;  \n    } \n};\n","import { PLAY_AUDIO, PAUSE_AUDIO, QUEUE_SONGS, NEXT_SONG, DELETE_BOUNCE, CHANGE_VOLUME, INITIALIZE_AUDIO } from \"../actions/types\";\n\nconst initialState = {\n    play: false,\n    volume: 75,\n    currentSong: null\n};\n\nexport default (state = initialState, action) => {\n    switch (action.type) {\n        case PLAY_AUDIO:\n            return { ...state, play: true, pause: false };\n        case PAUSE_AUDIO:\n            return { ...state, play: false, pause: true };\n        case QUEUE_SONGS:\n            const { song, parent } = action.payload;\n            return { ...state, currentSong: song, play: true, parent };\n        case NEXT_SONG:\n            return { ...state, currentSong: action.payload };\n        case DELETE_BOUNCE:\n            if (state.currentSong && action.payload.bounce.id === state.currentSong.audio) {\n                return { ...initialState };\n            } else {\n                return state;\n            }\n            // if (state.queue.length) {\n            //     state.queue = state.queue.filter(song => song.audio !== action.payload.bounce.id);\n            //     return { ...state };\n            // }\n        case CHANGE_VOLUME:\n            return { ...state, volume: action.payload };\n        case INITIALIZE_AUDIO:\n            return { ...initialState };\n        default:\n            return state;\n    }\n};","import { combineReducers } from 'redux';\nimport { reducer as formReducer } from 'redux-form';\nimport authReducer from './authReducer';\nimport tierReducer from './tierReducer';\nimport titleReducer from './titleReducer';\nimport versionReducer from './versionReducer';\nimport bounceReducer from './bounceReducer';\nimport playlistReducer from './playlistReducer';\nimport playlistSongReducer from './playlistSongReducer';\nimport bandReducer from './bandReducer';\nimport errorReducer from './errorReducer';\nimport audioReducer from './audioReducer';\nimport recordingReducer from './recordingReducer';\nimport { FETCH_BAND } from '../actions/types';\n\nconst appReducer = combineReducers({\n  form: formReducer,\n  auth: authReducer,\n  tiers: tierReducer,\n  titles: titleReducer,\n  versions: versionReducer,\n  bounces: bounceReducer,\n  playlists: playlistReducer,\n  playlistSongs: playlistSongReducer,\n  bands: bandReducer,\n  error: errorReducer,\n  audio: audioReducer,\n  recordings: recordingReducer,\n});\n\n// clear the store if we are loading a new band's data\n\nexport default (state, action) => {\n  if (action.type === FETCH_BAND) {\n    const clearedState = { auth: state.auth };\n    return appReducer(clearedState, action);\n  }\n  return appReducer(state, action);\n};\n","import { FETCH_TIERS, CREATE_TIER, EDIT_TIER, DELETE_TIER, CREATE_TITLE, EDIT_TITLE, DELETE_TITLE, ORDER_TIER } from '../actions/types';\nimport _ from 'lodash';\n\nexport default (state = {}, action) => {\n\n    switch (action.type) {\n\n        case FETCH_TIERS:\n            return { ...state, ..._.mapKeys(action.payload, 'id') };\n        case CREATE_TIER:\n            return { ...state, [action.payload.id]: action.payload };\n        case EDIT_TIER:\n            const oldPosition = state[action.payload.id]['position'];\n            const newPosition = action.payload.position;\n            let changedPositions = {};\n            if (oldPosition > newPosition) {\n                for (let item of Object.values(state)) {\n                    if (item.position >= newPosition && item.position < oldPosition) {\n                        const pos = item.position;\n                        changedPositions[item.id] = { ...item, position: pos + 1};\n                    }\n                }\n            }\n            if (oldPosition < newPosition) {\n                for (let item of Object.values(state)) {\n                    if (item.position > oldPosition && item.position <= newPosition) {\n                        const pos = item.position;\n                        changedPositions[item.id] = { ...item, position: pos - 1};\n                    }\n                }\n            }\n            return { ...state, [action.payload.id]: action.payload, ...changedPositions };\n        case DELETE_TIER:\n            const changePosition = Object.values(_.omit(state, state.currentBand)).filter(t => t.position > action.payload.position);\n            changePosition.forEach((tier) => {\n                tier.position = tier.position - 1;\n            });\n            delete state[action.payload.id];\n            return { ...state, ..._.mapKeys(changePosition, 'id') };\n        case ORDER_TIER:\n            state[action.payload.tier].orderBy = action.payload.orderBy;\n            return { ...state };\n        case CREATE_TITLE:\n            const addToTier = state[action.payload.tier];\n            addToTier.trackList.push(action.payload.title.id);\n            return { ...state, [addToTier.id]: addToTier };\n        case EDIT_TITLE:\n            if (action.payload.tier.new) {\n                const newTier = state[action.payload.tier.new];\n                newTier.trackList.push(action.payload.title.id);\n                const oldTier = state[action.payload.tier.old];\n                oldTier.trackList = oldTier.trackList.filter(id => id !== action.payload.title.id);\n                return { ...state, [newTier.id]: newTier, [oldTier.id]: oldTier };\n            } else {\n                return state;\n            }\n        case DELETE_TITLE:\n            const deleteFromTier = state[action.payload.tier];\n            if (deleteFromTier) {\n                const newTrackList = deleteFromTier.trackList.filter(id => id !== action.payload.title.id);\n                deleteFromTier.trackList = newTrackList;\n                return { ...state, [deleteFromTier.id]: deleteFromTier };\n            }\n        default:\n            return state;\n\n    }\n\n};","import { FETCH_TITLES, CREATE_TITLE, EDIT_TITLE, DELETE_TITLE, SELECT_VERSION, SELECT_BOUNCE, CREATE_VERSION, DELETE_VERSION } from '../actions/types';\nimport _ from 'lodash';\n\n\nexport default (state = {}, action) => {\n\n    switch (action.type) {\n\n        case FETCH_TITLES:\n            return { ...state, ..._.mapKeys(action.payload, 'id') };\n        case CREATE_TITLE:\n            return { ...state, [action.payload.title.id]: action.payload.title };\n        case EDIT_TITLE:\n            const oldTitle = state[action.payload.title.id];\n            const newTitle = action.payload.title;\n            newTitle.selectedVersion = oldTitle.selectedVersion;\n            newTitle.selectedBounce = oldTitle.selectedBounce;\n            return { ...state, [newTitle.id]: newTitle };\n        case DELETE_TITLE:\n            delete state[action.payload.title.id];\n            return { ...state };\n        case SELECT_VERSION:\n            const versionTitle = state[action.payload.titleId];\n            versionTitle.selectedVersion = action.payload.version;\n            return { ...state, [versionTitle.id]: { ...versionTitle } };\n        case SELECT_BOUNCE:\n            const bounceTitle = state[action.payload.titleId];\n            bounceTitle.selectedBounce = action.payload.bounce;\n            return { ...state, [bounceTitle.id]: { ...bounceTitle } }\n        case CREATE_VERSION:\n            const addToTitle = state[action.payload.title];\n            addToTitle.versions.push(action.payload.version.id);\n            addToTitle.selectedVersion = action.payload.version;\n            return { ...state, [addToTitle.id]: addToTitle};\n        case DELETE_VERSION:\n            const deleteFromTitle = state[action.payload.title];\n            if (deleteFromTitle) {\n                const newVersionList = deleteFromTitle.versions.filter(id => id !== action.payload.version.id);\n                deleteFromTitle.versions = newVersionList;\n                return { ...state, [deleteFromTitle.id]: deleteFromTitle };\n            }   \n        default:\n            return state;\n\n    }\n\n};","import { FETCH_VERSIONS, CREATE_VERSION, EDIT_VERSION, DELETE_VERSION, CREATE_BOUNCE, DELETE_BOUNCE } from '../actions/types';\nimport _ from 'lodash';\n\nexport default (state = {}, action) => {\n\n    switch (action.type) {\n\n        case FETCH_VERSIONS:\n            return { ...state, ..._.mapKeys(action.payload, 'id') };\n        case CREATE_VERSION:\n            return { ...state, [action.payload.version.id]: action.payload.version };\n        case EDIT_VERSION:\n            return { ...state, [action.payload.version.id]: action.payload.version };\n        case DELETE_VERSION:\n            delete state[action.payload.version.id];\n            return { ...state };\n        case CREATE_BOUNCE:\n            const addToVersion = state[action.payload.version];\n            addToVersion.bounces.push(action.payload.bounce.id);\n            return { ...state, [addToVersion.id]: addToVersion};\n        case DELETE_BOUNCE:\n            const deleteFromVersion = state[action.payload.version];\n            if (deleteFromVersion) {\n                const newBounceList = deleteFromVersion.bounces.filter(id => id !== action.payload.bounce.id);\n                deleteFromVersion.bounces = newBounceList;\n                return { ...state, [deleteFromVersion.id]: deleteFromVersion };\n            }\n        default:\n            return state;\n\n    }\n\n};","import {\n  FETCH_BOUNCES,\n  CREATE_BOUNCE,\n  EDIT_BOUNCE,\n  DELETE_BOUNCE,\n} from '../actions/types';\nimport _ from 'lodash';\n\nexport default (state = {}, action) => {\n  switch (action.type) {\n    case FETCH_BOUNCES:\n      return { ...state, ..._.mapKeys(action.payload, 'id') };\n    case CREATE_BOUNCE:\n      return { ...state, [action.payload.bounce.id]: action.payload.bounce };\n    case EDIT_BOUNCE:\n      return { ...state, [action.payload.id]: action.payload };\n    case DELETE_BOUNCE:\n      delete state[action.payload.bounce.id];\n      return { ...state };\n    default:\n      return state;\n  }\n};\n","import { FETCH_PLAYLISTS, FETCH_PLAYLIST, CREATE_PLAYLIST, EDIT_PLAYLIST, DELETE_PLAYLIST, CREATE_PLAYLISTSONG, DELETE_PLAYLISTSONG } from '../actions/types';\nimport _ from 'lodash';\n\nexport default (state = {}, action) => {\n\n    switch (action.type) {\n\n        case FETCH_PLAYLISTS:\n            return { ...state, ..._.mapKeys(action.payload, 'id') };\n        case FETCH_PLAYLIST:\n            return { ...state, [action.payload.id]: action.payload };\n        case CREATE_PLAYLIST:\n            return { ...state, [action.payload.id]: action.payload };\n        case EDIT_PLAYLIST:\n            const oldPosition = state[action.payload.id]['position'];\n            const newPosition = action.payload.position;\n            let changedPositions = {};\n            if (oldPosition > newPosition) {\n                for (let item of Object.values(state)) {\n                    if (item.position >= newPosition && item.position < oldPosition) {\n                        const pos = item.position;\n                        changedPositions[item.id] = { ...item, position: pos + 1};\n                    }\n                }\n            }\n            if (oldPosition < newPosition) {\n                for (let item of Object.values(state)) {\n                    if (item.position > oldPosition && item.position <= newPosition) {\n                        const pos = item.position;\n                        changedPositions[item.id] = { ...item, position: pos - 1};\n                    }\n                }\n            }\n            return { ...state, [action.payload.id]: action.payload, ...changedPositions };\n        case DELETE_PLAYLIST:\n            delete state.currentBand;\n            const changePosition = Object.values(state).filter(p => p.position > action.payload.position);\n            changePosition.forEach((playlist) => {\n                playlist.position = playlist.position - 1;\n            });\n            delete state[action.payload.id]\n            return { ...state, ..._.mapKeys(changePosition, 'id')};\n        case CREATE_PLAYLISTSONG:\n            const addToPlaylist = state[action.payload.playlist];\n            addToPlaylist.songs.push(action.payload.playlistsong.id);\n            return { ...state, [addToPlaylist.id]: addToPlaylist};\n        case DELETE_PLAYLISTSONG:\n            const deleteFromPlaylist = state[action.payload.playlist];\n            if (deleteFromPlaylist) {\n                const newSongList = deleteFromPlaylist.songs.filter(id => id !== action.payload.playlistsong.id);\n                deleteFromPlaylist.songs = newSongList;\n                return { ...state, [deleteFromPlaylist.id]: deleteFromPlaylist };\n            }\n        default:\n            return state;\n\n    }\n\n};","import { FETCH_PLAYLISTSONGS, CREATE_PLAYLISTSONG, EDIT_PLAYLISTSONG, DELETE_PLAYLISTSONG, DELETE_VERSION, DELETE_BOUNCE } from '../actions/types';\nimport _ from 'lodash';\n\nexport default (state = {}, action) => {\n\n    switch (action.type) {\n\n        case FETCH_PLAYLISTSONGS:\n            return { ...state, ..._.mapKeys(action.payload, 'id') };\n        case CREATE_PLAYLISTSONG:\n            return { ...state, [action.payload.playlistsong.id]: action.payload.playlistsong };\n        case EDIT_PLAYLISTSONG:\n            const oldPosition = state[action.payload.playlistsong.id]['position'];\n            const newPosition = action.payload.playlistsong.position;\n            let changedPositions = {};\n            \n            if (oldPosition > newPosition) {\n                for (let item of Object.values(state)) {\n                    if (item.position >= newPosition && item.position < oldPosition) {\n                        const pos = item.position;\n                        changedPositions[item.id] = { ...item, position: pos + 1};\n                    }\n                }\n            }\n            if (oldPosition < newPosition) {\n                for (let item of Object.values(state)) {\n                    if (item.position > oldPosition && item.position <= newPosition) {\n                        const pos = item.position;\n                        changedPositions[item.id] = { ...item, position: pos - 1};\n                    }\n                }\n            }\n            \n            return { ...state, [action.payload.playlistsong.id]: action.payload.playlistsong, ...changedPositions };\n        case DELETE_PLAYLISTSONG:\n            const changePosition = Object.values(state).filter(p => p.position > action.payload.playlistsong.position);\n            changePosition.forEach((song) => {\n                song.position = song.position - 1;\n            });\n            delete state[action.payload.playlistsong.id];\n            return { ...state };\n        case DELETE_VERSION:\n            for (const id in state) {\n                if (state[id].version === action.payload.version.id) {\n                    state[id].version = null;\n                    state[id].bounce = null;\n                }\n            }\n            return { ...state };\n        case DELETE_BOUNCE:\n            for (const id in state) {\n                if (state[id].bounce === action.payload.bounce.id) {\n                    state[id].bounce = null;\n                }\n            }\n            return { ...state };\n        default:\n            return state;\n\n    }\n\n};","import {\n  FETCH_BAND,\n  FETCH_BANDS,\n  EDIT_BAND,\n  DELETE_BAND,\n  CREATE_BAND,\n  CREATE_TIER,\n  DELETE_TIER,\n  CREATE_PLAYLIST,\n  DELETE_PLAYLIST,\n  SIGN_OUT,\n  UPLOAD_STARTED,\n  CREATE_BOUNCE,\n  UPLOAD_FAILURE,\n} from '../actions/types';\nimport _ from 'lodash';\n\nexport default (state = {}, action) => {\n  switch (action.type) {\n    case FETCH_BAND:\n      return {\n        ...state,\n        [action.payload.id]: action.payload,\n        currentBand: action.payload,\n      };\n    case FETCH_BANDS:\n      return { ...state, ..._.mapKeys(action.payload, 'id') };\n    case CREATE_BAND:\n      return { ...state, [action.payload.id]: action.payload };\n    case EDIT_BAND:\n      return { ...state, [action.payload.id]: action.payload };\n    case DELETE_BAND:\n      delete state[action.payload.id];\n      return { ...state };\n    case CREATE_TIER:\n      const { currentBand } = state;\n      currentBand.tiers.push(action.payload.id);\n      return { ...state, [currentBand.id]: currentBand, currentBand };\n    case DELETE_TIER:\n      const band = state.currentBand;\n      const newTiers = band.tiers.filter((id) => id !== action.payload.id);\n      band.tiers = newTiers;\n      return { ...state, [band.id]: band, currentBand: band };\n    case CREATE_PLAYLIST:\n      const currentBandP = state.currentBand;\n      currentBandP.playlists.push(action.payload.id);\n      return {\n        ...state,\n        [currentBandP.id]: currentBandP,\n        currentBand: currentBandP,\n      };\n    case DELETE_PLAYLIST:\n      const bandP = state.currentBand;\n      const newPlaylists = bandP.playlists.filter(\n        (id) => id !== action.payload.id\n      );\n      bandP.playlists = newPlaylists;\n      return { ...state, [bandP.id]: bandP, currentBand: bandP };\n    case SIGN_OUT:\n      return _.omit(state, state.currentBand);\n    case UPLOAD_STARTED:\n      return { ...state, uploadStarted: true };\n    case UPLOAD_FAILURE:\n      return { ...state, uploadStarted: false };\n    case CREATE_BOUNCE:\n      return { ...state, uploadStarted: false };\n    default:\n      return state;\n  }\n};\n","import { ERROR } from '../actions/types';\n\n\nexport default (state = {}, action) => {\n    switch (action.type) {\n        case ERROR:\n            return { error: action.payload }\n        default:\n            return state;\n    }\n};","import { decode } from 'base64-arraybuffer';\nimport {\n  FETCH_RECORDING,\n  CREATE_RECORDING,\n  CLEAR_RECORDINGS,\n} from '../actions/types';\n\nexport default (state = [], action) => {\n  switch (action.type) {\n    case FETCH_RECORDING:\n      const decoded = decode(action.payload.file);\n      const arrayBuffer = new Uint8Array(decoded);\n      const blob = new Blob([arrayBuffer], { type: 'audio/mpeg' });\n      const thisState = [...state];\n      thisState[action.payload.index] = blob;\n      return thisState;\n    case CREATE_RECORDING:\n      const newState = [...state];\n      newState[action.payload.index] = action.payload.file;\n      return newState;\n    case CLEAR_RECORDINGS:\n      return [];\n    default:\n      return state;\n  }\n};\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport { createStore, applyMiddleware, compose } from 'redux';\nimport reduxThunk from 'redux-thunk';\n\nimport App from './components/App';\nimport reducers from './reducers';\n\nconst initialState = {};\n\nconst token = localStorage.getItem('token');\n\nif (token) {\n  initialState.auth = { isSignedIn: true };\n}\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\nconst store = createStore(\n  reducers,\n  initialState,\n  composeEnhancers(applyMiddleware(reduxThunk))\n);\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.querySelector('#root')\n);\n"],"sourceRoot":""}